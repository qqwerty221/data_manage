!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@logicflow/core")):"function"==typeof define&&define.amd?define(["exports","@logicflow/core"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).Extension={},e.Core)}(this,(function(e,t){"use strict";var n=40,i=40,o=40,r=40,a=40,s=40,l=100,u=80,c=100,d=80,h={rect:{radius:5,stroke:"rgb(24, 125, 255)"},circle:{r:18,stroke:"rgb(24, 125, 255)"},polygon:{stroke:"rgb(24, 125, 255)"},polyline:{stroke:"rgb(24, 125, 255)",hoverStroke:"rgb(24, 125, 255)",selectedStroke:"rgb(24, 125, 255)"},edgeText:{textWidth:100,overflowMode:"default",fontSize:12,background:{fill:"white",height:14,stroke:"transparent",radius:3}}},f=function(e,t){return f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},f(e,t)};function p(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}f(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var g=function(){return g=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},g.apply(this,arguments)};function v(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(i=Object.getOwnPropertySymbols(e);o<i.length;o++)t.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(e,i[o])&&(n[i[o]]=e[i[o]])}return n}function m(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a}function y(e,t,n,i){return new(n||(n=Promise))((function(o,r){function a(e){try{l(i.next(e))}catch(e){r(e)}}function s(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((i=i.apply(e,t||[])).next())}))}function b(e,t){var n,i,o,r,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(a=0)),a;)try{if(n=1,i&&(o=2&s[0]?i.return:s[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,s[1])).done)return o;switch(i=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,i=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],i=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}}function x(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],i=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function w(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,o,r=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(i=r.next()).done;)a.push(i.value)}catch(e){o={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return a}function E(e,t,n){if(n||2===arguments.length)for(var i,o=0,r=t.length;o<r;o++)!i&&o in t||(i||(i=Array.prototype.slice.call(t,0,o)),i[o]=t[o]);return e.concat(i||Array.prototype.slice.call(t))}"function"==typeof SuppressedError&&SuppressedError;var C=function(){function e(){globalThis._ids=this,this._ids=new Set}return e.prototype.generateId=function(){return"xxxxxxx".replace(/[x]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))},e.prototype.next=function(){for(var e=this.generateId();this._ids.has(e);)e=this.generateId();return this._ids.add(e),e},e}(),N=(null===globalThis||void 0===globalThis?void 0:globalThis._ids)||new C;function _(){return N.next()}var S=function(e){function t(t,n){return t.id||(t.id="Event_".concat(_())),t.text||(t.text=""),t.text&&"string"==typeof t.text&&(t.text={value:t.text,x:t.x,y:t.y+40}),e.call(this,t,n)||this}return p(t,e),t.prototype.setAttributes=function(){this.r=18},t.prototype.getConnectedTargetRules=function(){var t=e.prototype.getConnectedTargetRules.call(this);return t.push({message:"起始节点不能作为边的终点",validate:function(){return!1}}),t},t.extendKey="StartEventModel",t}(t.CircleNodeModel),M=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return p(t,e),t.extendKey="StartEventNode",t}(t.CircleNode),T={type:"bpmn:startEvent",view:M,model:S},A=function(e){function t(t,n){return t.id||(t.id="Event_".concat(_())),t.text||(t.text=""),t.text&&"string"==typeof t.text&&(t.text={value:t.text,x:t.x,y:t.y+40}),e.call(this,t,n)||this}return p(t,e),t.prototype.setAttributes=function(){this.r=18},t.prototype.getConnectedSourceRules=function(){var t=e.prototype.getConnectedSourceRules.call(this);return t.push({message:"结束节点不能作为边的起点",validate:function(){return!1}}),t},t.extendKey="EndEventModel",t}(t.CircleNodeModel),k=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return p(n,e),n.prototype.getAnchorStyle=function(){return{visibility:"hidden"}},n.prototype.getShape=function(){var n=this.props.model,i=n.getNodeStyle(),o=n,r=o.x,a=o.y,s=o.r,l=e.prototype.getShape.call(this);return t.h("g",{},l,t.h("circle",g(g({},i),{cx:r,cy:a,r:s-5})))},n.extendKey="EndEventView",n}(t.CircleNode),R={type:"bpmn:endEvent",view:k,model:A},O=function(e){function t(t,n){return t.id||(t.id="Flow_".concat(_())),e.call(this,t,n)||this}return p(t,e),t.extendKey="SequenceFlowModel",t}(t.PolylineEdgeModel),P=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return p(t,e),t.extendKey="SequenceFlowEdge",t}(t.PolylineEdge),D={type:"bpmn:sequenceFlow",view:P,model:O},I=function(e){function t(t,n){var i=this;return t.id||(t.id="Gateway_".concat(_())),t.text||(t.text=""),t.text&&"string"==typeof t.text&&(t.text={value:t.text,x:t.x,y:t.y+40}),(i=e.call(this,t,n)||this).points=[[25,0],[50,25],[25,50],[0,25]],i}return p(t,e),t.extendKey="ExclusiveGatewayModel",t}(t.PolygonNodeModel),L=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return p(n,e),n.prototype.getShape=function(){var e=this.props.model,n=e,i=n.x,o=n.y,r=n.width,a=n.height,s=n.points,l=e.getNodeStyle();return t.h("g",{transform:"matrix(1 0 0 1 ".concat(i-r/2," ").concat(o-a/2,")")},t.h("polygon",g(g({},l),{x:i,y:o,points:s})),t.h("path",g({d:"m 16,15 7.42857142857143,9.714285714285715 -7.42857142857143,9.714285714285715 3.428571428571429,0 5.714285714285715,-7.464228571428572 5.714285714285715,7.464228571428572 3.428571428571429,0 -7.42857142857143,-9.714285714285715 7.42857142857143,-9.714285714285715 -3.428571428571429,0 -5.714285714285715,7.464228571428572 -5.714285714285715,-7.464228571428572 -3.428571428571429,0 z"},l)))},n.extendKey="ExclusiveGatewayNode",n}(t.PolygonNode),B={type:"bpmn:exclusiveGateway",view:L,model:I},j=function(e){function t(t,n){return t.id||(t.id="Activity_".concat(_())),e.call(this,t,n)||this}return p(t,e),t.extendKey="ServiceTaskModel",t}(t.RectNodeModel),F=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return p(n,e),n.prototype.getLabelShape=function(){var e=this.props.model,n=e.x,i=e.y,o=e.width,r=e.height,a=e.getNodeStyle();return t.h("svg",{x:n-o/2+5,y:i-r/2+5,width:30,height:30,viewBox:"0 0 1274 1024"},t.h("path",{fill:a.stroke,d:"M882.527918 434.149934c-2.234901-5.303796-7.311523-8.853645-13.059434-9.138124l-61.390185-3.009544c-6.635117-20.973684-15.521508-41.175795-26.513864-60.282968l42.051745-47.743374c4.308119-4.889357 4.955872-12.004405 1.602498-17.59268-46.384423-77.30362-103.969956-101.422947-106.400309-102.410438-5.332449-2.170432-11.432377-1.090844-15.693424 2.77009L654.674467 240.664222c-17.004279-8.654101-35.092239-15.756869-53.995775-21.210068l-3.26537-66.490344c-0.280386-5.747911-3.833305-10.824533-9.134031-13.059434-1.683339-0.709151-30.193673-12.391215-76.866668-12.051477-46.672996-0.339738-75.18333 11.342326-76.866668 12.051477-5.300726 2.234901-8.853645 7.311523-9.134031 13.059434l-3.26537 66.490344c-18.903535 5.453199-36.991496 12.555967-53.995775 21.210068l-48.450479-43.922349c-4.261047-3.860934-10.360975-4.940522-15.693424-2.77009-2.430352 0.98749-60.015885 25.106818-106.400309 102.410438-3.353374 5.588275-2.705622 12.703323 1.602498 17.59268l42.051745 47.743374c-10.992355 19.107173-19.878746 39.309284-26.513864 60.282968l-61.390185 3.009544c-5.747911 0.284479-10.824533 3.834328-13.059434 9.138124-1.01512 2.415003-24.687262 60.190871-2.822278 147.651828 1.583055 6.324032 7.072069 10.893094 13.57518 11.308557 5.892197 0.37146 11.751648 0.523933 17.419741 0.667196 14.498202 0.372483 28.193109 0.723477 40.908712 4.63353 4.212952 1.294482 6.435573 8.270361 9.349949 18.763342 1.287319 4.640694 2.617617 9.43693 4.484128 14.010085 1.794879 4.393054 3.75758 8.570189 5.66093 12.607132 1.302669 2.765997 2.529613 5.380544 3.689019 8.018627 2.986007 6.803963 2.682086 9.773598 2.578732 10.349719-3.061732 3.672646-6.391571 7.238868-9.91379 11.015891-1.810229 1.943258-3.680832 3.949962-5.523807 5.980201l-22.560832 24.8909c-3.865028 4.261047-4.940522 10.365068-2.774183 15.693424 0.991584 2.426259 25.102724 60.011792 102.414531 106.400309 5.588275 3.353374 12.703323 2.701528 17.591657-1.603521l23.476691-20.682042c2.346441-2.061962 4.64888-4.336772 6.875594-6.534833 9.05319-8.93858 14.018272-12.95608 17.73185-11.576663 3.305279 1.222851 6.907317 3.166109 10.720156 5.228071 3.325745 1.794879 6.764054 3.650133 10.465352 5.288446 6.016017 2.662643 12.120039 4.688789 18.019399 6.65149 6.827499 2.266623 13.279445 4.409426 18.819624 7.275707 1.518586 0.782829 1.926886 0.994654 2.358721 7.830339 0.726547 11.496845 1.25048 23.276123 1.753947 34.672684 0.264013 5.900384 0.528026 11.803837 0.815575 17.700127 0.284479 5.743818 3.833305 10.82044 9.138124 13.05534 1.654686 0.698918 29.371958 12.063757 74.869175 12.063757 0.328481 0 3.65832 0 3.986801 0 45.497217 0 73.214489-11.364839 74.869175-12.063757 5.304819-2.234901 8.853645-7.311523 9.138124-13.05534 0.287549-5.89629 0.551562-11.799744 0.815575-17.700127 0.503467-11.396561 1.027399-23.175839 1.753947-34.672684 0.431835-6.835685 0.840134-7.04751 2.358721-7.830339 5.54018-2.866281 11.992125-5.009084 18.819624-7.275707 5.89936-1.962701 12.003382-3.988848 18.019399-6.65149 3.701299-1.638313 7.139607-3.493567 10.465352-5.288446 3.812839-2.061962 7.414877-4.00522 10.720156-5.228071 3.713578-1.379417 8.67866 2.638083 17.73185 11.576663 2.226714 2.198062 4.529153 4.472871 6.875594 6.534833l23.476691 20.682042c4.888334 4.305049 12.003382 4.956895 17.591657 1.603521 77.311807-46.388517 101.422947-103.97405 102.414531-106.400309 2.166339-5.328355 1.090844-11.432377-2.774183-15.693424l-22.560832-24.8909c-1.842974-2.030239-3.713578-4.036943-5.523807-5.980201-3.52222-3.777023-6.852058-7.343245-9.91379-11.015891-0.103354-0.576121-0.407276-3.545756 2.578732-10.349719 1.159406-2.638083 2.38635-5.252631 3.689019-8.018627 1.90335-4.036943 3.866051-8.214079 5.66093-12.607132 1.866511-4.573155 3.196809-9.369392 4.484128-14.010085 2.914376-10.492982 5.136997-17.46886 9.349949-18.763342 12.715603-3.910053 26.41051-4.261047 40.908712-4.63353 5.668093-0.143263 11.527544-0.295735 17.419741-0.667196 6.503111-0.415462 11.992125-4.984524 13.57518-11.308557C907.21518 494.340805 883.543038 436.564937 882.527918 434.149934zM643.49894 643.761929c-35.280528 35.280528-82.191954 54.711066-132.086317 54.711066s-96.806813-19.430538-132.086317-54.711066c-35.280528-35.279504-54.711066-82.191954-54.711066-132.086317 0-49.894364 19.430538-96.80272 54.711066-132.082224 35.283598-35.284621 82.191954-54.711066 132.086317-54.711066s96.80579 19.426445 132.086317 54.711066c35.279504 35.279504 54.711066 82.187861 54.711066 132.082224C698.210006 561.569976 678.782537 608.482425 643.49894 643.761929z"}))},n.prototype.getShape=function(){var e=this.props.model,n=e.x,i=e.y,o=e.width,r=e.height,a=e.radius,s=e.getNodeStyle();return t.h("g",{},[t.h("rect",g({x:n-o/2,y:i-r/2,rx:a,ry:a,width:o,height:r},s)),this.getLabelShape()])},n.extendKey="ServiceTaskNode",n}(t.RectNode),H={type:"bpmn:serviceTask",view:F,model:j},W=function(e){function t(t,n){return t.id||(t.id="Activity_".concat(_())),e.call(this,t,n)||this}return p(t,e),t.extendKey="UserTaskModel",t}(t.RectNodeModel),z=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return p(n,e),n.prototype.getLabelShape=function(){var e=this.props.model,n=e.x,i=e.y,o=e.width,r=e.height,a=e.getNodeStyle();return t.h("svg",{x:n-o/2+5,y:i-r/2+5,width:25,height:25,viewBox:"0 0 1274 1024"},t.h("path",{fill:a.stroke,d:"M655.807326 287.35973m-223.989415 0a218.879 218.879 0 1 0 447.978829 0 218.879 218.879 0 1 0-447.978829 0ZM1039.955839 895.482975c-0.490184-212.177424-172.287821-384.030443-384.148513-384.030443-211.862739 0-383.660376 171.85302-384.15056 384.030443L1039.955839 895.482975z"}))},n.prototype.getShape=function(){var e=this.props.model,n=e.x,i=e.y,o=e.width,r=e.height,a=e.radius,s=e.getNodeStyle();return t.h("g",{},[t.h("rect",g(g({},s),{x:n-o/2,y:i-r/2,rx:a,ry:a,width:o,height:r})),this.getLabelShape()])},n.extendKey="UserTaskNode",n}(t.RectNode),G={type:"bpmn:userTask",view:z,model:W},U={pluginName:"bpmnElement",install:function(e){e.setTheme(h),e.register(T),e.register(R),e.register(B),e.register(G),e.register(H),e.options.customBpmnEdge||(e.register(D),e.setDefaultEdgeType("bpmn:sequenceFlow"))}},q=function(){function e(){globalThis._ids=this,this._ids=new Set}return e.prototype.generateId=function(){return"xxxxxxx".replace(/[x]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))},e.prototype.next=function(){for(var e=this.generateId();this._ids.has(e);)e=this.generateId();return this._ids.add(e),e},e}(),X=(null===globalThis||void 0===globalThis?void 0:globalThis._ids)||new q;function V(){return X.next()}function K(e){return Object.prototype.toString.call(e)}function Y(e){var t=e;return"[object Object]"===K(e)?(t={},Object.keys(e).forEach((function(n){var i=n;"-"===n.charAt(0)&&(i=n.substring(1)),t[i]=Y(e[n])}))):Array.isArray(e)&&(t=[],e.forEach((function(e,n){t[n]=Y(e)}))),t}var $="\t\n";function Z(e,t,n){var i=function(e){return"  ".repeat(e)}(n);if(0!==e&&!1!==e&&!e)return $+i+"<".concat(t," />");var o="";if("#text"===t)return $+i+e;if("#cdata-section"===t)return $+i+"<![CDATA["+e+"]]>";if("#comment"===t)return $+i+"\x3c!--"+e+"--\x3e";if("-"==="".concat(t).charAt(0))return" "+t.substring(1)+'="'+function(e){var t=e;try{"string"!=typeof t&&(t=JSON.parse(e))}catch(n){t=JSON.stringify(Y(e)).replace(/"/g,"'")}return t}(e)+'"';if(Array.isArray(e))e.forEach((function(e){o+=Z(e,t,n+1)}));else if("[object Object]"===K(e)){var r=Object.keys(e),a="",s="";o+=(0===n?"":$+i)+"<"+t,r.forEach((function(t){"-"===t.charAt(0)?a+=Z(e[t],t,n+1):s+=Z(e[t],t,n+1)})),o+=a+(""!==s?">".concat(s).concat($+i,"</").concat(t,">"):" />")}else o+=$+i+"<".concat(t,">").concat(e.toString(),"</").concat(t,">");return o}function J(e){var t="";for(var n in e)t+=Z(e[n],n,0);return t}var Q=function(){};(Q.ObjTree=function(){return this}).VERSION="0.23",Q.ObjTree.prototype.xmlDecl='<?xml version="1.0" encoding="UTF-8" ?>\n',Q.ObjTree.prototype.attr_prefix="-",Q.ObjTree.prototype.parseXML=function(e){var t;if(window.DOMParser){var n=new DOMParser,i=n.parseFromString(e,"application/xml");if(!i)return;t=i.documentElement}else window.ActiveXObject&&((n=new ActiveXObject("Microsoft.XMLDOM")).async=!1,n.loadXML(e),t=n.documentElement);if(t)return this.parseDOM(t)},Q.ObjTree.prototype.parseHTTP=function(e,t,n){var i,o={};for(var r in t)o[r]=t[r];if(o.method||(void 0===o.postBody&&void 0===o.postbody&&void 0===o.parameters?o.method="get":o.method="post"),n){o.asynchronous=!0;var a=this,s=n,l=o.onComplete;o.onComplete=function(e){var t;e&&e.responseXML&&e.responseXML.documentElement&&(t=a.parseDOM(e.responseXML.documentElement)),s(t,e),l&&l(e)}}else o.asynchronous=!1;if("undefined"!=typeof HTTP&&HTTP.Request)o.uri=e,(u=new HTTP.Request(o))&&(i=u.transport);else if("undefined"!=typeof Ajax&&Ajax.Request){var u;(u=new Ajax.Request(e,o))&&(i=u.transport)}return n?i:i&&i.responseXML&&i.responseXML.documentElement?this.parseDOM(i.responseXML.documentElement):void 0},Q.ObjTree.prototype.parseDOM=function(e){if(e){if(this.__force_array={},this.force_array)for(var t=0;t<this.force_array.length;t++)this.__force_array[this.force_array[t]]=1;var n=this.parseElement(e);if(this.__force_array[e.nodeName]&&(n=[n]),11!=e.nodeType){var i={};i[e.nodeName]=n,n=i}return n}},Q.ObjTree.prototype.parseElement=function(e){if(7!=e.nodeType){if(3==e.nodeType||4==e.nodeType||8==e.nodeType){if(null==e.nodeValue.match(/[^\x00-\x20]/))return;return e.nodeValue}var t=null,n={};if(e.attributes&&e.attributes.length){t={};for(var i=0;i<e.attributes.length;i++){if("string"==typeof(s=e.attributes[i].nodeName)){var o=e.attributes[i].nodeValue;try{o=JSON.parse(e.attributes[i].nodeValue.replace(/'/g,'"'))}catch(t){o=e.attributes[i].nodeValue}o&&(void 0===n[s=this.attr_prefix+s]&&(n[s]=0),n[s]++,this.addNode(t,s,n[s],o))}}}if(e.childNodes&&e.childNodes.length){var r=!0;t&&(r=!1);for(i=0;i<e.childNodes.length&&r;i++){var a=e.childNodes[i].nodeType;3!=a&&4!=a&&8!=a&&(r=!1)}if(r){t||(t="");for(i=0;i<e.childNodes.length;i++)t+=e.childNodes[i].nodeValue}else{t||(t={});for(i=0;i<e.childNodes.length;i++){var s;if("string"==typeof(s=e.childNodes[i].nodeName))(o=this.parseElement(e.childNodes[i]))&&(void 0===n[s]&&(n[s]=0),n[s]++,this.addNode(t,s,n[s],o))}}}else null===t&&(t={});return t}},Q.ObjTree.prototype.addNode=function(e,t,n,i){this.__force_array[t]?(1==n&&(e[t]=[]),e[t][e[t].length]=i):1==n?e[t]=i:2==n?e[t]=[e[t],i]:e[t][e[t].length]=i},Q.ObjTree.prototype.writeXML=function(e){var t=this.hash_to_xml(null,e);return this.xmlDecl+t},Q.ObjTree.prototype.hash_to_xml=function(e,t){var n=[],i=[];for(var o in t)if(t.hasOwnProperty(o)){var r=t[o];o.charAt(0)!=this.attr_prefix?void 0===r||null==r?n[n.length]="<"+o+" />":"object"==typeof r&&r.constructor==Array?n[n.length]=this.array_to_xml(o,r):n[n.length]="object"==typeof r?this.hash_to_xml(o,r):this.scalar_to_xml(o,r):i[i.length]=" "+o.substring(1)+'="'+this.xml_escape(r)+'"'}var a=i.join(""),s=n.join("");return void 0===e||null==e||(s=n.length>0?s.match(/\n/)?"<"+e+a+">\n"+s+"</"+e+">\n":"<"+e+a+">"+s+"</"+e+">\n":"<"+e+a+" />\n"),s},Q.ObjTree.prototype.array_to_xml=function(e,t){for(var n=[],i=0;i<t.length;i++){var o=t[i];void 0===o||null==o?n[n.length]="<"+e+" />":"object"==typeof o&&o.constructor==Array?n[n.length]=this.array_to_xml(e,o):n[n.length]="object"==typeof o?this.hash_to_xml(e,o):this.scalar_to_xml(e,o)}return n.join("")},Q.ObjTree.prototype.scalar_to_xml=function(e,t){return"#text"==e?this.xml_escape(t):"<"+e+">"+this.xml_escape(t)+"</"+e+">\n"},Q.ObjTree.prototype.xml_escape=function(e){return e.replace(/&/g,"&").replace(/</g,"<").replace(/>/g,">").replace(/"/g,'"')};var ee,te=function(e){return(new Q.ObjTree).parseXML(e)};!function(e){e.START="bpmn:startEvent",e.END="bpmn:endEvent",e.GATEWAY="bpmn:exclusiveGateway",e.USER="bpmn:userTask",e.SYSTEM="bpmn:serviceTask",e.FLOW="bpmn:sequenceFlow"}(ee||(ee={}));var ne=["-name","-id","bpmn:incoming","bpmn:outgoing","-sourceRef","-targetRef"],ie=["properties","startPoint","endPoint","pointsList"];function oe(e){var t=e?ie.concat(e):ie;return function(e){return function e(n){var i={};return"string"==typeof n?n:Array.isArray(n)?n.map((function(t){return e(t)})):(Object.entries(n).forEach((function(n){var o=w(n,2),r=o[0],a=o[1];"object"!=typeof a?0===r.indexOf("-")||["#text","#cdata-section","#comment"].includes(r)?i[r]=a:i["-".concat(r)]=a:t.includes(r)?i["-".concat(r)]=e(a):i[r]=e(a)})),i)}(e)}}function re(e){var t={};return Object.entries(e).forEach((function(e){var n=w(e,2),i=n[0],o=n[1];0===i.indexOf("-")?t[i.substring(1)]=Y(o):"string"==typeof o?t[i]=o:"[object Object]"===Object.prototype.toString.call(o)?t[i]=re(o):Array.isArray(o)?t[i]=o.map((function(e){return re(e)})):t[i]=o})),t}function ae(e,t){e["bpmndi:BPMNEdge"]=t.edges.map((function(e){var t,n=e.id,i=e.pointsList.map((function(e){return{"-x":e.x,"-y":e.y}})),o={"-id":"".concat(n,"_di"),"-bpmnElement":n,"di:waypoint":i};return(null===(t=e.text)||void 0===t?void 0:t.value)&&(o["bpmndi:BPMNLabel"]={"dc:Bounds":{"-x":e.text.x-10*e.text.value.length/2,"-y":e.text.y-7,"-width":10*e.text.value.length,"-height":14}}),o})),e["bpmndi:BPMNShape"]=t.nodes.map((function(e){var t,n=e.id,i=100,o=80,r=e.x,a=e.y,s=ce.shapeConfigMap.get(e.type);s&&(i=s.width,o=s.height),r-=i/2,a-=o/2;var l={"-id":"".concat(n,"_di"),"-bpmnElement":n,"dc:Bounds":{"-x":r,"-y":a,"-width":i,"-height":o}};return(null===(t=e.text)||void 0===t?void 0:t.value)&&(l["bpmndi:BPMNLabel"]={"dc:Bounds":{"-x":e.text.x-10*e.text.value.length/2,"-y":e.text.y-7,"-width":10*e.text.value.length,"-height":14}}),l}))}function se(e){var t=[],n=[],i=e["bpmn:definitions"];if(i){var o=i["bpmn:process"];Object.keys(o).forEach((function(e){if(0===e.indexOf("bpmn:")){var r=o[e];if(e===ee.FLOW){var a=i["bpmndi:BPMNDiagram"]["bpmndi:BPMNPlane"]["bpmndi:BPMNEdge"];n=function(e,t){var n=[];if(Array.isArray(e))e.forEach((function(e){var i;i=Array.isArray(t)?t.find((function(t){return t["-bpmnElement"]===e["-id"]})):t,n.push(ue(i,e))}));else{var i=void 0;i=Array.isArray(t)?t.find((function(t){return t["-bpmnElement"]===e["-id"]})):t,n.push(ue(i,e))}return n}(r,a)}else{var s=i["bpmndi:BPMNDiagram"]["bpmndi:BPMNPlane"]["bpmndi:BPMNShape"];t=t.concat(function(e,t,n){var i=[];if(Array.isArray(e))e.forEach((function(e){var o=le(Array.isArray(t)?t.find((function(t){return t["-bpmnElement"]===e["-id"]})):t,n,e);i.push(o)}));else{var o=le(Array.isArray(t)?t.find((function(t){return t["-bpmnElement"]===e["-id"]})):t,n,e);i.push(o)}return i}(r,s,e))}}}))}return{nodes:t,edges:n}}function le(e,t,n){var i,o,r=Number(e["dc:Bounds"]["-x"]),a=Number(e["dc:Bounds"]["-y"]),s=n["-name"],l=ce.shapeConfigMap.get(t);if(l&&(r+=l.width/2,a+=l.height/2),Object.entries(n).forEach((function(e){var t=w(e,2),n=t[0],o=t[1];-1===ne.indexOf(n)&&(i||(i={}),i[n]=o)})),i&&(i=re(i)),s&&(o={x:r,y:a,value:s},e["bpmndi:BPMNLabel"]&&e["bpmndi:BPMNLabel"]["dc:Bounds"])){var u=e["bpmndi:BPMNLabel"]["dc:Bounds"];o.x=Number(u["-x"])+Number(u["-width"])/2,o.y=Number(u["-y"])+Number(u["-height"])/2}var c={id:e["-bpmnElement"],type:t,x:r,y:a,properties:i};return o&&(c.text=o),c}function ue(e,t){var n,i,o=t["-name"]?"".concat(t["-name"]):"";if(o){var r=e["bpmndi:BPMNLabel"]["dc:Bounds"],a=0;o.split("\n").forEach((function(e){a<e.length&&(a=e.length)})),n={value:o,x:Number(r["-x"])+10*a/2,y:Number(r["-y"])+7}}Object.entries(t).forEach((function(e){var t=w(e,2),n=t[0],o=t[1];-1===ne.indexOf(n)&&(i||(i={}),i[n]=o)})),i&&(i=re(i));var s={id:t["-id"],type:ee.FLOW,pointsList:e["di:waypoint"].map((function(e){return{x:Number(e["-x"]),y:Number(e["-y"])}})),sourceNodeId:t["-sourceRef"],targetNodeId:t["-targetRef"],properties:i};return n&&(s.text=n),s}var ce=function(){function e(e){var t=e.lf,n=this;this.adapterOut=function(e,t){var i=g({},n.processAttributes);!function(e,t,n){var i=new Map;t.nodes.forEach((function(t){var o,r={"-id":t.id};if((null===(o=t.text)||void 0===o?void 0:o.value)&&(r["-name"]=t.text.value),t.properties){var a=oe(n)(t.properties);Object.assign(r,a)}i.set(t.id,r),e[t.type]?Array.isArray(e[t.type])?e[t.type].push(r):e[t.type]=[e[t.type],r]:e[t.type]=r}));var o=t.edges.map((function(e){var t,o,r=i.get(e.targetNodeId);r["bpmn:incoming"]?Array.isArray(r["bpmn:incoming"])?r["bpmn:incoming"].push(e.id):r["bpmn:incoming"]=[r["bpmn:incoming"],e.id]:r["bpmn:incoming"]=e.id;var a={"-id":e.id,"-sourceRef":e.sourceNodeId,"-targetRef":e.targetNodeId};if((null===(t=e.text)||void 0===t?void 0:t.value)&&(a["-name"]=null===(o=e.text)||void 0===o?void 0:o.value),e.properties){var s=oe(n)(e.properties);Object.assign(a,s)}return a}));t.edges.forEach((function(e){var t=i.get(e.sourceNodeId);t["bpmn:outgoing"]?Array.isArray(t["bpmn:outgoing"])?t["bpmn:outgoing"].push(e.id):t["bpmn:outgoing"]=[t["bpmn:outgoing"],e.id]:t["bpmn:outgoing"]=e.id})),e[ee.FLOW]=o}(i,e,t);var o={"-id":"BPMNPlane_1","-bpmnElement":i["-id"]};ae(o,e);var r=n.definitionAttributes;return r["bpmn:process"]=i,r["bpmndi:BPMNDiagram"]={"-id":"BPMNDiagram_1","bpmndi:BPMNPlane":o},{"bpmn:definitions":r}},this.adapterIn=function(e){if(e)return se(e)},t.adapterIn=function(e){return n.adapterIn(e)},t.adapterOut=function(e,t){return n.adapterOut(e,t)},this.processAttributes={"-isExecutable":"true","-id":"Process_".concat(V())},this.definitionAttributes={"-id":"Definitions_".concat(V()),"-xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","-xmlns:bpmn":"http://www.omg.org/spec/BPMN/20100524/MODEL","-xmlns:bpmndi":"http://www.omg.org/spec/BPMN/20100524/DI","-xmlns:dc":"http://www.omg.org/spec/DD/20100524/DC","-xmlns:di":"http://www.omg.org/spec/DD/20100524/DI","-targetNamespace":"http://logic-flow.org","-exporter":"logicflow","-exporterVersion":"1.2.0"}}return e.prototype.setCustomShape=function(t,n){e.shapeConfigMap.set(t,n)},e.pluginName="bpmn-adapter",e.shapeConfigMap=new Map,e}();ce.shapeConfigMap.set(ee.START,{width:n,height:i}),ce.shapeConfigMap.set(ee.END,{width:o,height:r}),ce.shapeConfigMap.set(ee.GATEWAY,{width:a,height:s}),ce.shapeConfigMap.set(ee.SYSTEM,{width:l,height:u}),ce.shapeConfigMap.set(ee.USER,{width:c,height:d});var de=function(e){function t(t){var n=e.call(this,t)||this;n.adapterXmlIn=function(e){var t=te(e);return n.adapterIn(t)},n.adapterXmlOut=function(e,t){return J(n.adapterOut(e,t))};var i=t.lf;return i.adapterIn=n.adapterXmlIn,i.adapterOut=n.adapterXmlOut,n}return p(t,e),t.pluginName="bpmnXmlAdapter",t}(ce);function he(){this.targetRules.push({message:"分组外的节点不允许连接分组内的",validate:function(e,t){var n=!!e.properties.parent,i=!!t.properties.parent;return!(!n&&i)}})}var fe=function(){function e(){globalThis._ids=this,this._ids=new Set}return e.prototype.generateId=function(){return"xxxxxxx".replace(/[x]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))},e.prototype.next=function(){for(var e=this.generateId();this._ids.has(e);)e=this.generateId();return this._ids.add(e),e},e}(),pe=(null===globalThis||void 0===globalThis?void 0:globalThis._ids)||new fe;function ge(){return pe.next()}var ve=Object.freeze({__proto__:null,genBpmnId:ge,groupRule:he});function me(e){var n=w(e.useDefinition(),1)[0],i=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return p(i,e),i.prototype.getAnchorStyle=function(){return{visibility:"hidden"}},i.prototype.getShape=function(){var i,o=this.props.model,r=o.getNodeStyle(),a=o,s=a.x,l=a.y,u=a.r,c=a.width,d=a.height,h=a.properties,f=e.prototype.getShape.call(this),p=h.definitionType,v=((null===(i=n.endEvent)||void 0===i?void 0:i.get(p))||{}).icon,m=Array.isArray(v)?t.h.apply(void 0,E(["g",{transform:"matrix(1 0 0 1 ".concat(s-c/2," ").concat(l-d/2,")")}],w(v),!1)):t.h("path",{transform:"matrix(1 0 0 1 ".concat(s-c/2," ").concat(l-d/2,")"),d:v,style:"fill: black; stroke-linecap: round; stroke-linejoin: round; stroke: white; stroke-width: 1px;"});return t.h("g",{},f,t.h("circle",g(g({},r),{strokeWidth:2,cx:s,cy:l,r:u-2})),m)},i}(t.CircleNode),o=function(e){function t(t,i){var o,r,a,s;t.id||(t.id="Event_".concat(ge())),t.text||(t.text=""),t.text&&"string"==typeof t.text&&(t.text={value:t.text,x:t.x,y:t.y+40});var l=((null===(r=n.endEvent)||void 0===r?void 0:r.get(null===(a=t.properties)||void 0===a?void 0:a.definitionType))||{}).properties,u=void 0===l?{}:l;return t.properties=g(g({},u),t.properties),(null===(s=t.properties)||void 0===s?void 0:s.definitionType)&&(t.properties.definitionId="Definition_".concat(ge())),o=e.call(this,t,i)||this,he.call(o),o}return p(t,e),t.prototype.setAttributes=function(){this.r=18},t.prototype.getConnectedSourceRules=function(){var t=this,n=e.prototype.getConnectedSourceRules.call(this),i={message:"结束节点不能作为边的起点",validate:function(e,n){return e!==t}};return n.push(i),n},t}(t.CircleNodeModel);return{type:"bpmn:endEvent",view:i,model:o}}function ye(e){var n=w(e.useDefinition(),1)[0],i=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return p(i,e),i.prototype.getAnchorStyle=function(){return{visibility:"hidden"}},i.prototype.getShape=function(){var e,i=this.props.model,o=i.getNodeStyle(),r=i,a=r.x,s=r.y,l=r.r,u=r.width,c=r.height,d=r.properties.definitionType,h=((null===(e=n.intermediateCatchEvent)||void 0===e?void 0:e.get(d))||{}).icon,f=Array.isArray(h)?t.h.apply(void 0,E(["g",{transform:"matrix(1 0 0 1 ".concat(a-u/2," ").concat(s-c/2,")")}],w(h),!1)):t.h("path",{transform:"matrix(1 0 0 1 ".concat(a-u/2," ").concat(s-c/2,")"),d:h});return t.h("g",{},t.h("circle",g(g({},o),{cx:a,cy:s,r:l,strokeWidth:1.5})),t.h("circle",g(g({},o),{cx:a,cy:s,r:l-3,strokeWidth:1.5})),f)},i}(t.CircleNode),o=function(e){function t(t,i){var o,r,a,s;t.id||(t.id="Event_".concat(ge())),t.text||(t.text=""),t.text&&"string"==typeof t.text&&(t.text={value:t.text,x:t.x,y:t.y+40});var l=((null===(r=n.intermediateCatchEvent)||void 0===r?void 0:r.get(null===(a=t.properties)||void 0===a?void 0:a.definitionType))||{}).properties,u=void 0===l?{}:l;return t.properties=g(g({},u),t.properties),(null===(s=t.properties)||void 0===s?void 0:s.definitionType)&&(t.properties.definitionId="Definition_".concat(ge())),o=e.call(this,t,i)||this,he.call(o),o}return p(t,e),t.prototype.setAttributes=function(){this.r=18},t}(t.CircleNodeModel);return{type:"bpmn:intermediateCatchEvent",view:i,model:o}}function be(e){var n=w(e.useDefinition(),1)[0],i=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return p(i,e),i.prototype.getAnchorStyle=function(){return{visibility:"hidden"}},i.prototype.getShape=function(){var e,i=this.props.model,o=i.getNodeStyle(),r=i,a=r.x,s=r.y,l=r.r,u=r.width,c=r.height,d=r.properties,h=d.definitionType,f=d.isInterrupting,p=((null===(e=n.startEvent)||void 0===e?void 0:e.get(h))||{}).icon,v=Array.isArray(p)?t.h.apply(void 0,E(["g",{transform:"matrix(1 0 0 1 ".concat(a-u/2," ").concat(s-c/2,")")}],w(p),!1)):t.h("path",{transform:"matrix(1 0 0 1 ".concat(a-u/2," ").concat(s-c/2,")"),d:p,style:"fill: white; stroke-linecap: round; stroke-linejoin: round; stroke: rgb(34, 36, 42); stroke-width: 1px;"});return t.h("g",{},t.h("circle",g(g({},o),{cx:a,cy:s,r:l,strokeDasharray:f?"5,5":"",strokeWidth:2})),v)},i}(t.CircleNode),o=function(e){function t(t,i){var o,r,a;t.id||(t.id="Event_".concat(ge())),t.text||(t.text=""),t.text&&"string"==typeof t.text&&(t.text={value:t.text,x:t.x,y:t.y+40});var s=((null===(o=n.startEvent)||void 0===o?void 0:o.get(null===(r=t.properties)||void 0===r?void 0:r.definitionType))||{}).properties,l=void 0===s?{}:s;return t.properties=g(g({},l),t.properties),(null===(a=t.properties)||void 0===a?void 0:a.definitionType)&&(t.properties.definitionId="Definition_".concat(ge())),e.call(this,t,i)||this}return p(t,e),t.prototype.setAttributes=function(){this.r=18},t.prototype.getConnectedTargetRules=function(){var t=this,n=e.prototype.getConnectedTargetRules.call(this),i={message:"起始节点不能作为边的终点",validate:function(e,n){return n!==t}};return n.push(i),n},t}(t.CircleNodeModel);return{type:"bpmn:startEvent",view:i,model:o}}function xe(e){var n=w(e.useDefinition(),1)[0],i=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return p(i,e),i.prototype.getAnchorStyle=function(){return{visibility:"hidden"}},i.prototype.getShape=function(){var e,i=this.props.model,o=i.getNodeStyle(),r=i,a=r.x,s=r.y,l=r.r,u=r.width,c=r.height,d=r.properties,h=d.definitionType,f=d.cancelActivity,p=((null===(e=n.boundaryEvent)||void 0===e?void 0:e.get(h))||{}).icon,v=Array.isArray(p)?t.h.apply(void 0,E(["g",{transform:"matrix(1 0 0 1 ".concat(a-u/2," ").concat(s-c/2,")")}],w(p),!1)):t.h("path",{transform:"matrix(1 0 0 1 ".concat(a-u/2," ").concat(s-c/2,")"),d:p});return t.h("g",{},t.h("circle",g(g({},o),{cx:a,cy:s,r:l,strokeDasharray:f?"":"5,5",strokeWidth:1.5})),t.h("circle",g(g({},o),{cx:a,cy:s,r:l-3,strokeDasharray:f?"":"5,5",strokeWidth:1.5})),v)},i}(t.CircleNode),o=function(e){function t(t,i){var o,r,a,s;t.id||(t.id="Event_".concat(ge())),t.text||(t.text=""),t.text&&"string"==typeof t.text&&(t.text={value:t.text,x:t.x,y:t.y+40});var l=((null===(r=n.boundaryEvent)||void 0===r?void 0:r.get(null===(a=t.properties)||void 0===a?void 0:a.definitionType))||{}).properties,u=void 0===l?{}:l;return t.properties=g(g({attachedToRef:"",cancelActivity:!0},u),t.properties),(null===(s=t.properties)||void 0===s?void 0:s.definitionType)&&(t.properties.definitionId="Definition_".concat(ge())),o=e.call(this,t,i)||this,he.call(o),o}return p(t,e),t.prototype.initNodeData=function(t){e.prototype.initNodeData.call(this,t),this.r=20,this.autoToFront=!1,this.zIndex=99999},t.prototype.setAttributes=function(){this.r=18},t}(t.CircleNodeModel);return{type:"bpmn:boundaryEvent",view:i,model:o}}function we(e){var n=w(e.useDefinition(),1)[0],i=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return p(i,e),i.prototype.getAnchorStyle=function(){return{visibility:"hidden"}},i.prototype.getShape=function(){var e,i=this.props.model,o=i.getNodeStyle(),r=i,a=r.x,s=r.y,l=r.r,u=r.width,c=r.height,d=r.properties.definitionType,h=((null===(e=n.intermediateThrowEvent)||void 0===e?void 0:e.get(d))||{}).icon,f=Array.isArray(h)?t.h.apply(void 0,E(["g",{transform:"matrix(1 0 0 1 ".concat(a-u/2," ").concat(s-c/2,")")}],w(h),!1)):t.h("path",{transform:"matrix(1 0 0 1 ".concat(a-u/2," ").concat(s-c/2,")"),d:h,style:"fill: black"});return t.h("g",{},t.h("circle",g(g({},o),{cx:a,cy:s,r:l,strokeWidth:1.5})),t.h("circle",g(g({},o),{cx:a,cy:s,r:l-3,strokeWidth:1.5})),f)},i}(t.CircleNode),o=function(e){function t(t,i){var o,r,a,s;t.id||(t.id="Event_".concat(ge())),t.text||(t.text=""),t.text&&"string"==typeof t.text&&(t.text={value:t.text,x:t.x,y:t.y+40});var l=((null===(r=n.intermediateThrowEvent)||void 0===r?void 0:r.get(null===(a=t.properties)||void 0===a?void 0:a.definitionType))||{}).properties,u=void 0===l?{}:l;return t.properties=g(g({},u),t.properties),(null===(s=t.properties)||void 0===s?void 0:s.definitionType)&&(t.properties.definitionId="Definition_".concat(ge())),o=e.call(this,t,i)||this,he.call(o),o}return p(t,e),t.prototype.setAttributes=function(){this.r=18},t}(t.CircleNodeModel);return{type:"bpmn:intermediateThrowEvent",view:i,model:o}}var Ee=[t.h("circle",{cx:18,cy:18,r:11,style:"stroke-linecap: round;stroke-linejoin: round;stroke: rgb(34, 36, 42);stroke-width: 2px;fill: white"}),t.h("path",{d:"M 18,18 l 2.25,-7.5 m -2.25,7.5 l 5.25,1.5",style:"fill: none; stroke-linecap: round; stroke-linejoin: round; stroke: rgb(34, 36, 42); stroke-width: 2px;"}),t.h("path",{d:"M 18,18 m 0,7.5 l -0,2.25",transform:"rotate(0,18,18)",style:"fill: none; stroke-linecap: round; stroke-linejoin: round; stroke: rgb(34, 36, 42); stroke-width: 1px;"}),t.h("path",{d:"M 18,18 m 0,7.5 l -0,2.25",transform:"rotate(30,18,18)",style:"fill: none; stroke-linecap: round; stroke-linejoin: round; stroke: rgb(34, 36, 42); stroke-width: 1px;"}),t.h("path",{d:"M 18,18 m 0,7.5 l -0,2.25",transform:"rotate(60,18,18)",style:"fill: none; stroke-linecap: round; stroke-linejoin: round; stroke: rgb(34, 36, 42); stroke-width: 1px;"}),t.h("path",{d:"M 18,18 m 0,7.5 l -0,2.25",transform:"rotate(90,18,18)",style:"fill: none; stroke-linecap: round; stroke-linejoin: round; stroke: rgb(34, 36, 42); stroke-width: 1px;"}),t.h("path",{d:"M 18,18 m 0,7.5 l -0,2.25",transform:"rotate(120,18,18)",style:"fill: none; stroke-linecap: round; stroke-linejoin: round; stroke: rgb(34, 36, 42); stroke-width: 1px;"}),t.h("path",{d:"M 18,18 m 0,7.5 l -0,2.25",transform:"rotate(150,18,18)",style:"fill: none; stroke-linecap: round; stroke-linejoin: round; stroke: rgb(34, 36, 42); stroke-width: 1px;"}),t.h("path",{d:"M 18,18 m 0,7.5 l -0,2.25",transform:"rotate(180,18,18)",style:"fill: none; stroke-linecap: round; stroke-linejoin: round; stroke: rgb(34, 36, 42); stroke-width: 1px;"}),t.h("path",{d:"M 18,18 m 0,7.5 l -0,2.25",transform:"rotate(210,18,18)",style:"fill: none; stroke-linecap: round; stroke-linejoin: round; stroke: rgb(34, 36, 42); stroke-width: 1px;"}),t.h("path",{d:"M 18,18 m 0,7.5 l -0,2.25",transform:"rotate(240,18,18)",style:"fill: none; stroke-linecap: round; stroke-linejoin: round; stroke: rgb(34, 36, 42); stroke-width: 1px;"}),t.h("path",{d:"M 18,18 m 0,7.5 l -0,2.25",transform:"rotate(270,18,18)",style:"fill: none; stroke-linecap: round; stroke-linejoin: round; stroke: rgb(34, 36, 42); stroke-width: 1px;"}),t.h("path",{d:"M 18,18 m 0,7.5 l -0,2.25",transform:"rotate(300,18,18)",style:"fill: none; stroke-linecap: round; stroke-linejoin: round; stroke: rgb(34, 36, 42); stroke-width: 1px;"}),t.h("path",{d:"M 18,18 m 0,7.5 l -0,2.25",transform:"rotate(330,18,18)",style:"fill: none; stroke-linecap: round; stroke-linejoin: round; stroke: rgb(34, 36, 42); stroke-width: 1px;"})],Ce=[t.h("circle",{cx:18,cy:18,r:10,style:"stroke-linecap: round; stroke-linejoin: round; stroke: rgb(34, 36, 42); stroke-width: 4px; fill: rgb(34, 36, 42);"})],Ne="m 16,15 7.42857142857143,9.714285714285715 -7.42857142857143,9.714285714285715 3.428571428571429,0 5.714285714285715,-7.464228571428572 5.714285714285715,7.464228571428572 3.428571428571429,0 -7.42857142857143,-9.714285714285715 7.42857142857143,-9.714285714285715 -3.428571428571429,0 -5.714285714285715,7.464228571428572 -5.714285714285715,-7.464228571428572 -3.428571428571429,0 z",_e="m 23,10 0,12.5 -12.5,0 0,5 12.5,0 0,12.5 5,0 0,-12.5 12.5,0 0,-5 -12.5,0 0,-12.5 -5,0 z",Se=t.h("circle",{cx:25,cy:25,r:13,style:"stroke-linecap: round; stroke-linejoin: round; stroke: rgb(34, 36, 42); stroke-width: 2.5px; fill: white;"}),Me="M882.527918 434.149934c-2.234901-5.303796-7.311523-8.853645-13.059434-9.138124l-61.390185-3.009544c-6.635117-20.973684-15.521508-41.175795-26.513864-60.282968l42.051745-47.743374c4.308119-4.889357 4.955872-12.004405 1.602498-17.59268-46.384423-77.30362-103.969956-101.422947-106.400309-102.410438-5.332449-2.170432-11.432377-1.090844-15.693424 2.77009L654.674467 240.664222c-17.004279-8.654101-35.092239-15.756869-53.995775-21.210068l-3.26537-66.490344c-0.280386-5.747911-3.833305-10.824533-9.134031-13.059434-1.683339-0.709151-30.193673-12.391215-76.866668-12.051477-46.672996-0.339738-75.18333 11.342326-76.866668 12.051477-5.300726 2.234901-8.853645 7.311523-9.134031 13.059434l-3.26537 66.490344c-18.903535 5.453199-36.991496 12.555967-53.995775 21.210068l-48.450479-43.922349c-4.261047-3.860934-10.360975-4.940522-15.693424-2.77009-2.430352 0.98749-60.015885 25.106818-106.400309 102.410438-3.353374 5.588275-2.705622 12.703323 1.602498 17.59268l42.051745 47.743374c-10.992355 19.107173-19.878746 39.309284-26.513864 60.282968l-61.390185 3.009544c-5.747911 0.284479-10.824533 3.834328-13.059434 9.138124-1.01512 2.415003-24.687262 60.190871-2.822278 147.651828 1.583055 6.324032 7.072069 10.893094 13.57518 11.308557 5.892197 0.37146 11.751648 0.523933 17.419741 0.667196 14.498202 0.372483 28.193109 0.723477 40.908712 4.63353 4.212952 1.294482 6.435573 8.270361 9.349949 18.763342 1.287319 4.640694 2.617617 9.43693 4.484128 14.010085 1.794879 4.393054 3.75758 8.570189 5.66093 12.607132 1.302669 2.765997 2.529613 5.380544 3.689019 8.018627 2.986007 6.803963 2.682086 9.773598 2.578732 10.349719-3.061732 3.672646-6.391571 7.238868-9.91379 11.015891-1.810229 1.943258-3.680832 3.949962-5.523807 5.980201l-22.560832 24.8909c-3.865028 4.261047-4.940522 10.365068-2.774183 15.693424 0.991584 2.426259 25.102724 60.011792 102.414531 106.400309 5.588275 3.353374 12.703323 2.701528 17.591657-1.603521l23.476691-20.682042c2.346441-2.061962 4.64888-4.336772 6.875594-6.534833 9.05319-8.93858 14.018272-12.95608 17.73185-11.576663 3.305279 1.222851 6.907317 3.166109 10.720156 5.228071 3.325745 1.794879 6.764054 3.650133 10.465352 5.288446 6.016017 2.662643 12.120039 4.688789 18.019399 6.65149 6.827499 2.266623 13.279445 4.409426 18.819624 7.275707 1.518586 0.782829 1.926886 0.994654 2.358721 7.830339 0.726547 11.496845 1.25048 23.276123 1.753947 34.672684 0.264013 5.900384 0.528026 11.803837 0.815575 17.700127 0.284479 5.743818 3.833305 10.82044 9.138124 13.05534 1.654686 0.698918 29.371958 12.063757 74.869175 12.063757 0.328481 0 3.65832 0 3.986801 0 45.497217 0 73.214489-11.364839 74.869175-12.063757 5.304819-2.234901 8.853645-7.311523 9.138124-13.05534 0.287549-5.89629 0.551562-11.799744 0.815575-17.700127 0.503467-11.396561 1.027399-23.175839 1.753947-34.672684 0.431835-6.835685 0.840134-7.04751 2.358721-7.830339 5.54018-2.866281 11.992125-5.009084 18.819624-7.275707 5.89936-1.962701 12.003382-3.988848 18.019399-6.65149 3.701299-1.638313 7.139607-3.493567 10.465352-5.288446 3.812839-2.061962 7.414877-4.00522 10.720156-5.228071 3.713578-1.379417 8.67866 2.638083 17.73185 11.576663 2.226714 2.198062 4.529153 4.472871 6.875594 6.534833l23.476691 20.682042c4.888334 4.305049 12.003382 4.956895 17.591657 1.603521 77.311807-46.388517 101.422947-103.97405 102.414531-106.400309 2.166339-5.328355 1.090844-11.432377-2.774183-15.693424l-22.560832-24.8909c-1.842974-2.030239-3.713578-4.036943-5.523807-5.980201-3.52222-3.777023-6.852058-7.343245-9.91379-11.015891-0.103354-0.576121-0.407276-3.545756 2.578732-10.349719 1.159406-2.638083 2.38635-5.252631 3.689019-8.018627 1.90335-4.036943 3.866051-8.214079 5.66093-12.607132 1.866511-4.573155 3.196809-9.369392 4.484128-14.010085 2.914376-10.492982 5.136997-17.46886 9.349949-18.763342 12.715603-3.910053 26.41051-4.261047 40.908712-4.63353 5.668093-0.143263 11.527544-0.295735 17.419741-0.667196 6.503111-0.415462 11.992125-4.984524 13.57518-11.308557C907.21518 494.340805 883.543038 436.564937 882.527918 434.149934zM643.49894 643.761929c-35.280528 35.280528-82.191954 54.711066-132.086317 54.711066s-96.806813-19.430538-132.086317-54.711066c-35.280528-35.279504-54.711066-82.191954-54.711066-132.086317 0-49.894364 19.430538-96.80272 54.711066-132.082224 35.283598-35.284621 82.191954-54.711066 132.086317-54.711066s96.80579 19.426445 132.086317 54.711066c35.279504 35.279504 54.711066 82.187861 54.711066 132.082224C698.210006 561.569976 678.782537 608.482425 643.49894 643.761929z",Te="M655.807326 287.35973m-223.989415 0a218.879 218.879 0 1 0 447.978829 0 218.879 218.879 0 1 0-447.978829 0ZM1039.955839 895.482975c-0.490184-212.177424-172.287821-384.030443-384.148513-384.030443-211.862739 0-383.660376 171.85302-384.15056 384.030443L1039.955839 895.482975z",Ae="m44,60 m 3,2 l 0,10 m 3,-10 l 0,10 m 3,-10 l 0,10",ke="m47,61 m 0,3 l 10,0 m -10,3 l 10,0 m -10,3 l 10,0",Re="m 50,73 c 3.526979,0 6.386161,-2.829858 6.386161,-6.320661 0,-3.490806 -2.859182,-6.320661 -6.386161,-6.320661 -3.526978,0 -6.38616,2.829855 -6.38616,6.320661 0,1.745402 0.714797,3.325567 1.870463,4.469381 0.577834,0.571908 1.265885,1.034728 2.029916,1.35457 l -0.718163,-3.909793 m 0.718163,3.909793 -3.885211,0.802902",Oe=Object.freeze({__proto__:null,compensationIcon:"m 7.92,18 9,-6.5 0,13 z m 9.3,-0.4 8.7,-6.1 0,13 -8.7,-6.1 z",conditionalIcon:"M 10.5,8.5 l 14.5,0 l 0,18 l -14.5,0 Z M 12.5,11.5 l 10.5,0 M 12.5,14.5 l 10.5,0 M 12.5,17.5 l 10.5,0 M 12.5,20.5 l 10.5,0 M 12.5,23.5 l 10.5,0 M 12.5,26.5 l 10.5,0 ",errorIcon:"m 7.2,25.991999999999997 0.09350000000000001,-0.025300000000000003 7.3392,-9.610700000000001 7.667000000000001,8.9661 4.7003,-18.2204 -5.8707,11.6501 -7.299600000000001,-9.585400000000002 z",escalationIcon:"M 18,7.2 l 8,20 l -8,-7 l -8,7 Z",exclusiveIcon:Ne,inclusiveIcon:Se,linkIcon:"m 20.52,9.468 0,4.4375 -13.5,0 0,6.75 13.5,0 0,4.4375 9.84375,-7.8125 -9.84375,-7.8125 z",loopMarker:Re,manualTaskIcon:"M0.5,3.751L4.583,0.5009999999999999C4.583,0.5009999999999999,15.749,0.5839999999999999,16.666,0.5839999999999999S14.249,3.5009999999999994,15.166,3.5009999999999994S26.833,3.5009999999999994,27.75,3.5009999999999994C28.916,5.209,27.582,6.667999999999999,26.916,7.167999999999999S27.791,9.084999999999999,25.916,11.584999999999999C25.166,11.834999999999999,26.666,13.459999999999999,24.583000000000002,14.918C23.416,15.501,25.166,16.46,23.333000000000002,17.750999999999998C22.166,17.750999999999998,2.5000000000000036,17.833999999999996,2.5000000000000036,17.833999999999996L0.5000000000000036,16.500999999999998V3.751ZM13.5,7L27,7M13.5,11L26,11M14,14.5L25,14.5M8.2,3.1L15,3.1",messageIcon:"m 8.459999999999999,11.34 l 0,12.6 l 18.900000000000002,0 l 0,-12.6 z l 9.450000000000001,5.4 l 9.450000000000001,-5.4",parallelIcon:_e,parallelMarker:Ae,scriptTaskIcon:"M6.402,0.5H20.902C20.902,0.5,15.069,3.333,15.069,6.083S19.486,12.083,19.486,15.25S15.319,20.333,15.319,20.333H0.235C0.235,20.333,5.235,17.665999999999997,5.235,15.332999999999998S0.6520000000000001,8.582999999999998,0.6520000000000001,6.082999999999998S6.402,0.5,6.402,0.5ZM3.5,4.5L13.5,4.5M3.8,8.5L13.8,8.5M6.3,12.5L16.3,12.5M6.5,16.5L16.5,16.5",sequentialMarker:ke,serviceTaskIcon:Me,signalIcon:"M 18,7.2 l 9,16.2 l -18,0 Z",style:{throw:"fill: rgb(34, 36, 42); stroke-linecap: round; stroke-linejoin: round; stroke: white; stroke-width: 1px;",catch:"fill: white; stroke-linecap: round; stroke-linejoin: round; stroke: rgb(34, 36, 42); stroke-width: 1px;",nonIntermediate:"stroke-width: 1.5; stroke-dash-array: 6",intermediate:"stroke-width: 1.5"},terminateIcon:Ce,timerIcon:Ee,userTaskIcon:Te});function Pe(e,n,i){var o=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return p(i,e),i.prototype.getShape=function(){var e=this.props.model,i=e,o=i.x,r=i.y,a=i.width,s=i.height,l=i.points,u=e.getNodeStyle();return t.h("g",{transform:"matrix(1 0 0 1 ".concat(o-a/2," ").concat(r-s/2,")")},t.h(t.Polygon,g(g({},u),{x:o,y:r,points:l})),"string"==typeof n?t.h("path",g(g({d:n},u),{fill:"rgb(34, 36, 42)",strokeWidth:1})):n)},i}(t.PolygonNode);return{type:e,view:o,model:function(e){function t(t,n){var o=this;return t.id||(t.id="Gateway_".concat(ge())),t.text||(t.text=""),t.text&&"string"==typeof t.text&&(t.text={value:t.text,x:t.x,y:t.y+40}),t.properties=g(g({},i||{}),t.properties),(o=e.call(this,t,n)||this).points=[[25,0],[50,25],[25,50],[0,25]],he.call(o),o}return p(t,e),t}(t.PolygonNodeModel)}}var De={parallel:Ae,sequential:ke,loop:Re};function Ie(e,n,i){var o=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return p(i,e),i.prototype.getLabelShape=function(){var e=this.props.model,i=e.x,o=e.y,r=e.width,a=e.height,s=e.getNodeStyle(),l=Array.isArray(n)?t.h.apply(void 0,E(["g",{transform:"matrix(1 0 0 1 ".concat(i-r/2," ").concat(o-a/2,")")}],w(n),!1)):t.h("path",{fill:s.stroke,d:n});return t.h("svg",{x:i-r/2+5,y:o-a/2+5,width:25,height:25,viewBox:"0 0 1274 1024"},l)},i.prototype.getShape=function(){var e=this.props.model,n=e.x,i=e.y,o=e.width,r=e.height,a=e.radius,s=e.properties,l=e.getNodeStyle();return t.h("g",{},[t.h("rect",g(g({},l),{x:n-o/2,y:i-r/2,rx:a,ry:a,width:o,height:r,opacity:.95})),this.getLabelShape(),t.h("g",{transform:"matrix(1 0 0 1 ".concat(n-o/2," ").concat(i-r/2,")")},t.h("path",{fill:"white",strokeLinecap:"round",strokeLinejoin:"round",stroke:"rgb(34, 36, 42)",strokeWidth:"2",d:De[s.multiInstanceType]||""}))])},i}(t.RectNode),r=function(e){function t(t,n){var o,r=this;t.id||(t.id="Activity_".concat(ge()));var a=g(g({},i||{}),t.properties);return t.properties=a,r=e.call(this,t,n)||this,null===(o=null==a?void 0:a.boundaryEvents)||void 0===o||o.forEach((function(e){r.addBoundaryEvent(e)})),r.deleteProperty("boundaryEvents"),he.call(r),r}return p(t,e),t.prototype.initNodeData=function(t){e.prototype.initNodeData.call(this,t),this.isTaskNode=!0,this.boundaryEvents=[]},t.prototype.getNodeStyle=function(){var t=e.prototype.getNodeStyle.call(this);return this.properties.isBoundaryEventTouchingTask&&(t.stroke="#00acff",t.strokeWidth=2),t},t.prototype.getOutlineStyle=function(){var t=e.prototype.getOutlineStyle.call(this);return t.stroke="transparent",!t.hover&&(t.hover={}),t.hover.stroke="transparent",t},t.prototype.setTouching=function(e){this.setProperty("isBoundaryEventTouchingTask",e)},t.prototype.addBoundaryEvent=function(e){if(this.setTouching(!1),this.boundaryEvents.find((function(t){return t===e})))return!1;var t=this.graphModel.getNodeModelById(e);return null==t||t.setProperties({attachedToRef:this.id}),this.boundaryEvents.push(e),!0},t.prototype.deleteBoundaryEvent=function(e){this.boundaryEvents=this.boundaryEvents.filter((function(t){return t!==e}))},t}(t.RectNodeModel);return{type:e,view:o,model:r}}var Le="object"==typeof global&&global&&global.Object===Object&&global,Be="object"==typeof self&&self&&self.Object===Object&&self,je=Le||Be||Function("return this")(),Fe=je.Symbol,He=Object.prototype,We=He.hasOwnProperty,ze=He.toString,Ge=Fe?Fe.toStringTag:void 0;var Ue=Object.prototype.toString;var qe="[object Null]",Xe="[object Undefined]",Ve=Fe?Fe.toStringTag:void 0;function Ke(e){return null==e?void 0===e?Xe:qe:Ve&&Ve in Object(e)?function(e){var t=We.call(e,Ge),n=e[Ge];try{e[Ge]=void 0;var i=!0}catch(e){}var o=ze.call(e);return i&&(t?e[Ge]=n:delete e[Ge]),o}(e):function(e){return Ue.call(e)}(e)}function Ye(e){return null!=e&&"object"==typeof e}var $e="[object Symbol]";function Ze(e){return"symbol"==typeof e||Ye(e)&&Ke(e)==$e}var Je=NaN;function Qe(e){return"number"==typeof e?e:Ze(e)?Je:+e}function et(e,t){for(var n=-1,i=null==e?0:e.length,o=Array(i);++n<i;)o[n]=t(e[n],n,e);return o}var tt=Array.isArray,nt=1/0,it=Fe?Fe.prototype:void 0,ot=it?it.toString:void 0;function rt(e){if("string"==typeof e)return e;if(tt(e))return et(e,rt)+"";if(Ze(e))return ot?ot.call(e):"";var t=e+"";return"0"==t&&1/e==-nt?"-0":t}function at(e,t){return function(n,i){var o;if(void 0===n&&void 0===i)return t;if(void 0!==n&&(o=n),void 0!==i){if(void 0===o)return i;"string"==typeof n||"string"==typeof i?(n=rt(n),i=rt(i)):(n=Qe(n),i=Qe(i)),o=e(n,i)}return o}}var st=at((function(e,t){return e+t}),0),lt=/\s/;function ut(e){for(var t=e.length;t--&&lt.test(e.charAt(t)););return t}var ct=/^\s+/;function dt(e){return e?e.slice(0,ut(e)+1).replace(ct,""):e}function ht(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}var ft=NaN,pt=/^[-+]0x[0-9a-f]+$/i,gt=/^0b[01]+$/i,vt=/^0o[0-7]+$/i,mt=parseInt;function yt(e){if("number"==typeof e)return e;if(Ze(e))return ft;if(ht(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=ht(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=dt(e);var n=gt.test(e);return n||vt.test(e)?mt(e.slice(2),n?2:8):pt.test(e)?ft:+e}var bt=1/0,xt=17976931348623157e292;function wt(e){return e?(e=yt(e))===bt||e===-bt?(e<0?-1:1)*xt:e==e?e:0:0===e?e:0}function Et(e){var t=wt(e),n=t%1;return t==t?n?t-n:t:0}function Ct(e){return e}var Nt="[object AsyncFunction]",_t="[object Function]",St="[object GeneratorFunction]",Mt="[object Proxy]";function Tt(e){if(!ht(e))return!1;var t=Ke(e);return t==_t||t==St||t==Nt||t==Mt}var At,kt=je["__core-js_shared__"],Rt=(At=/[^.]+$/.exec(kt&&kt.keys&&kt.keys.IE_PROTO||""))?"Symbol(src)_1."+At:"";var Ot=Function.prototype.toString;function Pt(e){if(null!=e){try{return Ot.call(e)}catch(e){}try{return e+""}catch(e){}}return""}var Dt=/^\[object .+?Constructor\]$/,It=Function.prototype,Lt=Object.prototype,Bt=It.toString,jt=Lt.hasOwnProperty,Ft=RegExp("^"+Bt.call(jt).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Ht(e){return!(!ht(e)||function(e){return!!Rt&&Rt in e}(e))&&(Tt(e)?Ft:Dt).test(Pt(e))}function Wt(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return Ht(n)?n:void 0}var zt=Wt(je,"WeakMap"),Gt=zt&&new zt,Ut=Gt?function(e,t){return Gt.set(e,t),e}:Ct,qt=Object.create,Xt=function(){function e(){}return function(t){if(!ht(t))return{};if(qt)return qt(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();function Vt(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=Xt(e.prototype),i=e.apply(n,t);return ht(i)?i:n}}var Kt=1;function Yt(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}var $t=Math.max;function Zt(e,t,n,i){for(var o=-1,r=e.length,a=n.length,s=-1,l=t.length,u=$t(r-a,0),c=Array(l+u),d=!i;++s<l;)c[s]=t[s];for(;++o<a;)(d||o<r)&&(c[n[o]]=e[o]);for(;u--;)c[s++]=e[o++];return c}var Jt=Math.max;function Qt(e,t,n,i){for(var o=-1,r=e.length,a=-1,s=n.length,l=-1,u=t.length,c=Jt(r-s,0),d=Array(c+u),h=!i;++o<c;)d[o]=e[o];for(var f=o;++l<u;)d[f+l]=t[l];for(;++a<s;)(h||o<r)&&(d[f+n[a]]=e[o++]);return d}function en(){}var tn=4294967295;function nn(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=tn,this.__views__=[]}function on(){}nn.prototype=Xt(en.prototype),nn.prototype.constructor=nn;var rn=Gt?function(e){return Gt.get(e)}:on,an={},sn=Object.prototype.hasOwnProperty;function ln(e){for(var t=e.name+"",n=an[t],i=sn.call(an,t)?n.length:0;i--;){var o=n[i],r=o.func;if(null==r||r==e)return o.name}return t}function un(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=void 0}function cn(e,t){var n=-1,i=e.length;for(t||(t=Array(i));++n<i;)t[n]=e[n];return t}function dn(e){if(e instanceof nn)return e.clone();var t=new un(e.__wrapped__,e.__chain__);return t.__actions__=cn(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}un.prototype=Xt(en.prototype),un.prototype.constructor=un;var hn=Object.prototype.hasOwnProperty;function fn(e){if(Ye(e)&&!tt(e)&&!(e instanceof nn)){if(e instanceof un)return e;if(hn.call(e,"__wrapped__"))return dn(e)}return new un(e)}function pn(e){var t=ln(e),n=fn[t];if("function"!=typeof n||!(t in nn.prototype))return!1;if(e===n)return!0;var i=rn(n);return!!i&&e===i[0]}fn.prototype=en.prototype,fn.prototype.constructor=fn;var gn=Date.now;function vn(e){var t=0,n=0;return function(){var i=gn(),o=16-(i-n);if(n=i,o>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var mn=vn(Ut),yn=/\{\n\/\* \[wrapped with (.+)\] \*/,bn=/,? & /;var xn=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/;function wn(e){return function(){return e}}var En=function(){try{var e=Wt(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),Cn=En?function(e,t){return En(e,"toString",{configurable:!0,enumerable:!1,value:wn(t),writable:!0})}:Ct,Nn=vn(Cn);function _n(e,t){for(var n=-1,i=null==e?0:e.length;++n<i&&!1!==t(e[n],n,e););return e}function Sn(e,t,n,i){for(var o=e.length,r=n+(i?1:-1);i?r--:++r<o;)if(t(e[r],r,e))return r;return-1}function Mn(e){return e!=e}function Tn(e,t,n){return t==t?function(e,t,n){for(var i=n-1,o=e.length;++i<o;)if(e[i]===t)return i;return-1}(e,t,n):Sn(e,Mn,n)}function An(e,t){return!!(null==e?0:e.length)&&Tn(e,t,0)>-1}var kn=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]];function Rn(e,t,n){var i=t+"";return Nn(e,function(e,t){var n=t.length;if(!n)return e;var i=n-1;return t[i]=(n>1?"& ":"")+t[i],t=t.join(n>2?", ":" "),e.replace(xn,"{\n/* [wrapped with "+t+"] */\n")}(i,function(e,t){return _n(kn,(function(n){var i="_."+n[0];t&n[1]&&!An(e,i)&&e.push(i)})),e.sort()}(function(e){var t=e.match(yn);return t?t[1].split(bn):[]}(i),n)))}var On=1,Pn=2,Dn=4,In=8,Ln=32,Bn=64;function jn(e,t,n,i,o,r,a,s,l,u){var c=t&In;t|=c?Ln:Bn,(t&=~(c?Bn:Ln))&Dn||(t&=~(On|Pn));var d=[e,t,o,c?r:void 0,c?a:void 0,c?void 0:r,c?void 0:a,s,l,u],h=n.apply(void 0,d);return pn(e)&&mn(h,d),h.placeholder=i,Rn(h,e,t)}function Fn(e){return e.placeholder}var Hn=9007199254740991,Wn=/^(?:0|[1-9]\d*)$/;function zn(e,t){var n=typeof e;return!!(t=null==t?Hn:t)&&("number"==n||"symbol"!=n&&Wn.test(e))&&e>-1&&e%1==0&&e<t}var Gn=Math.min;var Un="__lodash_placeholder__";function qn(e,t){for(var n=-1,i=e.length,o=0,r=[];++n<i;){var a=e[n];a!==t&&a!==Un||(e[n]=Un,r[o++]=n)}return r}var Xn=1,Vn=2,Kn=8,Yn=16,$n=128,Zn=512;function Jn(e,t,n,i,o,r,a,s,l,u){var c=t&$n,d=t&Xn,h=t&Vn,f=t&(Kn|Yn),p=t&Zn,g=h?void 0:Vt(e);return function v(){for(var m=arguments.length,y=Array(m),b=m;b--;)y[b]=arguments[b];if(f)var x=Fn(v),w=function(e,t){for(var n=e.length,i=0;n--;)e[n]===t&&++i;return i}(y,x);if(i&&(y=Zt(y,i,o,f)),r&&(y=Qt(y,r,a,f)),m-=w,f&&m<u){var E=qn(y,x);return jn(e,t,Jn,v.placeholder,n,y,E,s,l,u-m)}var C=d?n:this,N=h?C[e]:e;return m=y.length,s?y=function(e,t){for(var n=e.length,i=Gn(t.length,n),o=cn(e);i--;){var r=t[i];e[i]=zn(r,n)?o[r]:void 0}return e}(y,s):p&&m>1&&y.reverse(),c&&l<m&&(y.length=l),this&&this!==je&&this instanceof v&&(N=g||Vt(N)),N.apply(C,y)}}var Qn=1;var ei="__lodash_placeholder__",ti=1,ni=2,ii=4,oi=8,ri=128,ai=256,si=Math.min;var li="Expected a function",ui=1,ci=2,di=8,hi=16,fi=32,pi=64,gi=Math.max;function vi(e,t,n,i,o,r,a,s){var l=t&ci;if(!l&&"function"!=typeof e)throw new TypeError(li);var u=i?i.length:0;if(u||(t&=~(fi|pi),i=o=void 0),a=void 0===a?a:gi(Et(a),0),s=void 0===s?s:Et(s),u-=o?o.length:0,t&pi){var c=i,d=o;i=o=void 0}var h=l?void 0:rn(e),f=[e,t,n,i,o,c,d,r,a,s];if(h&&function(e,t){var n=e[1],i=t[1],o=n|i,r=o<(ti|ni|ri),a=i==ri&&n==oi||i==ri&&n==ai&&e[7].length<=t[8]||i==(ri|ai)&&t[7].length<=t[8]&&n==oi;if(!r&&!a)return e;i&ti&&(e[2]=t[2],o|=n&ti?0:ii);var s=t[3];if(s){var l=e[3];e[3]=l?Zt(l,s,t[4]):s,e[4]=l?qn(e[3],ei):t[4]}(s=t[5])&&(l=e[5],e[5]=l?Qt(l,s,t[6]):s,e[6]=l?qn(e[5],ei):t[6]),(s=t[7])&&(e[7]=s),i&ri&&(e[8]=null==e[8]?t[8]:si(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=o}(f,h),e=f[0],t=f[1],n=f[2],i=f[3],o=f[4],!(s=f[9]=void 0===f[9]?l?0:e.length:gi(f[9]-u,0))&&t&(di|hi)&&(t&=~(di|hi)),t&&t!=ui)p=t==di||t==hi?function(e,t,n){var i=Vt(e);return function o(){for(var r=arguments.length,a=Array(r),s=r,l=Fn(o);s--;)a[s]=arguments[s];var u=r<3&&a[0]!==l&&a[r-1]!==l?[]:qn(a,l);return(r-=u.length)<n?jn(e,t,Jn,o.placeholder,void 0,a,u,void 0,void 0,n-r):Yt(this&&this!==je&&this instanceof o?i:e,this,a)}}(e,t,s):t!=fi&&t!=(ui|fi)||o.length?Jn.apply(void 0,f):function(e,t,n,i){var o=t&Qn,r=Vt(e);return function t(){for(var a=-1,s=arguments.length,l=-1,u=i.length,c=Array(u+s),d=this&&this!==je&&this instanceof t?r:e;++l<u;)c[l]=i[l];for(;s--;)c[l++]=arguments[++a];return Yt(d,o?n:this,c)}}(e,t,n,i);else var p=function(e,t,n){var i=t&Kt,o=Vt(e);return function t(){return(this&&this!==je&&this instanceof t?o:e).apply(i?n:this,arguments)}}(e,t,n);return Rn((h?Ut:mn)(p,f),e,t)}var mi=128;function yi(e,t,n){return t=n?void 0:t,t=e&&null==t?e.length:t,vi(e,mi,void 0,void 0,void 0,void 0,t)}function bi(e,t,n){"__proto__"==t&&En?En(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function xi(e,t){return e===t||e!=e&&t!=t}var wi=Object.prototype.hasOwnProperty;function Ei(e,t,n){var i=e[t];wi.call(e,t)&&xi(i,n)&&(void 0!==n||t in e)||bi(e,t,n)}function Ci(e,t,n,i){var o=!n;n||(n={});for(var r=-1,a=t.length;++r<a;){var s=t[r],l=i?i(n[s],e[s],s,n,e):void 0;void 0===l&&(l=e[s]),o?bi(n,s,l):Ei(n,s,l)}return n}var Ni=Math.max;function _i(e,t,n){return t=Ni(void 0===t?e.length-1:t,0),function(){for(var i=arguments,o=-1,r=Ni(i.length-t,0),a=Array(r);++o<r;)a[o]=i[t+o];o=-1;for(var s=Array(t+1);++o<t;)s[o]=i[o];return s[t]=n(a),Yt(e,this,s)}}function Si(e,t){return Nn(_i(e,t,Ct),e+"")}var Mi=9007199254740991;function Ti(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=Mi}function Ai(e){return null!=e&&Ti(e.length)&&!Tt(e)}function ki(e,t,n){if(!ht(n))return!1;var i=typeof t;return!!("number"==i?Ai(n)&&zn(t,n.length):"string"==i&&t in n)&&xi(n[t],e)}function Ri(e){return Si((function(t,n){var i=-1,o=n.length,r=o>1?n[o-1]:void 0,a=o>2?n[2]:void 0;for(r=e.length>3&&"function"==typeof r?(o--,r):void 0,a&&ki(n[0],n[1],a)&&(r=o<3?void 0:r,o=1),t=Object(t);++i<o;){var s=n[i];s&&e(t,s,i,r)}return t}))}var Oi=Object.prototype;function Pi(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Oi)}function Di(e,t){for(var n=-1,i=Array(e);++n<e;)i[n]=t(n);return i}function Ii(e){return Ye(e)&&"[object Arguments]"==Ke(e)}var Li=Object.prototype,Bi=Li.hasOwnProperty,ji=Li.propertyIsEnumerable,Fi=Ii(function(){return arguments}())?Ii:function(e){return Ye(e)&&Bi.call(e,"callee")&&!ji.call(e,"callee")};function Hi(){return!1}var Wi="object"==typeof e&&e&&!e.nodeType&&e,zi=Wi&&"object"==typeof module&&module&&!module.nodeType&&module,Gi=zi&&zi.exports===Wi?je.Buffer:void 0,Ui=(Gi?Gi.isBuffer:void 0)||Hi,qi={};function Xi(e){return function(t){return e(t)}}qi["[object Float32Array]"]=qi["[object Float64Array]"]=qi["[object Int8Array]"]=qi["[object Int16Array]"]=qi["[object Int32Array]"]=qi["[object Uint8Array]"]=qi["[object Uint8ClampedArray]"]=qi["[object Uint16Array]"]=qi["[object Uint32Array]"]=!0,qi["[object Arguments]"]=qi["[object Array]"]=qi["[object ArrayBuffer]"]=qi["[object Boolean]"]=qi["[object DataView]"]=qi["[object Date]"]=qi["[object Error]"]=qi["[object Function]"]=qi["[object Map]"]=qi["[object Number]"]=qi["[object Object]"]=qi["[object RegExp]"]=qi["[object Set]"]=qi["[object String]"]=qi["[object WeakMap]"]=!1;var Vi="object"==typeof e&&e&&!e.nodeType&&e,Ki=Vi&&"object"==typeof module&&module&&!module.nodeType&&module,Yi=Ki&&Ki.exports===Vi&&Le.process,$i=function(){try{var e=Ki&&Ki.require&&Ki.require("util").types;return e||Yi&&Yi.binding&&Yi.binding("util")}catch(e){}}(),Zi=$i&&$i.isTypedArray,Ji=Zi?Xi(Zi):function(e){return Ye(e)&&Ti(e.length)&&!!qi[Ke(e)]},Qi=Object.prototype.hasOwnProperty;function eo(e,t){var n=tt(e),i=!n&&Fi(e),o=!n&&!i&&Ui(e),r=!n&&!i&&!o&&Ji(e),a=n||i||o||r,s=a?Di(e.length,String):[],l=s.length;for(var u in e)!t&&!Qi.call(e,u)||a&&("length"==u||o&&("offset"==u||"parent"==u)||r&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||zn(u,l))||s.push(u);return s}function to(e,t){return function(n){return e(t(n))}}var no=to(Object.keys,Object),io=Object.prototype.hasOwnProperty;function oo(e){if(!Pi(e))return no(e);var t=[];for(var n in Object(e))io.call(e,n)&&"constructor"!=n&&t.push(n);return t}function ro(e){return Ai(e)?eo(e):oo(e)}var ao=Object.prototype.hasOwnProperty,so=Ri((function(e,t){if(Pi(t)||Ai(t))Ci(t,ro(t),e);else for(var n in t)ao.call(t,n)&&Ei(e,n,t[n])}));var lo=Object.prototype.hasOwnProperty;function uo(e){if(!ht(e))return function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}(e);var t=Pi(e),n=[];for(var i in e)("constructor"!=i||!t&&lo.call(e,i))&&n.push(i);return n}function co(e){return Ai(e)?eo(e,!0):uo(e)}var ho=Ri((function(e,t){Ci(t,co(t),e)})),fo=Ri((function(e,t,n,i){Ci(t,co(t),e,i)})),po=Ri((function(e,t,n,i){Ci(t,ro(t),e,i)})),go=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,vo=/^\w*$/;function mo(e,t){if(tt(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!Ze(e))||(vo.test(e)||!go.test(e)||null!=t&&e in Object(t))}var yo=Wt(Object,"create");var bo=Object.prototype.hasOwnProperty;var xo=Object.prototype.hasOwnProperty;function wo(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}function Eo(e,t){for(var n=e.length;n--;)if(xi(e[n][0],t))return n;return-1}wo.prototype.clear=function(){this.__data__=yo?yo(null):{},this.size=0},wo.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},wo.prototype.get=function(e){var t=this.__data__;if(yo){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return bo.call(t,e)?t[e]:void 0},wo.prototype.has=function(e){var t=this.__data__;return yo?void 0!==t[e]:xo.call(t,e)},wo.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=yo&&void 0===t?"__lodash_hash_undefined__":t,this};var Co=Array.prototype.splice;function No(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}No.prototype.clear=function(){this.__data__=[],this.size=0},No.prototype.delete=function(e){var t=this.__data__,n=Eo(t,e);return!(n<0)&&(n==t.length-1?t.pop():Co.call(t,n,1),--this.size,!0)},No.prototype.get=function(e){var t=this.__data__,n=Eo(t,e);return n<0?void 0:t[n][1]},No.prototype.has=function(e){return Eo(this.__data__,e)>-1},No.prototype.set=function(e,t){var n=this.__data__,i=Eo(n,e);return i<0?(++this.size,n.push([e,t])):n[i][1]=t,this};var _o=Wt(je,"Map");function So(e,t){var n=e.__data__;return function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}(t)?n["string"==typeof t?"string":"hash"]:n.map}function Mo(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}Mo.prototype.clear=function(){this.size=0,this.__data__={hash:new wo,map:new(_o||No),string:new wo}},Mo.prototype.delete=function(e){var t=So(this,e).delete(e);return this.size-=t?1:0,t},Mo.prototype.get=function(e){return So(this,e).get(e)},Mo.prototype.has=function(e){return So(this,e).has(e)},Mo.prototype.set=function(e,t){var n=So(this,e),i=n.size;return n.set(e,t),this.size+=n.size==i?0:1,this};var To="Expected a function";function Ao(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError(To);var n=function(){var i=arguments,o=t?t.apply(this,i):i[0],r=n.cache;if(r.has(o))return r.get(o);var a=e.apply(this,i);return n.cache=r.set(o,a)||r,a};return n.cache=new(Ao.Cache||Mo),n}Ao.Cache=Mo;var ko=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Ro=/\\(\\)?/g,Oo=function(e){var t=Ao(e,(function(e){return 500===n.size&&n.clear(),e})),n=t.cache;return t}((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(ko,(function(e,n,i,o){t.push(i?o.replace(Ro,"$1"):n||e)})),t}));function Po(e){return null==e?"":rt(e)}function Do(e,t){return tt(e)?e:mo(e,t)?[e]:Oo(Po(e))}var Io=1/0;function Lo(e){if("string"==typeof e||Ze(e))return e;var t=e+"";return"0"==t&&1/e==-Io?"-0":t}function Bo(e,t){for(var n=0,i=(t=Do(t,e)).length;null!=e&&n<i;)e=e[Lo(t[n++])];return n&&n==i?e:void 0}function jo(e,t,n){var i=null==e?void 0:Bo(e,t);return void 0===i?n:i}function Fo(e,t){for(var n=-1,i=t.length,o=Array(i),r=null==e;++n<i;)o[n]=r?void 0:jo(e,t[n]);return o}function Ho(e,t){for(var n=-1,i=t.length,o=e.length;++n<i;)e[o+n]=t[n];return e}var Wo=Fe?Fe.isConcatSpreadable:void 0;function zo(e){return tt(e)||Fi(e)||!!(Wo&&e&&e[Wo])}function Go(e,t,n,i,o){var r=-1,a=e.length;for(n||(n=zo),o||(o=[]);++r<a;){var s=e[r];t>0&&n(s)?t>1?Go(s,t-1,n,i,o):Ho(o,s):i||(o[o.length]=s)}return o}function Uo(e){return(null==e?0:e.length)?Go(e,1):[]}function qo(e){return Nn(_i(e,void 0,Uo),e+"")}var Xo=qo(Fo),Vo=to(Object.getPrototypeOf,Object),Ko="[object Object]",Yo=Function.prototype,$o=Object.prototype,Zo=Yo.toString,Jo=$o.hasOwnProperty,Qo=Zo.call(Object);function er(e){if(!Ye(e)||Ke(e)!=Ko)return!1;var t=Vo(e);if(null===t)return!0;var n=Jo.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&Zo.call(n)==Qo}var tr="[object DOMException]",nr="[object Error]";function ir(e){if(!Ye(e))return!1;var t=Ke(e);return t==nr||t==tr||"string"==typeof e.message&&"string"==typeof e.name&&!er(e)}var or=Si((function(e,t){try{return Yt(e,void 0,t)}catch(e){return ir(e)?e:new Error(e)}})),rr="Expected a function";function ar(e,t){var n;if("function"!=typeof t)throw new TypeError(rr);return e=Et(e),function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=void 0),n}}var sr=Si((function(e,t,n){var i=1;if(n.length){var o=qn(n,Fn(sr));i|=32}return vi(e,i,t,n,o)}));sr.placeholder={};var lr=qo((function(e,t){return _n(t,(function(t){t=Lo(t),bi(e,t,sr(e[t],e))})),e})),ur=Si((function(e,t,n){var i=3;if(n.length){var o=qn(n,Fn(ur));i|=32}return vi(t,i,e,n,o)}));function cr(e,t,n){var i=-1,o=e.length;t<0&&(t=-t>o?0:o+t),(n=n>o?o:n)<0&&(n+=o),o=t>n?0:n-t>>>0,t>>>=0;for(var r=Array(o);++i<o;)r[i]=e[i+t];return r}function dr(e,t,n){var i=e.length;return n=void 0===n?i:n,!t&&n>=i?e:cr(e,t,n)}ur.placeholder={};var hr=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");function fr(e){return hr.test(e)}var pr="\\ud800-\\udfff",gr="["+pr+"]",vr="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",mr="\\ud83c[\\udffb-\\udfff]",yr="[^"+pr+"]",br="(?:\\ud83c[\\udde6-\\uddff]){2}",xr="[\\ud800-\\udbff][\\udc00-\\udfff]",wr="(?:"+vr+"|"+mr+")"+"?",Er="[\\ufe0e\\ufe0f]?",Cr=Er+wr+("(?:\\u200d(?:"+[yr,br,xr].join("|")+")"+Er+wr+")*"),Nr="(?:"+[yr+vr+"?",vr,br,xr,gr].join("|")+")",_r=RegExp(mr+"(?="+mr+")|"+Nr+Cr,"g");function Sr(e){return fr(e)?function(e){return e.match(_r)||[]}(e):function(e){return e.split("")}(e)}function Mr(e){return function(t){var n=fr(t=Po(t))?Sr(t):void 0,i=n?n[0]:t.charAt(0),o=n?dr(n,1).join(""):t.slice(1);return i[e]()+o}}var Tr=Mr("toUpperCase");function Ar(e){return Tr(Po(e).toLowerCase())}function kr(e,t,n,i){var o=-1,r=null==e?0:e.length;for(i&&r&&(n=e[++o]);++o<r;)n=t(n,e[o],o,e);return n}function Rr(e){return function(t){return null==e?void 0:e[t]}}var Or=Rr({"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"s"}),Pr=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Dr=RegExp("[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]","g");function Ir(e){return(e=Po(e))&&e.replace(Pr,Or).replace(Dr,"")}var Lr=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;var Br=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;var jr="\\ud800-\\udfff",Fr="\\u2700-\\u27bf",Hr="a-z\\xdf-\\xf6\\xf8-\\xff",Wr="A-Z\\xc0-\\xd6\\xd8-\\xde",zr="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Gr="["+zr+"]",Ur="\\d+",qr="["+Fr+"]",Xr="["+Hr+"]",Vr="[^"+jr+zr+Ur+Fr+Hr+Wr+"]",Kr="(?:\\ud83c[\\udde6-\\uddff]){2}",Yr="[\\ud800-\\udbff][\\udc00-\\udfff]",$r="["+Wr+"]",Zr="(?:"+Xr+"|"+Vr+")",Jr="(?:"+$r+"|"+Vr+")",Qr="(?:['’](?:d|ll|m|re|s|t|ve))?",ea="(?:['’](?:D|LL|M|RE|S|T|VE))?",ta="(?:[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]|\\ud83c[\\udffb-\\udfff])?",na="[\\ufe0e\\ufe0f]?",ia=na+ta+("(?:\\u200d(?:"+["[^"+jr+"]",Kr,Yr].join("|")+")"+na+ta+")*"),oa="(?:"+[qr,Kr,Yr].join("|")+")"+ia,ra=RegExp([$r+"?"+Xr+"+"+Qr+"(?="+[Gr,$r,"$"].join("|")+")",Jr+"+"+ea+"(?="+[Gr,$r+Zr,"$"].join("|")+")",$r+"?"+Zr+"+"+Qr,$r+"+"+ea,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Ur,oa].join("|"),"g");function aa(e,t,n){return e=Po(e),void 0===(t=n?void 0:t)?function(e){return Br.test(e)}(e)?function(e){return e.match(ra)||[]}(e):function(e){return e.match(Lr)||[]}(e):e.match(t)||[]}var sa=RegExp("['’]","g");function la(e){return function(t){return kr(aa(Ir(t).replace(sa,"")),e,"")}}var ua=la((function(e,t,n){return t=t.toLowerCase(),e+(n?Ar(t):t)}));var ca=je.isFinite,da=Math.min;function ha(e){var t=Math[e];return function(e,n){if(e=yt(e),(n=null==n?0:da(Et(n),292))&&ca(e)){var i=(Po(e)+"e").split("e");return+((i=(Po(t(i[0]+"e"+(+i[1]+n)))+"e").split("e"))[0]+"e"+(+i[1]-n))}return t(e)}}var fa=ha("ceil");function pa(e){var t=fn(e);return t.__chain__=!0,t}var ga=Math.ceil,va=Math.max;function ma(e,t,n){return e==e&&(void 0!==n&&(e=e<=n?e:n),void 0!==t&&(e=e>=t?e:t)),e}function ya(e){var t=this.__data__=new No(e);this.size=t.size}function ba(e,t){return e&&Ci(t,ro(t),e)}ya.prototype.clear=function(){this.__data__=new No,this.size=0},ya.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},ya.prototype.get=function(e){return this.__data__.get(e)},ya.prototype.has=function(e){return this.__data__.has(e)},ya.prototype.set=function(e,t){var n=this.__data__;if(n instanceof No){var i=n.__data__;if(!_o||i.length<199)return i.push([e,t]),this.size=++n.size,this;n=this.__data__=new Mo(i)}return n.set(e,t),this.size=n.size,this};var xa="object"==typeof e&&e&&!e.nodeType&&e,wa=xa&&"object"==typeof module&&module&&!module.nodeType&&module,Ea=wa&&wa.exports===xa?je.Buffer:void 0,Ca=Ea?Ea.allocUnsafe:void 0;function Na(e,t){if(t)return e.slice();var n=e.length,i=Ca?Ca(n):new e.constructor(n);return e.copy(i),i}function _a(e,t){for(var n=-1,i=null==e?0:e.length,o=0,r=[];++n<i;){var a=e[n];t(a,n,e)&&(r[o++]=a)}return r}function Sa(){return[]}var Ma=Object.prototype.propertyIsEnumerable,Ta=Object.getOwnPropertySymbols,Aa=Ta?function(e){return null==e?[]:(e=Object(e),_a(Ta(e),(function(t){return Ma.call(e,t)})))}:Sa;var ka=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)Ho(t,Aa(e)),e=Vo(e);return t}:Sa;function Ra(e,t,n){var i=t(e);return tt(e)?i:Ho(i,n(e))}function Oa(e){return Ra(e,ro,Aa)}function Pa(e){return Ra(e,co,ka)}var Da=Wt(je,"DataView"),Ia=Wt(je,"Promise"),La=Wt(je,"Set"),Ba="[object Map]",ja="[object Promise]",Fa="[object Set]",Ha="[object WeakMap]",Wa="[object DataView]",za=Pt(Da),Ga=Pt(_o),Ua=Pt(Ia),qa=Pt(La),Xa=Pt(zt),Va=Ke;(Da&&Va(new Da(new ArrayBuffer(1)))!=Wa||_o&&Va(new _o)!=Ba||Ia&&Va(Ia.resolve())!=ja||La&&Va(new La)!=Fa||zt&&Va(new zt)!=Ha)&&(Va=function(e){var t=Ke(e),n="[object Object]"==t?e.constructor:void 0,i=n?Pt(n):"";if(i)switch(i){case za:return Wa;case Ga:return Ba;case Ua:return ja;case qa:return Fa;case Xa:return Ha}return t});var Ka=Va,Ya=Object.prototype.hasOwnProperty;var $a=je.Uint8Array;function Za(e){var t=new e.constructor(e.byteLength);return new $a(t).set(new $a(e)),t}var Ja=/\w*$/;var Qa=Fe?Fe.prototype:void 0,es=Qa?Qa.valueOf:void 0;function ts(e,t){var n=t?Za(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}var ns="[object Boolean]",is="[object Date]",os="[object Map]",rs="[object Number]",as="[object RegExp]",ss="[object Set]",ls="[object String]",us="[object Symbol]",cs="[object ArrayBuffer]",ds="[object DataView]",hs="[object Float32Array]",fs="[object Float64Array]",ps="[object Int8Array]",gs="[object Int16Array]",vs="[object Int32Array]",ms="[object Uint8Array]",ys="[object Uint8ClampedArray]",bs="[object Uint16Array]",xs="[object Uint32Array]";function ws(e,t,n){var i,o=e.constructor;switch(t){case cs:return Za(e);case ns:case is:return new o(+e);case ds:return function(e,t){var n=t?Za(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}(e,n);case hs:case fs:case ps:case gs:case vs:case ms:case ys:case bs:case xs:return ts(e,n);case os:return new o;case rs:case ls:return new o(e);case as:return function(e){var t=new e.constructor(e.source,Ja.exec(e));return t.lastIndex=e.lastIndex,t}(e);case ss:return new o;case us:return i=e,es?Object(es.call(i)):{}}}function Es(e){return"function"!=typeof e.constructor||Pi(e)?{}:Xt(Vo(e))}var Cs=$i&&$i.isMap,Ns=Cs?Xi(Cs):function(e){return Ye(e)&&"[object Map]"==Ka(e)};var _s=$i&&$i.isSet,Ss=_s?Xi(_s):function(e){return Ye(e)&&"[object Set]"==Ka(e)},Ms=1,Ts=2,As=4,ks="[object Arguments]",Rs="[object Function]",Os="[object GeneratorFunction]",Ps="[object Object]",Ds={};function Is(e,t,n,i,o,r){var a,s=t&Ms,l=t&Ts,u=t&As;if(n&&(a=o?n(e,i,o,r):n(e)),void 0!==a)return a;if(!ht(e))return e;var c=tt(e);if(c){if(a=function(e){var t=e.length,n=new e.constructor(t);return t&&"string"==typeof e[0]&&Ya.call(e,"index")&&(n.index=e.index,n.input=e.input),n}(e),!s)return cn(e,a)}else{var d=Ka(e),h=d==Rs||d==Os;if(Ui(e))return Na(e,s);if(d==Ps||d==ks||h&&!o){if(a=l||h?{}:Es(e),!s)return l?function(e,t){return Ci(e,ka(e),t)}(e,function(e,t){return e&&Ci(t,co(t),e)}(a,e)):function(e,t){return Ci(e,Aa(e),t)}(e,ba(a,e))}else{if(!Ds[d])return o?e:{};a=ws(e,d,s)}}r||(r=new ya);var f=r.get(e);if(f)return f;r.set(e,a),Ss(e)?e.forEach((function(i){a.add(Is(i,t,n,i,e,r))})):Ns(e)&&e.forEach((function(i,o){a.set(o,Is(i,t,n,o,e,r))}));var p=c?void 0:(u?l?Pa:Oa:l?co:ro)(e);return _n(p||e,(function(i,o){p&&(i=e[o=i]),Ei(a,o,Is(i,t,n,o,e,r))})),a}Ds[ks]=Ds["[object Array]"]=Ds["[object ArrayBuffer]"]=Ds["[object DataView]"]=Ds["[object Boolean]"]=Ds["[object Date]"]=Ds["[object Float32Array]"]=Ds["[object Float64Array]"]=Ds["[object Int8Array]"]=Ds["[object Int16Array]"]=Ds["[object Int32Array]"]=Ds["[object Map]"]=Ds["[object Number]"]=Ds[Ps]=Ds["[object RegExp]"]=Ds["[object Set]"]=Ds["[object String]"]=Ds["[object Symbol]"]=Ds["[object Uint8Array]"]=Ds["[object Uint8ClampedArray]"]=Ds["[object Uint16Array]"]=Ds["[object Uint32Array]"]=!0,Ds["[object Error]"]=Ds[Rs]=Ds["[object WeakMap]"]=!1;function Ls(e){return Is(e,5)}function Bs(){var e=arguments.length;if(!e)return[];for(var t=Array(e-1),n=arguments[0],i=e;i--;)t[i-1]=arguments[i];return Ho(tt(n)?cn(n):[n],Go(t,1))}function js(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new Mo;++t<n;)this.add(e[t])}function Fs(e,t){for(var n=-1,i=null==e?0:e.length;++n<i;)if(t(e[n],n,e))return!0;return!1}function Hs(e,t){return e.has(t)}js.prototype.add=js.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},js.prototype.has=function(e){return this.__data__.has(e)};var Ws=1,zs=2;function Gs(e,t,n,i,o,r){var a=n&Ws,s=e.length,l=t.length;if(s!=l&&!(a&&l>s))return!1;var u=r.get(e),c=r.get(t);if(u&&c)return u==t&&c==e;var d=-1,h=!0,f=n&zs?new js:void 0;for(r.set(e,t),r.set(t,e);++d<s;){var p=e[d],g=t[d];if(i)var v=a?i(g,p,d,t,e,r):i(p,g,d,e,t,r);if(void 0!==v){if(v)continue;h=!1;break}if(f){if(!Fs(t,(function(e,t){if(!Hs(f,t)&&(p===e||o(p,e,n,i,r)))return f.push(t)}))){h=!1;break}}else if(p!==g&&!o(p,g,n,i,r)){h=!1;break}}return r.delete(e),r.delete(t),h}function Us(e){var t=-1,n=Array(e.size);return e.forEach((function(e,i){n[++t]=[i,e]})),n}function qs(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}var Xs=1,Vs=2,Ks="[object Boolean]",Ys="[object Date]",$s="[object Error]",Zs="[object Map]",Js="[object Number]",Qs="[object RegExp]",el="[object Set]",tl="[object String]",nl="[object Symbol]",il="[object ArrayBuffer]",ol="[object DataView]",rl=Fe?Fe.prototype:void 0,al=rl?rl.valueOf:void 0;var sl=1,ll=Object.prototype.hasOwnProperty;var ul=1,cl="[object Arguments]",dl="[object Array]",hl="[object Object]",fl=Object.prototype.hasOwnProperty;function pl(e,t,n,i,o,r){var a=tt(e),s=tt(t),l=a?dl:Ka(e),u=s?dl:Ka(t),c=(l=l==cl?hl:l)==hl,d=(u=u==cl?hl:u)==hl,h=l==u;if(h&&Ui(e)){if(!Ui(t))return!1;a=!0,c=!1}if(h&&!c)return r||(r=new ya),a||Ji(e)?Gs(e,t,n,i,o,r):function(e,t,n,i,o,r,a){switch(n){case ol:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case il:return!(e.byteLength!=t.byteLength||!r(new $a(e),new $a(t)));case Ks:case Ys:case Js:return xi(+e,+t);case $s:return e.name==t.name&&e.message==t.message;case Qs:case tl:return e==t+"";case Zs:var s=Us;case el:var l=i&Xs;if(s||(s=qs),e.size!=t.size&&!l)return!1;var u=a.get(e);if(u)return u==t;i|=Vs,a.set(e,t);var c=Gs(s(e),s(t),i,o,r,a);return a.delete(e),c;case nl:if(al)return al.call(e)==al.call(t)}return!1}(e,t,l,n,i,o,r);if(!(n&ul)){var f=c&&fl.call(e,"__wrapped__"),p=d&&fl.call(t,"__wrapped__");if(f||p){var g=f?e.value():e,v=p?t.value():t;return r||(r=new ya),o(g,v,n,i,r)}}return!!h&&(r||(r=new ya),function(e,t,n,i,o,r){var a=n&sl,s=Oa(e),l=s.length;if(l!=Oa(t).length&&!a)return!1;for(var u=l;u--;){var c=s[u];if(!(a?c in t:ll.call(t,c)))return!1}var d=r.get(e),h=r.get(t);if(d&&h)return d==t&&h==e;var f=!0;r.set(e,t),r.set(t,e);for(var p=a;++u<l;){var g=e[c=s[u]],v=t[c];if(i)var m=a?i(v,g,c,t,e,r):i(g,v,c,e,t,r);if(!(void 0===m?g===v||o(g,v,n,i,r):m)){f=!1;break}p||(p="constructor"==c)}if(f&&!p){var y=e.constructor,b=t.constructor;y==b||!("constructor"in e)||!("constructor"in t)||"function"==typeof y&&y instanceof y&&"function"==typeof b&&b instanceof b||(f=!1)}return r.delete(e),r.delete(t),f}(e,t,n,i,o,r))}function gl(e,t,n,i,o){return e===t||(null==e||null==t||!Ye(e)&&!Ye(t)?e!=e&&t!=t:pl(e,t,n,i,gl,o))}var vl=1,ml=2;function yl(e,t,n,i){var o=n.length,r=o,a=!i;if(null==e)return!r;for(e=Object(e);o--;){var s=n[o];if(a&&s[2]?s[1]!==e[s[0]]:!(s[0]in e))return!1}for(;++o<r;){var l=(s=n[o])[0],u=e[l],c=s[1];if(a&&s[2]){if(void 0===u&&!(l in e))return!1}else{var d=new ya;if(i)var h=i(u,c,l,e,t,d);if(!(void 0===h?gl(c,u,vl|ml,i,d):h))return!1}}return!0}function bl(e){return e==e&&!ht(e)}function xl(e){for(var t=ro(e),n=t.length;n--;){var i=t[n],o=e[i];t[n]=[i,o,bl(o)]}return t}function wl(e,t){return function(n){return null!=n&&(n[e]===t&&(void 0!==t||e in Object(n)))}}function El(e){var t=xl(e);return 1==t.length&&t[0][2]?wl(t[0][0],t[0][1]):function(n){return n===e||yl(n,e,t)}}function Cl(e,t){return null!=e&&t in Object(e)}function Nl(e,t,n){for(var i=-1,o=(t=Do(t,e)).length,r=!1;++i<o;){var a=Lo(t[i]);if(!(r=null!=e&&n(e,a)))break;e=e[a]}return r||++i!=o?r:!!(o=null==e?0:e.length)&&Ti(o)&&zn(a,o)&&(tt(e)||Fi(e))}function _l(e,t){return null!=e&&Nl(e,t,Cl)}var Sl=1,Ml=2;function Tl(e,t){return mo(e)&&bl(t)?wl(Lo(e),t):function(n){var i=jo(n,e);return void 0===i&&i===t?_l(n,e):gl(t,i,Sl|Ml)}}function Al(e){return function(t){return null==t?void 0:t[e]}}function kl(e){return mo(e)?Al(Lo(e)):function(e){return function(t){return Bo(t,e)}}(e)}function Rl(e){return"function"==typeof e?e:null==e?Ct:"object"==typeof e?tt(e)?Tl(e[0],e[1]):El(e):kl(e)}function Ol(e,t,n){var i=n.length;if(null==e)return!i;for(e=Object(e);i--;){var o=n[i],r=t[o],a=e[o];if(void 0===a&&!(o in e)||!r(a))return!1}return!0}function Pl(e,t,n,i){for(var o=-1,r=null==e?0:e.length;++o<r;){var a=e[o];t(i,a,n(a),e)}return i}function Dl(e){return function(t,n,i){for(var o=-1,r=Object(t),a=i(t),s=a.length;s--;){var l=a[e?s:++o];if(!1===n(r[l],l,r))break}return t}}var Il=Dl();function Ll(e,t){return e&&Il(e,t,ro)}function Bl(e,t){return function(n,i){if(null==n)return n;if(!Ai(n))return e(n,i);for(var o=n.length,r=t?o:-1,a=Object(n);(t?r--:++r<o)&&!1!==i(a[r],r,a););return n}}var jl=Bl(Ll);function Fl(e,t,n,i){return jl(e,(function(e,o,r){t(i,e,n(e),r)})),i}function Hl(e,t){return function(n,i){var o=tt(n)?Pl:Fl,r=t?t():{};return o(n,e,Rl(i),r)}}var Wl=Object.prototype.hasOwnProperty,zl=Hl((function(e,t,n){Wl.call(e,n)?++e[n]:bi(e,n,1)}));function Gl(e,t,n){var i=vi(e,8,void 0,void 0,void 0,void 0,void 0,t=n?void 0:t);return i.placeholder=Gl.placeholder,i}Gl.placeholder={};function Ul(e,t,n){var i=vi(e,16,void 0,void 0,void 0,void 0,void 0,t=n?void 0:t);return i.placeholder=Ul.placeholder,i}Ul.placeholder={};var ql=function(){return je.Date.now()},Xl="Expected a function",Vl=Math.max,Kl=Math.min;function Yl(e,t,n){var i,o,r,a,s,l,u=0,c=!1,d=!1,h=!0;if("function"!=typeof e)throw new TypeError(Xl);function f(t){var n=i,r=o;return i=o=void 0,u=t,a=e.apply(r,n)}function p(e){var n=e-l;return void 0===l||n>=t||n<0||d&&e-u>=r}function g(){var e=ql();if(p(e))return v(e);s=setTimeout(g,function(e){var n=t-(e-l);return d?Kl(n,r-(e-u)):n}(e))}function v(e){return s=void 0,h&&i?f(e):(i=o=void 0,a)}function m(){var e=ql(),n=p(e);if(i=arguments,o=this,l=e,n){if(void 0===s)return function(e){return u=e,s=setTimeout(g,t),c?f(e):a}(l);if(d)return clearTimeout(s),s=setTimeout(g,t),f(l)}return void 0===s&&(s=setTimeout(g,t)),a}return t=yt(t)||0,ht(n)&&(c=!!n.leading,r=(d="maxWait"in n)?Vl(yt(n.maxWait)||0,t):r,h="trailing"in n?!!n.trailing:h),m.cancel=function(){void 0!==s&&clearTimeout(s),u=0,i=l=o=s=void 0},m.flush=function(){return void 0===s?a:v(ql())},m}var $l=Object.prototype,Zl=$l.hasOwnProperty,Jl=Si((function(e,t){e=Object(e);var n=-1,i=t.length,o=i>2?t[2]:void 0;for(o&&ki(t[0],t[1],o)&&(i=1);++n<i;)for(var r=t[n],a=co(r),s=-1,l=a.length;++s<l;){var u=a[s],c=e[u];(void 0===c||xi(c,$l[u])&&!Zl.call(e,u))&&(e[u]=r[u])}return e}));function Ql(e,t,n){(void 0!==n&&!xi(e[t],n)||void 0===n&&!(t in e))&&bi(e,t,n)}function eu(e){return Ye(e)&&Ai(e)}function tu(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}function nu(e){return Ci(e,co(e))}function iu(e,t,n,i,o){e!==t&&Il(t,(function(r,a){if(o||(o=new ya),ht(r))!function(e,t,n,i,o,r,a){var s=tu(e,n),l=tu(t,n),u=a.get(l);if(u)Ql(e,n,u);else{var c=r?r(s,l,n+"",e,t,a):void 0,d=void 0===c;if(d){var h=tt(l),f=!h&&Ui(l),p=!h&&!f&&Ji(l);c=l,h||f||p?tt(s)?c=s:eu(s)?c=cn(s):f?(d=!1,c=Na(l,!0)):p?(d=!1,c=ts(l,!0)):c=[]:er(l)||Fi(l)?(c=s,Fi(s)?c=nu(s):ht(s)&&!Tt(s)||(c=Es(l))):d=!1}d&&(a.set(l,c),o(c,l,i,r,a),a.delete(l)),Ql(e,n,c)}}(e,t,a,n,iu,i,o);else{var s=i?i(tu(e,a),r,a+"",e,t,o):void 0;void 0===s&&(s=r),Ql(e,a,s)}}),co)}function ou(e,t,n,i,o,r){return ht(e)&&ht(t)&&(r.set(t,e),iu(e,t,void 0,ou,r),r.delete(t)),e}var ru=Ri((function(e,t,n,i){iu(e,t,n,i)})),au=Si((function(e){return e.push(void 0,ou),Yt(ru,void 0,e)}));function su(e,t,n){if("function"!=typeof e)throw new TypeError("Expected a function");return setTimeout((function(){e.apply(void 0,n)}),t)}var lu=Si((function(e,t){return su(e,1,t)})),uu=Si((function(e,t,n){return su(e,yt(t)||0,n)}));function cu(e,t,n){for(var i=-1,o=null==e?0:e.length;++i<o;)if(n(t,e[i]))return!0;return!1}var du=200;function hu(e,t,n,i){var o=-1,r=An,a=!0,s=e.length,l=[],u=t.length;if(!s)return l;n&&(t=et(t,Xi(n))),i?(r=cu,a=!1):t.length>=du&&(r=Hs,a=!1,t=new js(t));e:for(;++o<s;){var c=e[o],d=null==n?c:n(c);if(c=i||0!==c?c:0,a&&d==d){for(var h=u;h--;)if(t[h]===d)continue e;l.push(c)}else r(t,d,i)||l.push(c)}return l}var fu=Si((function(e,t){return eu(e)?hu(e,Go(t,1,eu,!0)):[]}));function pu(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}var gu=Si((function(e,t){var n=pu(t);return eu(n)&&(n=void 0),eu(e)?hu(e,Go(t,1,eu,!0),Rl(n)):[]})),vu=Si((function(e,t){var n=pu(t);return eu(n)&&(n=void 0),eu(e)?hu(e,Go(t,1,eu,!0),void 0,n):[]})),mu=at((function(e,t){return e/t}),1);function yu(e,t,n,i){for(var o=e.length,r=i?o:-1;(i?r--:++r<o)&&t(e[r],r,e););return n?cr(e,i?0:r,i?r+1:o):cr(e,i?r+1:0,i?o:r)}function bu(e){return"function"==typeof e?e:Ct}function xu(e,t){return(tt(e)?_n:jl)(e,bu(t))}function wu(e,t){for(var n=null==e?0:e.length;n--&&!1!==t(e[n],n,e););return e}var Eu=Dl(!0);function Cu(e,t){return e&&Eu(e,t,ro)}var Nu=Bl(Cu,!0);function _u(e,t){return(tt(e)?wu:Nu)(e,bu(t))}function Su(e){return function(t){var n=Ka(t);return"[object Map]"==n?Us(t):"[object Set]"==n?function(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=[e,e]})),n}(t):function(e,t){return et(t,(function(t){return[t,e[t]]}))}(t,e(t))}}var Mu=Su(ro),Tu=Su(co),Au=Rr({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"}),ku=/[&<>"']/g,Ru=RegExp(ku.source);function Ou(e){return(e=Po(e))&&Ru.test(e)?e.replace(ku,Au):e}var Pu=/[\\^$.*+?()[\]{}|]/g,Du=RegExp(Pu.source);function Iu(e,t){for(var n=-1,i=null==e?0:e.length;++n<i;)if(!t(e[n],n,e))return!1;return!0}function Lu(e,t){var n=!0;return jl(e,(function(e,i,o){return n=!!t(e,i,o)})),n}var Bu=4294967295;function ju(e){return e?ma(Et(e),0,Bu):0}function Fu(e,t){var n=[];return jl(e,(function(e,i,o){t(e,i,o)&&n.push(e)})),n}function Hu(e,t){return(tt(e)?_a:Fu)(e,Rl(t))}function Wu(e){return function(t,n,i){var o=Object(t);if(!Ai(t)){var r=Rl(n);t=ro(t),n=function(e){return r(o[e],e,o)}}var a=e(t,n,i);return a>-1?o[r?t[a]:a]:void 0}}var zu=Math.max;function Gu(e,t,n){var i=null==e?0:e.length;if(!i)return-1;var o=null==n?0:Et(n);return o<0&&(o=zu(i+o,0)),Sn(e,Rl(t),o)}var Uu=Wu(Gu);function qu(e,t,n){var i;return n(e,(function(e,n,o){if(t(e,n,o))return i=n,!1})),i}var Xu=Math.max,Vu=Math.min;function Ku(e,t,n){var i=null==e?0:e.length;if(!i)return-1;var o=i-1;return void 0!==n&&(o=Et(n),o=n<0?Xu(i+o,0):Vu(o,i-1)),Sn(e,Rl(t),o,!0)}var Yu=Wu(Ku);function $u(e){return e&&e.length?e[0]:void 0}function Zu(e,t){var n=-1,i=Ai(e)?Array(e.length):[];return jl(e,(function(e,o,r){i[++n]=t(e,o,r)})),i}function Ju(e,t){return(tt(e)?et:Zu)(e,Rl(t))}var Qu=1/0;var ec=1/0;var tc=ha("floor");function nc(e){return qo((function(t){var n=t.length,i=n,o=un.prototype.thru;for(e&&t.reverse();i--;){var r=t[i];if("function"!=typeof r)throw new TypeError("Expected a function");if(o&&!a&&"wrapper"==ln(r))var a=new un([],!0)}for(i=a?i:n;++i<n;){var s=ln(r=t[i]),l="wrapper"==s?rn(r):void 0;a=l&&pn(l[0])&&424==l[1]&&!l[4].length&&1==l[9]?a[ln(l[0])].apply(a,l[3]):1==r.length&&pn(r)?a[s]():a.thru(r)}return function(){var e=arguments,i=e[0];if(a&&1==e.length&&tt(i))return a.plant(i).value();for(var o=0,r=n?t[o].apply(this,e):i;++o<n;)r=t[o].call(this,r);return r}}))}var ic=nc(),oc=nc(!0);function rc(e,t){return _a(t,(function(t){return Tt(e[t])}))}var ac=Object.prototype.hasOwnProperty,sc=Hl((function(e,t,n){ac.call(e,n)?e[n].push(t):bi(e,n,[t])}));function lc(e,t){return e>t}function uc(e){return function(t,n){return"string"==typeof t&&"string"==typeof n||(t=yt(t),n=yt(n)),e(t,n)}}var cc=uc(lc),dc=uc((function(e,t){return e>=t})),hc=Object.prototype.hasOwnProperty;function fc(e,t){return null!=e&&hc.call(e,t)}function pc(e,t){return null!=e&&Nl(e,t,fc)}var gc=Math.max,vc=Math.min;var mc="[object String]";function yc(e){return"string"==typeof e||!tt(e)&&Ye(e)&&Ke(e)==mc}function bc(e,t){return et(t,(function(t){return e[t]}))}function xc(e){return null==e?[]:bc(e,ro(e))}var wc=Math.max;var Ec=Math.max;var Cc=Math.min;function Nc(e,t,n){for(var i=n?cu:An,o=e[0].length,r=e.length,a=r,s=Array(r),l=1/0,u=[];a--;){var c=e[a];a&&t&&(c=et(c,Xi(t))),l=Cc(c.length,l),s[a]=!n&&(t||o>=120&&c.length>=120)?new js(a&&c):void 0}c=e[0];var d=-1,h=s[0];e:for(;++d<o&&u.length<l;){var f=c[d],p=t?t(f):f;if(f=n||0!==f?f:0,!(h?Hs(h,p):i(u,p,n))){for(a=r;--a;){var g=s[a];if(!(g?Hs(g,p):i(e[a],p,n)))continue e}h&&h.push(p),u.push(f)}}return u}function _c(e){return eu(e)?e:[]}var Sc=Si((function(e){var t=et(e,_c);return t.length&&t[0]===e[0]?Nc(t):[]})),Mc=Si((function(e){var t=pu(e),n=et(e,_c);return t===pu(n)?t=void 0:n.pop(),n.length&&n[0]===e[0]?Nc(n,Rl(t)):[]})),Tc=Si((function(e){var t=pu(e),n=et(e,_c);return(t="function"==typeof t?t:void 0)&&n.pop(),n.length&&n[0]===e[0]?Nc(n,void 0,t):[]}));function Ac(e,t){return function(n,i){return function(e,t,n,i){return Ll(e,(function(e,o,r){t(i,n(e),o,r)})),i}(n,e,t(i),{})}}var kc=Object.prototype.toString,Rc=Ac((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=kc.call(t)),e[t]=n}),wn(Ct)),Oc=Object.prototype,Pc=Oc.hasOwnProperty,Dc=Oc.toString,Ic=Ac((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=Dc.call(t)),Pc.call(e,t)?e[t].push(n):e[t]=[n]}),Rl);function Lc(e,t){return t.length<2?e:Bo(e,cr(t,0,-1))}function Bc(e,t,n){var i=null==(e=Lc(e,t=Do(t,e)))?e:e[Lo(pu(t))];return null==i?void 0:Yt(i,e,n)}var jc=Si(Bc),Fc=Si((function(e,t,n){var i=-1,o="function"==typeof t,r=Ai(e)?Array(e.length):[];return jl(e,(function(e){r[++i]=o?Yt(t,e,n):Bc(e,t,n)})),r}));var Hc=$i&&$i.isArrayBuffer,Wc=Hc?Xi(Hc):function(e){return Ye(e)&&"[object ArrayBuffer]"==Ke(e)};var zc=$i&&$i.isDate,Gc=zc?Xi(zc):function(e){return Ye(e)&&"[object Date]"==Ke(e)};var Uc=Object.prototype.hasOwnProperty;function qc(e){if(null==e)return!0;if(Ai(e)&&(tt(e)||"string"==typeof e||"function"==typeof e.splice||Ui(e)||Ji(e)||Fi(e)))return!e.length;var t=Ka(e);if("[object Map]"==t||"[object Set]"==t)return!e.size;if(Pi(e))return!oo(e).length;for(var n in e)if(Uc.call(e,n))return!1;return!0}function Xc(e,t){return gl(e,t)}var Vc=je.isFinite;function Kc(e){return"number"==typeof e&&Vc(e)}function Yc(e){return"number"==typeof e&&e==Et(e)}var $c="[object Number]";function Zc(e){return"number"==typeof e||Ye(e)&&Ke(e)==$c}var Jc=kt?Tt:Hi;function Qc(e){return null==e}var ed=$i&&$i.isRegExp,td=ed?Xi(ed):function(e){return Ye(e)&&"[object RegExp]"==Ke(e)},nd=9007199254740991;var id=Array.prototype.join;var od=la((function(e,t,n){return e+(n?"-":"")+t.toLowerCase()})),rd=Hl((function(e,t,n){bi(e,n,t)}));var ad=Math.max,sd=Math.min;var ld=la((function(e,t,n){return e+(n?" ":"")+t.toLowerCase()})),ud=Mr("toLowerCase");function cd(e,t){return e<t}var dd=uc(cd),hd=uc((function(e,t){return e<=t}));function fd(e,t,n){for(var i=-1,o=e.length;++i<o;){var r=e[i],a=t(r);if(null!=a&&(void 0===s?a==a&&!Ze(a):n(a,s)))var s=a,l=r}return l}function pd(e,t){for(var n,i=-1,o=e.length;++i<o;){var r=t(e[i]);void 0!==r&&(n=void 0===n?r:n+r)}return n}var gd=NaN;function vd(e,t){var n=null==e?0:e.length;return n?pd(e,t)/n:gd}var md=Ri((function(e,t,n){iu(e,t,n)})),yd=Si((function(e,t){return function(n){return Bc(n,e,t)}})),bd=Si((function(e,t){return function(n){return Bc(e,n,t)}}));function xd(e,t,n){var i=ro(t),o=rc(t,i),r=!(ht(n)&&"chain"in n&&!n.chain),a=Tt(e);return _n(o,(function(n){var i=t[n];e[n]=i,a&&(e.prototype[n]=function(){var t=this.__chain__;if(r||t){var n=e(this.__wrapped__);return(n.__actions__=cn(this.__actions__)).push({func:i,args:arguments,thisArg:e}),n.__chain__=t,n}return i.apply(e,Ho([this.value()],arguments))})})),e}var wd=at((function(e,t){return e*t}),1),Ed="Expected a function";function Cd(e){if("function"!=typeof e)throw new TypeError(Ed);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}var Nd="[object Map]",_d="[object Set]",Sd=Fe?Fe.iterator:void 0;function Md(e){if(!e)return[];if(Ai(e))return yc(e)?Sr(e):cn(e);if(Sd&&e[Sd])return function(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n}(e[Sd]());var t=Ka(e);return(t==Nd?Us:t==_d?qs:xc)(e)}function Td(e,t){var n=e.length;if(n)return zn(t+=t<0?n:0,n)?e[t]:void 0}function Ad(e,t){return null==(e=Lc(e,t=Do(t,e)))||delete e[Lo(pu(t))]}function kd(e){return er(e)?void 0:e}var Rd=qo((function(e,t){var n={};if(null==e)return n;var i=!1;t=et(t,(function(t){return t=Do(t,e),i||(i=t.length>1),t})),Ci(e,Pa(e),n),i&&(n=Is(n,7,kd));for(var o=t.length;o--;)Ad(n,t[o]);return n}));function Od(e,t,n,i){if(!ht(e))return e;for(var o=-1,r=(t=Do(t,e)).length,a=r-1,s=e;null!=s&&++o<r;){var l=Lo(t[o]),u=n;if("__proto__"===l||"constructor"===l||"prototype"===l)return e;if(o!=a){var c=s[l];void 0===(u=i?i(c,l,s):void 0)&&(u=ht(c)?c:zn(t[o+1])?[]:{})}Ei(s,l,u),s=s[l]}return e}function Pd(e,t,n){for(var i=-1,o=t.length,r={};++i<o;){var a=t[i],s=Bo(e,a);n(s,a)&&Od(r,Do(a,e),s)}return r}function Dd(e,t){if(null==e)return{};var n=et(Pa(e),(function(e){return[e]}));return t=Rl(t),Pd(e,n,(function(e,n){return t(e,n[0])}))}function Id(e,t){if(e!==t){var n=void 0!==e,i=null===e,o=e==e,r=Ze(e),a=void 0!==t,s=null===t,l=t==t,u=Ze(t);if(!s&&!u&&!r&&e>t||r&&a&&l&&!s&&!u||i&&a&&l||!n&&l||!o)return 1;if(!i&&!r&&!u&&e<t||u&&n&&o&&!i&&!r||s&&n&&o||!a&&o||!l)return-1}return 0}function Ld(e,t,n){t=t.length?et(t,(function(e){return tt(e)?function(t){return Bo(t,1===e.length?e[0]:e)}:e})):[Ct];var i=-1;t=et(t,Xi(Rl));var o=Zu(e,(function(e,n,o){var r=et(t,(function(t){return t(e)}));return{criteria:r,index:++i,value:e}}));return function(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}(o,(function(e,t){return function(e,t,n){for(var i=-1,o=e.criteria,r=t.criteria,a=o.length,s=n.length;++i<a;){var l=Id(o[i],r[i]);if(l)return i>=s?l:l*("desc"==n[i]?-1:1)}return e.index-t.index}(e,t,n)}))}function Bd(e){return qo((function(t){return t=et(t,Xi(Rl)),Si((function(n){var i=this;return e(t,(function(e){return Yt(e,i,n)}))}))}))}var jd=Bd(et),Fd=Si,Hd=Math.min,Wd=Fd((function(e,t){var n=(t=1==t.length&&tt(t[0])?et(t[0],Xi(Rl)):et(Go(t,1),Xi(Rl))).length;return Si((function(i){for(var o=-1,r=Hd(i.length,n);++o<r;)i[o]=t[o].call(this,i[o]);return Yt(e,this,i)}))})),zd=Bd(Iu),Gd=Bd(Fs),Ud=9007199254740991,qd=Math.floor;function Xd(e,t){var n="";if(!e||t<1||t>Ud)return n;do{t%2&&(n+=e),(t=qd(t/2))&&(e+=e)}while(t);return n}var Vd=Al("length"),Kd="\\ud800-\\udfff",Yd="["+Kd+"]",$d="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",Zd="\\ud83c[\\udffb-\\udfff]",Jd="[^"+Kd+"]",Qd="(?:\\ud83c[\\udde6-\\uddff]){2}",eh="[\\ud800-\\udbff][\\udc00-\\udfff]",th="(?:"+$d+"|"+Zd+")"+"?",nh="[\\ufe0e\\ufe0f]?",ih=nh+th+("(?:\\u200d(?:"+[Jd,Qd,eh].join("|")+")"+nh+th+")*"),oh="(?:"+[Jd+$d+"?",$d,Qd,eh,Yd].join("|")+")",rh=RegExp(Zd+"(?="+Zd+")|"+oh+ih,"g");function ah(e){return fr(e)?function(e){for(var t=rh.lastIndex=0;rh.test(e);)++t;return t}(e):Vd(e)}var sh=Math.ceil;function lh(e,t){var n=(t=void 0===t?" ":rt(t)).length;if(n<2)return n?Xd(t,e):t;var i=Xd(t,sh(e/ah(t)));return fr(t)?dr(Sr(i),0,e).join(""):i.slice(0,e)}var uh=Math.ceil,ch=Math.floor;var dh=/^\s+/,hh=je.parseInt;var fh=Si((function(e,t){return vi(e,32,void 0,t,qn(t,Fn(fh)))}));fh.placeholder={};var ph=Si((function(e,t){return vi(e,64,void 0,t,qn(t,Fn(ph)))}));ph.placeholder={};var gh=Hl((function(e,t,n){e[n?0:1].push(t)}),(function(){return[[],[]]}));var vh=qo((function(e,t){return null==e?{}:function(e,t){return Pd(e,t,(function(t,n){return _l(e,n)}))}(e,t)}));function mh(e,t,n,i){for(var o=n-1,r=e.length;++o<r;)if(i(e[o],t))return o;return-1}var yh=Array.prototype.splice;function bh(e,t,n,i){var o=i?mh:Tn,r=-1,a=t.length,s=e;for(e===t&&(t=cn(t)),n&&(s=et(e,Xi(n)));++r<a;)for(var l=0,u=t[r],c=n?n(u):u;(l=o(s,c,l,i))>-1;)s!==e&&yh.call(s,l,1),yh.call(e,l,1);return e}function xh(e,t){return e&&e.length&&t&&t.length?bh(e,t):e}var wh=Si(xh);var Eh=Array.prototype.splice;function Ch(e,t){for(var n=e?t.length:0,i=n-1;n--;){var o=t[n];if(n==i||o!==r){var r=o;zn(o)?Eh.call(e,o,1):Ad(e,o)}}return e}var Nh=qo((function(e,t){var n=null==e?0:e.length,i=Fo(e,t);return Ch(e,et(t,(function(e){return zn(e,n)?+e:e})).sort(Id)),i})),_h=Math.floor,Sh=Math.random;function Mh(e,t){return e+_h(Sh()*(t-e+1))}var Th=parseFloat,Ah=Math.min,kh=Math.random;var Rh=Math.ceil,Oh=Math.max;function Ph(e){return function(t,n,i){return i&&"number"!=typeof i&&ki(t,n,i)&&(n=i=void 0),t=wt(t),void 0===n?(n=t,t=0):n=wt(n),function(e,t,n,i){for(var o=-1,r=Oh(Rh((t-e)/(n||1)),0),a=Array(r);r--;)a[i?r:++o]=e,e+=n;return a}(t,n,i=void 0===i?t<n?1:-1:wt(i),e)}}var Dh=Ph(),Ih=Ph(!0),Lh=qo((function(e,t){return vi(e,256,void 0,void 0,void 0,t)}));function Bh(e,t,n,i,o){return o(e,(function(e,o,r){n=i?(i=!1,e):t(n,e,o,r)})),n}function jh(e,t,n){var i=tt(e)?kr:Bh,o=arguments.length<3;return i(e,Rl(t),n,o,jl)}function Fh(e,t,n,i){var o=null==e?0:e.length;for(i&&o&&(n=e[--o]);o--;)n=t(n,e[o],o,e);return n}var Hh=Array.prototype.reverse;function Wh(e){return null==e?e:Hh.call(e)}var zh=ha("round");function Gh(e){var t=e.length;return t?e[Mh(0,t-1)]:void 0}function Uh(e){return Gh(xc(e))}function qh(e,t){var n=-1,i=e.length,o=i-1;for(t=void 0===t?i:t;++n<t;){var r=Mh(n,o),a=e[r];e[r]=e[n],e[n]=a}return e.length=t,e}function Xh(e,t){return qh(cn(e),ma(t,0,e.length))}function Vh(e,t){var n=xc(e);return qh(n,ma(t,0,n.length))}function Kh(e){return qh(cn(e))}function Yh(e){return qh(xc(e))}var $h=la((function(e,t,n){return e+(n?"_":"")+t.toLowerCase()}));function Zh(e,t){var n;return jl(e,(function(e,i,o){return!(n=t(e,i,o))})),!!n}var Jh=Si((function(e,t){if(null==e)return[];var n=t.length;return n>1&&ki(e,t[0],t[1])?t=[]:n>2&&ki(t[0],t[1],t[2])&&(t=[t[0]]),Ld(e,Go(t,1),[])})),Qh=4294967294,ef=Math.floor,tf=Math.min;function nf(e,t,n,i){var o=0,r=null==e?0:e.length;if(0===r)return 0;for(var a=(t=n(t))!=t,s=null===t,l=Ze(t),u=void 0===t;o<r;){var c=ef((o+r)/2),d=n(e[c]),h=void 0!==d,f=null===d,p=d==d,g=Ze(d);if(a)var v=i||p;else v=u?p&&(i||h):s?p&&h&&(i||!f):l?p&&h&&!f&&(i||!g):!f&&!g&&(i?d<=t:d<t);v?o=c+1:r=c}return tf(r,Qh)}var of=2147483647;function rf(e,t,n){var i=0,o=null==e?i:e.length;if("number"==typeof t&&t==t&&o<=of){for(;i<o;){var r=i+o>>>1,a=e[r];null!==a&&!Ze(a)&&(n?a<=t:a<t)?i=r+1:o=r}return o}return nf(e,t,Ct,n)}function af(e,t){for(var n=-1,i=e.length,o=0,r=[];++n<i;){var a=e[n],s=t?t(a):a;if(!n||!xi(s,l)){var l=s;r[o++]=0===a?0:a}}return r}var sf=Math.max;var lf=la((function(e,t,n){return e+(n?" ":"")+Tr(t)}));var uf=at((function(e,t){return e-t}),0);var cf=Object.prototype,df=cf.hasOwnProperty;function hf(e,t,n,i){return void 0===e||xi(e,cf[n])&&!df.call(i,n)?t:e}var ff={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"};function pf(e){return"\\"+ff[e]}var gf=/<%=([\s\S]+?)%>/g,vf={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:gf,variable:"",imports:{_:{escape:Ou}}},mf=/\b__p \+= '';/g,yf=/\b(__p \+=) '' \+/g,bf=/(__e\(.*?\)|\b__t\)) \+\n'';/g,xf=/[()=,{}\[\]\/\s]/,wf=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Ef=/($^)/,Cf=/['\n\r\u2028\u2029\\]/g,Nf=Object.prototype.hasOwnProperty;function _f(e,t){return t(e)}var Sf=4294967295,Mf=Math.min;function Tf(e,t){var n=e;return n instanceof nn&&(n=n.value()),kr(t,(function(e,t){return t.func.apply(t.thisArg,Ho([e],t.args))}),n)}function Af(){return Tf(this.__wrapped__,this.__actions__)}var kf=9007199254740991;function Rf(e,t){for(var n=e.length;n--&&Tn(t,e[n],0)>-1;);return n}function Of(e,t){for(var n=-1,i=e.length;++n<i&&Tn(t,e[n],0)>-1;);return n}var Pf=/^\s+/;var Df=/\w*$/;var If=Rr({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),Lf=/&(?:amp|lt|gt|quot|#39);/g,Bf=RegExp(Lf.source);var jf=La&&1/qs(new La([,-0]))[1]==1/0?function(e){return new La(e)}:on,Ff=200;function Hf(e,t,n){var i=-1,o=An,r=e.length,a=!0,s=[],l=s;if(n)a=!1,o=cu;else if(r>=Ff){var u=t?null:jf(e);if(u)return qs(u);a=!1,o=Hs,l=new js}else l=t?[]:s;e:for(;++i<r;){var c=e[i],d=t?t(c):c;if(c=n||0!==c?c:0,a&&d==d){for(var h=l.length;h--;)if(l[h]===d)continue e;t&&l.push(d),s.push(c)}else o(l,d,n)||(l!==s&&l.push(d),s.push(c))}return s}var Wf=Si((function(e){return Hf(Go(e,1,eu,!0))})),zf=Si((function(e){var t=pu(e);return eu(t)&&(t=void 0),Hf(Go(e,1,eu,!0),Rl(t))})),Gf=Si((function(e){var t=pu(e);return t="function"==typeof t?t:void 0,Hf(Go(e,1,eu,!0),void 0,t)}));var Uf=0;var qf=Math.max;function Xf(e){if(!e||!e.length)return[];var t=0;return e=_a(e,(function(e){if(eu(e))return t=qf(e.length,t),!0})),Di(t,(function(t){return et(e,Al(t))}))}function Vf(e,t){if(!e||!e.length)return[];var n=Xf(e);return null==t?n:et(n,(function(e){return Yt(t,void 0,e)}))}function Kf(e,t,n,i){return Od(e,t,n(Bo(e,t)),i)}var Yf=la((function(e,t,n){return e+(n?" ":"")+t.toUpperCase()}));var $f=Si((function(e,t){return eu(e)?hu(e,t):[]}));var Zf=qo((function(e){var t=e.length,n=t?e[0]:0,i=this.__wrapped__,o=function(t){return Fo(t,e)};return!(t>1||this.__actions__.length)&&i instanceof nn&&zn(n)?((i=i.slice(n,+n+(t?1:0))).__actions__.push({func:_f,args:[o],thisArg:void 0}),new un(i,this.__chain__).thru((function(e){return t&&!e.length&&e.push(void 0),e}))):this.thru(o)}));function Jf(e,t,n){var i=e.length;if(i<2)return i?Hf(e[0]):[];for(var o=-1,r=Array(i);++o<i;)for(var a=e[o],s=-1;++s<i;)s!=o&&(r[o]=hu(r[o]||a,e[s],t,n));return Hf(Go(r,1),t,n)}var Qf=Si((function(e){return Jf(_a(e,eu))})),ep=Si((function(e){var t=pu(e);return eu(t)&&(t=void 0),Jf(_a(e,eu),Rl(t))})),tp=Si((function(e){var t=pu(e);return t="function"==typeof t?t:void 0,Jf(_a(e,eu),void 0,t)})),np=Si(Xf);function ip(e,t,n){for(var i=-1,o=e.length,r=t.length,a={};++i<o;){var s=i<r?t[i]:void 0;n(a,e[i],s)}return a}var op=Si((function(e){var t=e.length,n=t>1?e[t-1]:void 0;return n="function"==typeof n?(e.pop(),n):void 0,Vf(e,n)})),rp={chunk:function(e,t,n){t=(n?ki(e,t,n):void 0===t)?1:va(Et(t),0);var i=null==e?0:e.length;if(!i||t<1)return[];for(var o=0,r=0,a=Array(ga(i/t));o<i;)a[r++]=cr(e,o,o+=t);return a},compact:function(e){for(var t=-1,n=null==e?0:e.length,i=0,o=[];++t<n;){var r=e[t];r&&(o[i++]=r)}return o},concat:Bs,difference:fu,differenceBy:gu,differenceWith:vu,drop:function(e,t,n){var i=null==e?0:e.length;return i?cr(e,(t=n||void 0===t?1:Et(t))<0?0:t,i):[]},dropRight:function(e,t,n){var i=null==e?0:e.length;return i?cr(e,0,(t=i-(t=n||void 0===t?1:Et(t)))<0?0:t):[]},dropRightWhile:function(e,t){return e&&e.length?yu(e,Rl(t),!0,!0):[]},dropWhile:function(e,t){return e&&e.length?yu(e,Rl(t),!0):[]},fill:function(e,t,n,i){var o=null==e?0:e.length;return o?(n&&"number"!=typeof n&&ki(e,t,n)&&(n=0,i=o),function(e,t,n,i){var o=e.length;for((n=Et(n))<0&&(n=-n>o?0:o+n),(i=void 0===i||i>o?o:Et(i))<0&&(i+=o),i=n>i?0:ju(i);n<i;)e[n++]=t;return e}(e,t,n,i)):[]},findIndex:Gu,findLastIndex:Ku,first:$u,flatten:Uo,flattenDeep:function(e){return(null==e?0:e.length)?Go(e,ec):[]},flattenDepth:function(e,t){return(null==e?0:e.length)?Go(e,t=void 0===t?1:Et(t)):[]},fromPairs:function(e){for(var t=-1,n=null==e?0:e.length,i={};++t<n;){var o=e[t];i[o[0]]=o[1]}return i},head:$u,indexOf:function(e,t,n){var i=null==e?0:e.length;if(!i)return-1;var o=null==n?0:Et(n);return o<0&&(o=Ec(i+o,0)),Tn(e,t,o)},initial:function(e){return(null==e?0:e.length)?cr(e,0,-1):[]},intersection:Sc,intersectionBy:Mc,intersectionWith:Tc,join:function(e,t){return null==e?"":id.call(e,t)},last:pu,lastIndexOf:function(e,t,n){var i=null==e?0:e.length;if(!i)return-1;var o=i;return void 0!==n&&(o=(o=Et(n))<0?ad(i+o,0):sd(o,i-1)),t==t?function(e,t,n){for(var i=n+1;i--;)if(e[i]===t)return i;return i}(e,t,o):Sn(e,Mn,o,!0)},nth:function(e,t){return e&&e.length?Td(e,Et(t)):void 0},pull:wh,pullAll:xh,pullAllBy:function(e,t,n){return e&&e.length&&t&&t.length?bh(e,t,Rl(n)):e},pullAllWith:function(e,t,n){return e&&e.length&&t&&t.length?bh(e,t,void 0,n):e},pullAt:Nh,remove:function(e,t){var n=[];if(!e||!e.length)return n;var i=-1,o=[],r=e.length;for(t=Rl(t);++i<r;){var a=e[i];t(a,i,e)&&(n.push(a),o.push(i))}return Ch(e,o),n},reverse:Wh,slice:function(e,t,n){var i=null==e?0:e.length;return i?(n&&"number"!=typeof n&&ki(e,t,n)?(t=0,n=i):(t=null==t?0:Et(t),n=void 0===n?i:Et(n)),cr(e,t,n)):[]},sortedIndex:function(e,t){return rf(e,t)},sortedIndexBy:function(e,t,n){return nf(e,t,Rl(n))},sortedIndexOf:function(e,t){var n=null==e?0:e.length;if(n){var i=rf(e,t);if(i<n&&xi(e[i],t))return i}return-1},sortedLastIndex:function(e,t){return rf(e,t,!0)},sortedLastIndexBy:function(e,t,n){return nf(e,t,Rl(n),!0)},sortedLastIndexOf:function(e,t){if(null==e?0:e.length){var n=rf(e,t,!0)-1;if(xi(e[n],t))return n}return-1},sortedUniq:function(e){return e&&e.length?af(e):[]},sortedUniqBy:function(e,t){return e&&e.length?af(e,Rl(t)):[]},tail:function(e){var t=null==e?0:e.length;return t?cr(e,1,t):[]},take:function(e,t,n){return e&&e.length?cr(e,0,(t=n||void 0===t?1:Et(t))<0?0:t):[]},takeRight:function(e,t,n){var i=null==e?0:e.length;return i?cr(e,(t=i-(t=n||void 0===t?1:Et(t)))<0?0:t,i):[]},takeRightWhile:function(e,t){return e&&e.length?yu(e,Rl(t),!1,!0):[]},takeWhile:function(e,t){return e&&e.length?yu(e,Rl(t)):[]},union:Wf,unionBy:zf,unionWith:Gf,uniq:function(e){return e&&e.length?Hf(e):[]},uniqBy:function(e,t){return e&&e.length?Hf(e,Rl(t)):[]},uniqWith:function(e,t){return t="function"==typeof t?t:void 0,e&&e.length?Hf(e,void 0,t):[]},unzip:Xf,unzipWith:Vf,without:$f,xor:Qf,xorBy:ep,xorWith:tp,zip:np,zipObject:function(e,t){return ip(e||[],t||[],Ei)},zipObjectDeep:function(e,t){return ip(e||[],t||[],Od)},zipWith:op},ap={countBy:zl,each:xu,eachRight:_u,every:function(e,t,n){var i=tt(e)?Iu:Lu;return n&&ki(e,t,n)&&(t=void 0),i(e,Rl(t))},filter:Hu,find:Uu,findLast:Yu,flatMap:function(e,t){return Go(Ju(e,t),1)},flatMapDeep:function(e,t){return Go(Ju(e,t),Qu)},flatMapDepth:function(e,t,n){return n=void 0===n?1:Et(n),Go(Ju(e,t),n)},forEach:xu,forEachRight:_u,groupBy:sc,includes:function(e,t,n,i){e=Ai(e)?e:xc(e),n=n&&!i?Et(n):0;var o=e.length;return n<0&&(n=wc(o+n,0)),yc(e)?n<=o&&e.indexOf(t,n)>-1:!!o&&Tn(e,t,n)>-1},invokeMap:Fc,keyBy:rd,map:Ju,orderBy:function(e,t,n,i){return null==e?[]:(tt(t)||(t=null==t?[]:[t]),tt(n=i?void 0:n)||(n=null==n?[]:[n]),Ld(e,t,n))},partition:gh,reduce:jh,reduceRight:function(e,t,n){var i=tt(e)?Fh:Bh,o=arguments.length<3;return i(e,Rl(t),n,o,Nu)},reject:function(e,t){return(tt(e)?_a:Fu)(e,Cd(Rl(t)))},sample:function(e){return(tt(e)?Gh:Uh)(e)},sampleSize:function(e,t,n){return t=(n?ki(e,t,n):void 0===t)?1:Et(t),(tt(e)?Xh:Vh)(e,t)},shuffle:function(e){return(tt(e)?Kh:Yh)(e)},size:function(e){if(null==e)return 0;if(Ai(e))return yc(e)?ah(e):e.length;var t=Ka(e);return"[object Map]"==t||"[object Set]"==t?e.size:oo(e).length},some:function(e,t,n){var i=tt(e)?Fs:Zh;return n&&ki(e,t,n)&&(t=void 0),i(e,Rl(t))},sortBy:Jh},sp=ql,lp={after:function(e,t){if("function"!=typeof t)throw new TypeError("Expected a function");return e=Et(e),function(){if(--e<1)return t.apply(this,arguments)}},ary:yi,before:ar,bind:sr,bindKey:ur,curry:Gl,curryRight:Ul,debounce:Yl,defer:lu,delay:uu,flip:function(e){return vi(e,512)},memoize:Ao,negate:Cd,once:function(e){return ar(2,e)},overArgs:Wd,partial:fh,partialRight:ph,rearg:Lh,rest:function(e,t){if("function"!=typeof e)throw new TypeError("Expected a function");return Si(e,t=void 0===t?t:Et(t))},spread:function(e,t){if("function"!=typeof e)throw new TypeError("Expected a function");return t=null==t?0:sf(Et(t),0),Si((function(n){var i=n[t],o=dr(n,0,t);return i&&Ho(o,i),Yt(e,this,o)}))},throttle:function(e,t,n){var i=!0,o=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return ht(n)&&(i="leading"in n?!!n.leading:i,o="trailing"in n?!!n.trailing:o),Yl(e,t,{leading:i,maxWait:t,trailing:o})},unary:function(e){return yi(e,1)},wrap:function(e,t){return fh(bu(t),e)}},up={castArray:function(){if(!arguments.length)return[];var e=arguments[0];return tt(e)?e:[e]},clone:function(e){return Is(e,4)},cloneDeep:Ls,cloneDeepWith:function(e,t){return Is(e,5,t="function"==typeof t?t:void 0)},cloneWith:function(e,t){return Is(e,4,t="function"==typeof t?t:void 0)},conformsTo:function(e,t){return null==t||Ol(e,t,ro(t))},eq:xi,gt:cc,gte:dc,isArguments:Fi,isArray:tt,isArrayBuffer:Wc,isArrayLike:Ai,isArrayLikeObject:eu,isBoolean:function(e){return!0===e||!1===e||Ye(e)&&"[object Boolean]"==Ke(e)},isBuffer:Ui,isDate:Gc,isElement:function(e){return Ye(e)&&1===e.nodeType&&!er(e)},isEmpty:qc,isEqual:Xc,isEqualWith:function(e,t,n){var i=(n="function"==typeof n?n:void 0)?n(e,t):void 0;return void 0===i?gl(e,t,void 0,n):!!i},isError:ir,isFinite:Kc,isFunction:Tt,isInteger:Yc,isLength:Ti,isMap:Ns,isMatch:function(e,t){return e===t||yl(e,t,xl(t))},isMatchWith:function(e,t,n){return n="function"==typeof n?n:void 0,yl(e,t,xl(t),n)},isNaN:function(e){return Zc(e)&&e!=+e},isNative:function(e){if(Jc(e))throw new Error("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Ht(e)},isNil:Qc,isNull:function(e){return null===e},isNumber:Zc,isObject:ht,isObjectLike:Ye,isPlainObject:er,isRegExp:td,isSafeInteger:function(e){return Yc(e)&&e>=-9007199254740991&&e<=nd},isSet:Ss,isString:yc,isSymbol:Ze,isTypedArray:Ji,isUndefined:function(e){return void 0===e},isWeakMap:function(e){return Ye(e)&&"[object WeakMap]"==Ka(e)},isWeakSet:function(e){return Ye(e)&&"[object WeakSet]"==Ke(e)},lt:dd,lte:hd,toArray:Md,toFinite:wt,toInteger:Et,toLength:ju,toNumber:yt,toPlainObject:nu,toSafeInteger:function(e){return e?ma(Et(e),-9007199254740991,kf):0===e?e:0},toString:Po},cp={add:st,ceil:fa,divide:mu,floor:tc,max:function(e){return e&&e.length?fd(e,Ct,lc):void 0},maxBy:function(e,t){return e&&e.length?fd(e,Rl(t),lc):void 0},mean:function(e){return vd(e,Ct)},meanBy:function(e,t){return vd(e,Rl(t))},min:function(e){return e&&e.length?fd(e,Ct,cd):void 0},minBy:function(e,t){return e&&e.length?fd(e,Rl(t),cd):void 0},multiply:wd,round:zh,subtract:uf,sum:function(e){return e&&e.length?pd(e,Ct):0},sumBy:function(e,t){return e&&e.length?pd(e,Rl(t)):0}},dp=function(e,t,n){return void 0===n&&(n=t,t=void 0),void 0!==n&&(n=(n=yt(n))==n?n:0),void 0!==t&&(t=(t=yt(t))==t?t:0),ma(yt(e),t,n)},hp=function(e,t,n){return t=wt(t),void 0===n?(n=t,t=0):n=wt(n),function(e,t,n){return e>=vc(t,n)&&e<gc(t,n)}(e=yt(e),t,n)},fp=function(e,t,n){if(n&&"boolean"!=typeof n&&ki(e,t,n)&&(t=n=void 0),void 0===n&&("boolean"==typeof t?(n=t,t=void 0):"boolean"==typeof e&&(n=e,e=void 0)),void 0===e&&void 0===t?(e=0,t=1):(e=wt(e),void 0===t?(t=e,e=0):t=wt(t)),e>t){var i=e;e=t,t=i}if(n||e%1||t%1){var o=kh();return Ah(e+o*(t-e+Th("1e-"+((o+"").length-1))),t)}return Mh(e,t)},pp={assign:so,assignIn:ho,assignInWith:fo,assignWith:po,at:Xo,create:function(e,t){var n=Xt(e);return null==t?n:ba(n,t)},defaults:Jl,defaultsDeep:au,entries:Mu,entriesIn:Tu,extend:ho,extendWith:fo,findKey:function(e,t){return qu(e,Rl(t),Ll)},findLastKey:function(e,t){return qu(e,Rl(t),Cu)},forIn:function(e,t){return null==e?e:Il(e,bu(t),co)},forInRight:function(e,t){return null==e?e:Eu(e,bu(t),co)},forOwn:function(e,t){return e&&Ll(e,bu(t))},forOwnRight:function(e,t){return e&&Cu(e,bu(t))},functions:function(e){return null==e?[]:rc(e,ro(e))},functionsIn:function(e){return null==e?[]:rc(e,co(e))},get:jo,has:pc,hasIn:_l,invert:Rc,invertBy:Ic,invoke:jc,keys:ro,keysIn:co,mapKeys:function(e,t){var n={};return t=Rl(t),Ll(e,(function(e,i,o){bi(n,t(e,i,o),e)})),n},mapValues:function(e,t){var n={};return t=Rl(t),Ll(e,(function(e,i,o){bi(n,i,t(e,i,o))})),n},merge:md,mergeWith:ru,omit:Rd,omitBy:function(e,t){return Dd(e,Cd(Rl(t)))},pick:vh,pickBy:Dd,result:function(e,t,n){var i=-1,o=(t=Do(t,e)).length;for(o||(o=1,e=void 0);++i<o;){var r=null==e?void 0:e[Lo(t[i])];void 0===r&&(i=o,r=n),e=Tt(r)?r.call(e):r}return e},set:function(e,t,n){return null==e?e:Od(e,t,n)},setWith:function(e,t,n,i){return i="function"==typeof i?i:void 0,null==e?e:Od(e,t,n,i)},toPairs:Mu,toPairsIn:Tu,transform:function(e,t,n){var i=tt(e),o=i||Ui(e)||Ji(e);if(t=Rl(t),null==n){var r=e&&e.constructor;n=o?i?new r:[]:ht(e)&&Tt(r)?Xt(Vo(e)):{}}return(o?_n:Ll)(e,(function(e,i,o){return t(n,e,i,o)})),n},unset:function(e,t){return null==e||Ad(e,t)},update:function(e,t,n){return null==e?e:Kf(e,t,bu(n))},updateWith:function(e,t,n,i){return i="function"==typeof i?i:void 0,null==e?e:Kf(e,t,bu(n),i)},values:xc,valuesIn:function(e){return null==e?[]:bc(e,co(e))}},gp={at:Zf,chain:pa,commit:function(){return new un(this.value(),this.__chain__)},lodash:fn,next:function(){void 0===this.__values__&&(this.__values__=Md(this.value()));var e=this.__index__>=this.__values__.length;return{done:e,value:e?void 0:this.__values__[this.__index__++]}},plant:function(e){for(var t,n=this;n instanceof en;){var i=dn(n);i.__index__=0,i.__values__=void 0,t?o.__wrapped__=i:t=i;var o=i;n=n.__wrapped__}return o.__wrapped__=e,t},reverse:function(){var e=this.__wrapped__;if(e instanceof nn){var t=e;return this.__actions__.length&&(t=new nn(this)),(t=t.reverse()).__actions__.push({func:_f,args:[Wh],thisArg:void 0}),new un(t,this.__chain__)}return this.thru(Wh)},tap:function(e,t){return t(e),e},thru:_f,toIterator:function(){return this},toJSON:Af,value:Af,valueOf:Af,wrapperChain:function(){return pa(this)}},vp={camelCase:ua,capitalize:Ar,deburr:Ir,endsWith:function(e,t,n){e=Po(e),t=rt(t);var i=e.length,o=n=void 0===n?i:ma(Et(n),0,i);return(n-=t.length)>=0&&e.slice(n,o)==t},escape:Ou,escapeRegExp:function(e){return(e=Po(e))&&Du.test(e)?e.replace(Pu,"\\$&"):e},kebabCase:od,lowerCase:ld,lowerFirst:ud,pad:function(e,t,n){e=Po(e);var i=(t=Et(t))?ah(e):0;if(!t||i>=t)return e;var o=(t-i)/2;return lh(ch(o),n)+e+lh(uh(o),n)},padEnd:function(e,t,n){e=Po(e);var i=(t=Et(t))?ah(e):0;return t&&i<t?e+lh(t-i,n):e},padStart:function(e,t,n){e=Po(e);var i=(t=Et(t))?ah(e):0;return t&&i<t?lh(t-i,n)+e:e},parseInt:function(e,t,n){return n||null==t?t=0:t&&(t=+t),hh(Po(e).replace(dh,""),t||0)},repeat:function(e,t,n){return t=(n?ki(e,t,n):void 0===t)?1:Et(t),Xd(Po(e),t)},replace:function(){var e=arguments,t=Po(e[0]);return e.length<3?t:t.replace(e[1],e[2])},snakeCase:$h,split:function(e,t,n){return n&&"number"!=typeof n&&ki(e,t,n)&&(t=n=void 0),(n=void 0===n?4294967295:n>>>0)?(e=Po(e))&&("string"==typeof t||null!=t&&!td(t))&&!(t=rt(t))&&fr(e)?dr(Sr(e),0,n):e.split(t,n):[]},startCase:lf,startsWith:function(e,t,n){return e=Po(e),n=null==n?0:ma(Et(n),0,e.length),t=rt(t),e.slice(n,n+t.length)==t},template:function(e,t,n){var i=vf.imports._.templateSettings||vf;n&&ki(e,t,n)&&(t=void 0),e=Po(e),t=fo({},t,i,hf);var o,r,a=fo({},t.imports,i.imports,hf),s=ro(a),l=bc(a,s),u=0,c=t.interpolate||Ef,d="__p += '",h=RegExp((t.escape||Ef).source+"|"+c.source+"|"+(c===gf?wf:Ef).source+"|"+(t.evaluate||Ef).source+"|$","g"),f=Nf.call(t,"sourceURL")?"//# sourceURL="+(t.sourceURL+"").replace(/\s/g," ")+"\n":"";e.replace(h,(function(t,n,i,a,s,l){return i||(i=a),d+=e.slice(u,l).replace(Cf,pf),n&&(o=!0,d+="' +\n__e("+n+") +\n'"),s&&(r=!0,d+="';\n"+s+";\n__p += '"),i&&(d+="' +\n((__t = ("+i+")) == null ? '' : __t) +\n'"),u=l+t.length,t})),d+="';\n";var p=Nf.call(t,"variable")&&t.variable;if(p){if(xf.test(p))throw new Error("Invalid `variable` option passed into `_.template`")}else d="with (obj) {\n"+d+"\n}\n";d=(r?d.replace(mf,""):d).replace(yf,"$1").replace(bf,"$1;"),d="function("+(p||"obj")+") {\n"+(p?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(o?", __e = _.escape":"")+(r?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+d+"return __p\n}";var g=or((function(){return Function(s,f+"return "+d).apply(void 0,l)}));if(g.source=d,ir(g))throw g;return g},templateSettings:vf,toLower:function(e){return Po(e).toLowerCase()},toUpper:function(e){return Po(e).toUpperCase()},trim:function(e,t,n){if((e=Po(e))&&(n||void 0===t))return dt(e);if(!e||!(t=rt(t)))return e;var i=Sr(e),o=Sr(t);return dr(i,Of(i,o),Rf(i,o)+1).join("")},trimEnd:function(e,t,n){if((e=Po(e))&&(n||void 0===t))return e.slice(0,ut(e)+1);if(!e||!(t=rt(t)))return e;var i=Sr(e);return dr(i,0,Rf(i,Sr(t))+1).join("")},trimStart:function(e,t,n){if((e=Po(e))&&(n||void 0===t))return e.replace(Pf,"");if(!e||!(t=rt(t)))return e;var i=Sr(e);return dr(i,Of(i,Sr(t))).join("")},truncate:function(e,t){var n=30,i="...";if(ht(t)){var o="separator"in t?t.separator:o;n="length"in t?Et(t.length):n,i="omission"in t?rt(t.omission):i}var r=(e=Po(e)).length;if(fr(e)){var a=Sr(e);r=a.length}if(n>=r)return e;var s=n-ah(i);if(s<1)return i;var l=a?dr(a,0,s).join(""):e.slice(0,s);if(void 0===o)return l+i;if(a&&(s+=l.length-s),td(o)){if(e.slice(s).search(o)){var u,c=l;for(o.global||(o=RegExp(o.source,Po(Df.exec(o))+"g")),o.lastIndex=0;u=o.exec(c);)var d=u.index;l=l.slice(0,void 0===d?s:d)}}else if(e.indexOf(rt(o),s)!=s){var h=l.lastIndexOf(o);h>-1&&(l=l.slice(0,h))}return l+i},unescape:function(e){return(e=Po(e))&&Bf.test(e)?e.replace(Lf,If):e},upperCase:Yf,upperFirst:Tr,words:aa},mp={attempt:or,bindAll:lr,cond:function(e){var t=null==e?0:e.length,n=Rl;return e=t?et(e,(function(e){if("function"!=typeof e[1])throw new TypeError("Expected a function");return[n(e[0]),e[1]]})):[],Si((function(n){for(var i=-1;++i<t;){var o=e[i];if(Yt(o[0],this,n))return Yt(o[1],this,n)}}))},conforms:function(e){return function(e){var t=ro(e);return function(n){return Ol(n,e,t)}}(Is(e,1))},constant:wn,defaultTo:function(e,t){return null==e||e!=e?t:e},flow:ic,flowRight:oc,identity:Ct,iteratee:function(e){return Rl("function"==typeof e?e:Is(e,1))},matches:function(e){return El(Is(e,1))},matchesProperty:function(e,t){return Tl(e,Is(t,1))},method:yd,methodOf:bd,mixin:xd,noop:on,nthArg:function(e){return e=Et(e),Si((function(t){return Td(t,e)}))},over:jd,overEvery:zd,overSome:Gd,property:kl,propertyOf:function(e){return function(t){return null==e?void 0:Bo(e,t)}},range:Dh,rangeRight:Ih,stubArray:Sa,stubFalse:Hi,stubObject:function(){return{}},stubString:function(){return""},stubTrue:function(){return!0},times:function(e,t){if((e=Et(e))<1||e>9007199254740991)return[];var n=Sf,i=Mf(e,Sf);t=bu(t),e-=Sf;for(var o=Di(i,t);++n<e;)t(n);return o},toPath:function(e){return tt(e)?et(e,Lo):Ze(e)?[e]:cn(Oo(Po(e)))},uniqueId:function(e){var t=++Uf;return Po(e)+t}};var yp=Math.max,bp=Math.min;var xp=Math.min;var wp,Ep,Cp=4294967295,Np=Array.prototype,_p=Object.prototype.hasOwnProperty,Sp=Fe?Fe.iterator:void 0,Mp=Math.max,Tp=Math.min,Ap=function(e){return function(t,n,i){if(null==i){var o=ht(n),r=o&&ro(n),a=r&&r.length&&rc(n,r);(a?a.length:o)||(i=n,n=t,t=this)}return e(t,n,i)}}(xd);fn.after=lp.after,fn.ary=lp.ary,fn.assign=pp.assign,fn.assignIn=pp.assignIn,fn.assignInWith=pp.assignInWith,fn.assignWith=pp.assignWith,fn.at=pp.at,fn.before=lp.before,fn.bind=lp.bind,fn.bindAll=mp.bindAll,fn.bindKey=lp.bindKey,fn.castArray=up.castArray,fn.chain=gp.chain,fn.chunk=rp.chunk,fn.compact=rp.compact,fn.concat=rp.concat,fn.cond=mp.cond,fn.conforms=mp.conforms,fn.constant=mp.constant,fn.countBy=ap.countBy,fn.create=pp.create,fn.curry=lp.curry,fn.curryRight=lp.curryRight,fn.debounce=lp.debounce,fn.defaults=pp.defaults,fn.defaultsDeep=pp.defaultsDeep,fn.defer=lp.defer,fn.delay=lp.delay,fn.difference=rp.difference,fn.differenceBy=rp.differenceBy,fn.differenceWith=rp.differenceWith,fn.drop=rp.drop,fn.dropRight=rp.dropRight,fn.dropRightWhile=rp.dropRightWhile,fn.dropWhile=rp.dropWhile,fn.fill=rp.fill,fn.filter=ap.filter,fn.flatMap=ap.flatMap,fn.flatMapDeep=ap.flatMapDeep,fn.flatMapDepth=ap.flatMapDepth,fn.flatten=rp.flatten,fn.flattenDeep=rp.flattenDeep,fn.flattenDepth=rp.flattenDepth,fn.flip=lp.flip,fn.flow=mp.flow,fn.flowRight=mp.flowRight,fn.fromPairs=rp.fromPairs,fn.functions=pp.functions,fn.functionsIn=pp.functionsIn,fn.groupBy=ap.groupBy,fn.initial=rp.initial,fn.intersection=rp.intersection,fn.intersectionBy=rp.intersectionBy,fn.intersectionWith=rp.intersectionWith,fn.invert=pp.invert,fn.invertBy=pp.invertBy,fn.invokeMap=ap.invokeMap,fn.iteratee=mp.iteratee,fn.keyBy=ap.keyBy,fn.keys=ro,fn.keysIn=pp.keysIn,fn.map=ap.map,fn.mapKeys=pp.mapKeys,fn.mapValues=pp.mapValues,fn.matches=mp.matches,fn.matchesProperty=mp.matchesProperty,fn.memoize=lp.memoize,fn.merge=pp.merge,fn.mergeWith=pp.mergeWith,fn.method=mp.method,fn.methodOf=mp.methodOf,fn.mixin=Ap,fn.negate=Cd,fn.nthArg=mp.nthArg,fn.omit=pp.omit,fn.omitBy=pp.omitBy,fn.once=lp.once,fn.orderBy=ap.orderBy,fn.over=mp.over,fn.overArgs=lp.overArgs,fn.overEvery=mp.overEvery,fn.overSome=mp.overSome,fn.partial=lp.partial,fn.partialRight=lp.partialRight,fn.partition=ap.partition,fn.pick=pp.pick,fn.pickBy=pp.pickBy,fn.property=mp.property,fn.propertyOf=mp.propertyOf,fn.pull=rp.pull,fn.pullAll=rp.pullAll,fn.pullAllBy=rp.pullAllBy,fn.pullAllWith=rp.pullAllWith,fn.pullAt=rp.pullAt,fn.range=mp.range,fn.rangeRight=mp.rangeRight,fn.rearg=lp.rearg,fn.reject=ap.reject,fn.remove=rp.remove,fn.rest=lp.rest,fn.reverse=rp.reverse,fn.sampleSize=ap.sampleSize,fn.set=pp.set,fn.setWith=pp.setWith,fn.shuffle=ap.shuffle,fn.slice=rp.slice,fn.sortBy=ap.sortBy,fn.sortedUniq=rp.sortedUniq,fn.sortedUniqBy=rp.sortedUniqBy,fn.split=vp.split,fn.spread=lp.spread,fn.tail=rp.tail,fn.take=rp.take,fn.takeRight=rp.takeRight,fn.takeRightWhile=rp.takeRightWhile,fn.takeWhile=rp.takeWhile,fn.tap=gp.tap,fn.throttle=lp.throttle,fn.thru=_f,fn.toArray=up.toArray,fn.toPairs=pp.toPairs,fn.toPairsIn=pp.toPairsIn,fn.toPath=mp.toPath,fn.toPlainObject=up.toPlainObject,fn.transform=pp.transform,fn.unary=lp.unary,fn.union=rp.union,fn.unionBy=rp.unionBy,fn.unionWith=rp.unionWith,fn.uniq=rp.uniq,fn.uniqBy=rp.uniqBy,fn.uniqWith=rp.uniqWith,fn.unset=pp.unset,fn.unzip=rp.unzip,fn.unzipWith=rp.unzipWith,fn.update=pp.update,fn.updateWith=pp.updateWith,fn.values=pp.values,fn.valuesIn=pp.valuesIn,fn.without=rp.without,fn.words=vp.words,fn.wrap=lp.wrap,fn.xor=rp.xor,fn.xorBy=rp.xorBy,fn.xorWith=rp.xorWith,fn.zip=rp.zip,fn.zipObject=rp.zipObject,fn.zipObjectDeep=rp.zipObjectDeep,fn.zipWith=rp.zipWith,fn.entries=pp.toPairs,fn.entriesIn=pp.toPairsIn,fn.extend=pp.assignIn,fn.extendWith=pp.assignInWith,Ap(fn,fn),fn.add=cp.add,fn.attempt=mp.attempt,fn.camelCase=vp.camelCase,fn.capitalize=vp.capitalize,fn.ceil=cp.ceil,fn.clamp=dp,fn.clone=up.clone,fn.cloneDeep=up.cloneDeep,fn.cloneDeepWith=up.cloneDeepWith,fn.cloneWith=up.cloneWith,fn.conformsTo=up.conformsTo,fn.deburr=vp.deburr,fn.defaultTo=mp.defaultTo,fn.divide=cp.divide,fn.endsWith=vp.endsWith,fn.eq=up.eq,fn.escape=vp.escape,fn.escapeRegExp=vp.escapeRegExp,fn.every=ap.every,fn.find=ap.find,fn.findIndex=rp.findIndex,fn.findKey=pp.findKey,fn.findLast=ap.findLast,fn.findLastIndex=rp.findLastIndex,fn.findLastKey=pp.findLastKey,fn.floor=cp.floor,fn.forEach=ap.forEach,fn.forEachRight=ap.forEachRight,fn.forIn=pp.forIn,fn.forInRight=pp.forInRight,fn.forOwn=pp.forOwn,fn.forOwnRight=pp.forOwnRight,fn.get=pp.get,fn.gt=up.gt,fn.gte=up.gte,fn.has=pp.has,fn.hasIn=pp.hasIn,fn.head=rp.head,fn.identity=Ct,fn.includes=ap.includes,fn.indexOf=rp.indexOf,fn.inRange=hp,fn.invoke=pp.invoke,fn.isArguments=up.isArguments,fn.isArray=tt,fn.isArrayBuffer=up.isArrayBuffer,fn.isArrayLike=up.isArrayLike,fn.isArrayLikeObject=up.isArrayLikeObject,fn.isBoolean=up.isBoolean,fn.isBuffer=up.isBuffer,fn.isDate=up.isDate,fn.isElement=up.isElement,fn.isEmpty=up.isEmpty,fn.isEqual=up.isEqual,fn.isEqualWith=up.isEqualWith,fn.isError=up.isError,fn.isFinite=up.isFinite,fn.isFunction=up.isFunction,fn.isInteger=up.isInteger,fn.isLength=up.isLength,fn.isMap=up.isMap,fn.isMatch=up.isMatch,fn.isMatchWith=up.isMatchWith,fn.isNaN=up.isNaN,fn.isNative=up.isNative,fn.isNil=up.isNil,fn.isNull=up.isNull,fn.isNumber=up.isNumber,fn.isObject=ht,fn.isObjectLike=up.isObjectLike,fn.isPlainObject=up.isPlainObject,fn.isRegExp=up.isRegExp,fn.isSafeInteger=up.isSafeInteger,fn.isSet=up.isSet,fn.isString=up.isString,fn.isSymbol=up.isSymbol,fn.isTypedArray=up.isTypedArray,fn.isUndefined=up.isUndefined,fn.isWeakMap=up.isWeakMap,fn.isWeakSet=up.isWeakSet,fn.join=rp.join,fn.kebabCase=vp.kebabCase,fn.last=pu,fn.lastIndexOf=rp.lastIndexOf,fn.lowerCase=vp.lowerCase,fn.lowerFirst=vp.lowerFirst,fn.lt=up.lt,fn.lte=up.lte,fn.max=cp.max,fn.maxBy=cp.maxBy,fn.mean=cp.mean,fn.meanBy=cp.meanBy,fn.min=cp.min,fn.minBy=cp.minBy,fn.stubArray=mp.stubArray,fn.stubFalse=mp.stubFalse,fn.stubObject=mp.stubObject,fn.stubString=mp.stubString,fn.stubTrue=mp.stubTrue,fn.multiply=cp.multiply,fn.nth=rp.nth,fn.noop=mp.noop,fn.now=sp,fn.pad=vp.pad,fn.padEnd=vp.padEnd,fn.padStart=vp.padStart,fn.parseInt=vp.parseInt,fn.random=fp,fn.reduce=ap.reduce,fn.reduceRight=ap.reduceRight,fn.repeat=vp.repeat,fn.replace=vp.replace,fn.result=pp.result,fn.round=cp.round,fn.sample=ap.sample,fn.size=ap.size,fn.snakeCase=vp.snakeCase,fn.some=ap.some,fn.sortedIndex=rp.sortedIndex,fn.sortedIndexBy=rp.sortedIndexBy,fn.sortedIndexOf=rp.sortedIndexOf,fn.sortedLastIndex=rp.sortedLastIndex,fn.sortedLastIndexBy=rp.sortedLastIndexBy,fn.sortedLastIndexOf=rp.sortedLastIndexOf,fn.startCase=vp.startCase,fn.startsWith=vp.startsWith,fn.subtract=cp.subtract,fn.sum=cp.sum,fn.sumBy=cp.sumBy,fn.template=vp.template,fn.times=mp.times,fn.toFinite=up.toFinite,fn.toInteger=Et,fn.toLength=up.toLength,fn.toLower=vp.toLower,fn.toNumber=up.toNumber,fn.toSafeInteger=up.toSafeInteger,fn.toString=up.toString,fn.toUpper=vp.toUpper,fn.trim=vp.trim,fn.trimEnd=vp.trimEnd,fn.trimStart=vp.trimStart,fn.truncate=vp.truncate,fn.unescape=vp.unescape,fn.uniqueId=mp.uniqueId,fn.upperCase=vp.upperCase,fn.upperFirst=vp.upperFirst,fn.each=ap.forEach,fn.eachRight=ap.forEachRight,fn.first=rp.head,Ap(fn,(wp={},Ll(fn,(function(e,t){_p.call(fn.prototype,t)||(wp[t]=e)})),wp),{chain:!1}),fn.VERSION="4.17.21",(fn.templateSettings=vp.templateSettings).imports._=fn,_n(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(e){fn[e].placeholder=fn})),_n(["drop","take"],(function(e,t){nn.prototype[e]=function(n){n=void 0===n?1:Mp(Et(n),0);var i=this.__filtered__&&!t?new nn(this):this.clone();return i.__filtered__?i.__takeCount__=Tp(n,i.__takeCount__):i.__views__.push({size:Tp(n,Cp),type:e+(i.__dir__<0?"Right":"")}),i},nn.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}})),_n(["filter","map","takeWhile"],(function(e,t){var n=t+1,i=1==n||3==n;nn.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:Rl(e),type:n}),t.__filtered__=t.__filtered__||i,t}})),_n(["head","last"],(function(e,t){var n="take"+(t?"Right":"");nn.prototype[e]=function(){return this[n](1).value()[0]}})),_n(["initial","tail"],(function(e,t){var n="drop"+(t?"":"Right");nn.prototype[e]=function(){return this.__filtered__?new nn(this):this[n](1)}})),nn.prototype.compact=function(){return this.filter(Ct)},nn.prototype.find=function(e){return this.filter(e).head()},nn.prototype.findLast=function(e){return this.reverse().find(e)},nn.prototype.invokeMap=Si((function(e,t){return"function"==typeof e?new nn(this):this.map((function(n){return Bc(n,e,t)}))})),nn.prototype.reject=function(e){return this.filter(Cd(Rl(e)))},nn.prototype.slice=function(e,t){e=Et(e);var n=this;return n.__filtered__&&(e>0||t<0)?new nn(n):(e<0?n=n.takeRight(-e):e&&(n=n.drop(e)),void 0!==t&&(n=(t=Et(t))<0?n.dropRight(-t):n.take(t-e)),n)},nn.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},nn.prototype.toArray=function(){return this.take(Cp)},Ll(nn.prototype,(function(e,t){var n=/^(?:filter|find|map|reject)|While$/.test(t),i=/^(?:head|last)$/.test(t),o=fn[i?"take"+("last"==t?"Right":""):t],r=i||/^find/.test(t);o&&(fn.prototype[t]=function(){var t=this.__wrapped__,a=i?[1]:arguments,s=t instanceof nn,l=a[0],u=s||tt(t),c=function(e){var t=o.apply(fn,Ho([e],a));return i&&d?t[0]:t};u&&n&&"function"==typeof l&&1!=l.length&&(s=u=!1);var d=this.__chain__,h=!!this.__actions__.length,f=r&&!d,p=s&&!h;if(!r&&u){t=p?t:new nn(this);var g=e.apply(t,a);return g.__actions__.push({func:_f,args:[c],thisArg:void 0}),new un(g,d)}return f&&p?e.apply(this,a):(g=this.thru(c),f?i?g.value()[0]:g.value():g)})})),_n(["pop","push","shift","sort","splice","unshift"],(function(e){var t=Np[e],n=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",i=/^(?:pop|shift)$/.test(e);fn.prototype[e]=function(){var e=arguments;if(i&&!this.__chain__){var o=this.value();return t.apply(tt(o)?o:[],e)}return this[n]((function(n){return t.apply(tt(n)?n:[],e)}))}})),Ll(nn.prototype,(function(e,t){var n=fn[t];if(n){var i=n.name+"";_p.call(an,i)||(an[i]=[]),an[i].push({name:t,func:n})}})),an[Jn(void 0,2).name]=[{name:"wrapper",func:void 0}],nn.prototype.clone=function(){var e=new nn(this.__wrapped__);return e.__actions__=cn(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=cn(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=cn(this.__views__),e},nn.prototype.reverse=function(){if(this.__filtered__){var e=new nn(this);e.__dir__=-1,e.__filtered__=!0}else(e=this.clone()).__dir__*=-1;return e},nn.prototype.value=function(){var e=this.__wrapped__.value(),t=this.__dir__,n=tt(e),i=t<0,o=n?e.length:0,r=function(e,t,n){for(var i=-1,o=n.length;++i<o;){var r=n[i],a=r.size;switch(r.type){case"drop":e+=a;break;case"dropRight":t-=a;break;case"take":t=bp(t,e+a);break;case"takeRight":e=yp(e,t-a)}}return{start:e,end:t}}(0,o,this.__views__),a=r.start,s=r.end,l=s-a,u=i?s:a-1,c=this.__iteratees__,d=c.length,h=0,f=xp(l,this.__takeCount__);if(!n||!i&&o==l&&f==l)return Tf(e,this.__actions__);var p=[];e:for(;l--&&h<f;){for(var g=-1,v=e[u+=t];++g<d;){var m=c[g],y=m.iteratee,b=m.type,x=y(v);if(2==b)v=x;else if(!x){if(1==b)continue e;break e}}p[h++]=v}return p},fn.prototype.at=gp.at,fn.prototype.chain=gp.wrapperChain,fn.prototype.commit=gp.commit,fn.prototype.next=gp.next,fn.prototype.plant=gp.plant,fn.prototype.reverse=gp.reverse,fn.prototype.toJSON=fn.prototype.valueOf=fn.prototype.value=gp.value,fn.prototype.first=fn.prototype.head,Sp&&(fn.prototype[Sp]=gp.toIterator),Ep={__e:function(e,t,n,i){for(var o,r,a;t=t.__;)if((o=t.__c)&&!o.__)try{if((r=o.constructor)&&null!=r.getDerivedStateFromError&&(o.setState(r.getDerivedStateFromError(e)),a=o.__d),null!=o.componentDidCatch&&(o.componentDidCatch(e,i||{}),a=o.__d),a)return o.__E=o}catch(t){e=t}throw e}},"function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout;var kp=0;function Rp(e,t,n,i,o,r){t||(t={});var a,s,l=t;if("ref"in l)for(s in l={},t)"ref"==s?a=t[s]:l[s]=t[s];var u={type:e,props:l,key:n,ref:a,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:--kp,__i:-1,__u:0,__source:o,__self:r};if("function"==typeof e&&(a=e.defaultProps))for(s in a)void 0===l[s]&&(l[s]=a[s]);return Ep.vnode&&Ep.vnode(u),u}var Op=t.LogicFlowUtil.StepDrag,Pp=function(e){function n(n){var i=e.call(this)||this;return i.updatePosition=function(e){var t=e.deltaX,n=e.deltaY,o=i.nodeModel,r=o.x,a=o.y;i.nodeModel.x=r+t/2,i.nodeModel.y=a+n/2,i.nodeModel.moveText(t/2,n/2)},i.getResize=function(e){var t=e.index,n=e.deltaX,i=e.deltaY,o=e.width,r=e.height,a=e.PCTResizeInfo,s=e.pct,l=void 0===s?1:s,u=e.freezeWidth,c=void 0!==u&&u,d=e.freezeHeight,h=void 0!==d&&d,f={width:o,height:r,deltaX:n,deltaY:i};if(a){var p=0,g=0;switch(t){case 0:g=(-1*n-i)/4;break;case 1:g=(n-i)/4;break;case 2:g=(n+i)/4;break;case 3:g=(-1*n+i)/4}0!==g&&(p=Math.round(g/a.ResizeBasis.basisHeight*1e5)/1e3),a.ResizePCT.widthPCT=Math.max(Math.min(a.ResizePCT.widthPCT+p,a.ScaleLimit.maxScaleLimit),a.ScaleLimit.minScaleLimit),a.ResizePCT.heightPCT=Math.max(Math.min(a.ResizePCT.heightPCT+p,a.ScaleLimit.maxScaleLimit),a.ScaleLimit.minScaleLimit);var v=Math.round(a.ResizePCT.widthPCT*a.ResizeBasis.basisWidth/100),m=Math.round(a.ResizePCT.heightPCT*a.ResizeBasis.basisHeight/100);switch(t){case 0:n=o-v,i=r-m;break;case 1:n=v-o,i=r-m;break;case 2:n=v-o,i=m-r;break;case 3:n=o-v,i=m-r}return f.width=v,f.height=m,f.deltaX=n/l,f.deltaY=i/l,f}switch(t){case 0:f.width=c?o:o-n*l,f.height=h?r:r-i*l;break;case 1:f.width=c?o:o+n*l,f.height=h?r:r-i*l;break;case 2:f.width=c?o:o+n*l,f.height=h?r:r+i*l;break;case 3:f.width=c?o:o-n*l,f.height=h?r:r+i*l}return f},i.updateEdgePointByAnchors=function(){var e=i.nodeModel,t=e.id,n=e.anchors,o=i.getNodeEdges(t);o.sourceEdges.forEach((function(e){var t=n.find((function(t){return t.id===e.sourceAnchorId}));t&&e.updateStartPoint({x:t.x,y:t.y})})),o.targetEdges.forEach((function(e){var t=n.find((function(t){return t.id===e.targetAnchorId}));t&&e.updateEndPoint({x:t.x,y:t.y})}))},i.updateRect=function(e){var t=e.deltaX,n=e.deltaY,o=i.nodeModel,r=o.x,a=o.y,s=o.width,l=o.height,u=o.radius,c=o.PCTResizeInfo,d=i.nodeModel,h=d.minWidth,f=d.minHeight,p=d.maxWidth,g=d.maxHeight,v=i.index,m=h===p,y=f===g,b=i.getResize({index:v,deltaX:t,deltaY:n,width:s,height:l,PCTResizeInfo:c,pct:1,freezeWidth:m,freezeHeight:y});if(b.width<h||b.width>p||b.height<f||b.height>g)i.dragHandler.cancelDrag();else{i.updatePosition({deltaX:m?0:b.deltaX,deltaY:y?0:b.deltaY}),i.nodeModel.width=b.width,i.nodeModel.height=b.height,i.nodeModel.setProperties({nodeSize:{width:b.width,height:b.height}});var x={x:r,y:a,width:s,height:l,radius:u},w={x:i.nodeModel.x,y:i.nodeModel.y,width:i.nodeModel.width,height:i.nodeModel.height,radius:u};i.updateEdgePointByAnchors(),i.eventEmit({deltaX:t,deltaY:n,beforeNode:x,afterNode:w})}},i.updateEllipse=function(e){var t=e.deltaX,n=e.deltaY,o=i.nodeModel,r=o.rx,a=o.ry,s=o.x,l=o.y,u=o.PCTResizeInfo,c=i.index,d=i.nodeModel,h=d.minWidth,f=d.minHeight,p=d.maxWidth,v=d.maxHeight,m=h===p,y=f===v,b=r,x=a,w=i.getResize({index:c,deltaX:t,deltaY:n,width:b,height:x,PCTResizeInfo:u,pct:.5,freezeWidth:m,freezeHeight:y});if(w.width<h/2||w.width>p/2||w.height<f/2||w.height>v/2)i.dragHandler.cancelDrag();else{i.updatePosition({deltaX:m?0:w.deltaX,deltaY:y?0:w.deltaY}),i.nodeModel.rx=w.width,i.nodeModel.ry=w.height,i.nodeModel.setProperties({nodeSize:{rx:w.width,ry:w.height}});var E={x:s,y:l},C={rx:w.width,ry:w.height,x:i.nodeModel.x,y:i.nodeModel.y};i.updateEdgePointByAnchors(),i.eventEmit({deltaX:t,deltaY:n,beforeNode:g(g({},E),{rx:r,ry:a}),afterNode:C})}},i.updateDiamond=function(e){var t=e.deltaX,n=e.deltaY,o=i.nodeModel,r=o.rx,a=o.ry,s=o.x,l=o.y,u=o.PCTResizeInfo,c=i.index,d=i.nodeModel,h=d.minWidth,f=d.minHeight,p=d.maxWidth,g=d.maxHeight,v=h===p,m=f===g,y=r,b=a,x=i.getResize({index:c,deltaX:t,deltaY:n,width:y,height:b,PCTResizeInfo:u,pct:.5,freezeWidth:v,freezeHeight:m});if(x.width<h/2||x.width>p/2||x.height<f/2||x.height>g/2)i.dragHandler.cancelDrag();else{i.updatePosition({deltaX:v?0:x.deltaX,deltaY:m?0:x.deltaY}),i.nodeModel.rx=x.width,i.nodeModel.ry=x.height,i.nodeModel.setProperties({nodeSize:{rx:x.width,ry:x.height}});var w={x:s,y:l,rx:r,ry:a},E={rx:x.width,ry:x.height,x:i.nodeModel.x,y:i.nodeModel.y};i.updateEdgePointByAnchors(),i.eventEmit({deltaX:t,deltaY:n,beforeNode:w,afterNode:E})}},i.eventEmit=function(e){var t=e.deltaX,n=e.deltaY,o=e.beforeNode,r=e.afterNode,a=i.nodeModel,s=a.id,l=a.modelType,u=a.type,c=g({id:s,modelType:l,type:u},o),d=g({id:s,modelType:l,type:u},r);i.graphModel.eventCenter.emit("node:resize",{preData:c,data:d,deltaX:t,deltaY:n,index:i.index,model:i.nodeModel})},i.onDragging=function(e){var n,o=e.deltaX,r=e.deltaY,a=i.graphModel.transformModel,s=i.nodeModel.modelType;o=(n=w(a.fixDeltaXY(o,r),2))[0],r=n[1],s===t.ModelType.RECT_NODE||s===t.ModelType.HTML_NODE?i.updateRect({deltaX:o,deltaY:r}):s===t.ModelType.ELLIPSE_NODE?i.updateEllipse({deltaX:o,deltaY:r}):s===t.ModelType.DIAMOND_NODE&&i.updateDiamond({deltaX:o,deltaY:r})},i.onDragEnd=function(){var e=i.graphModel.gridSize,t=void 0===e?1:e,n=t*Math.round(i.nodeModel.x/t),o=t*Math.round(i.nodeModel.y/t);i.nodeModel.moveTo(n,o),i.updateEdgePointByAnchors()},i.index=n.index,i.nodeModel=n.model,i.graphModel=n.graphModel,i.dragHandler=new Op({onDragging:i.onDragging,onDragEnd:i.onDragEnd,step:1}),i}return p(n,e),n.prototype.getNodeEdges=function(e){for(var t=this.graphModel.edges,n=[],i=[],o=0;o<t.length;o++){var r=t[o];r.sourceNodeId===e?n.push(r):t[o].targetNodeId===e&&i.push(r)}return{sourceEdges:n,targetEdges:i}},n.prototype.render=function(){var e=this.props,n=e.x,i=e.y,o=e.index,r=e.model.getControlPointStyle();return Rp("g",{className:"lf-resize-control-".concat(o),children:Rp(t.Rect,g({className:"lf-node-control",x:n,y:i},r,{onMouseDown:this.dragHandler.handleMouseDown}))})},n}(t.Component),Dp=function(e){function n(){var t=e.call(this)||this;return t.state={},t}return p(n,e),n.prototype.getResizeControl=function(){var e=this.props,t=e.model,n=e.graphModel,i=t.x,o=t.y,r=t.width,a=t.height,s={minX:i-r/2,minY:o-a/2,maxX:i+r/2,maxY:o+a/2},l=s.minX,u=s.minY,c=s.maxX,d=s.maxY;return[{x:l,y:u},{x:c,y:u},{x:c,y:d},{x:l,y:d}].map((function(e,i){return Rp(Pp,g({index:i},e,{model:t,graphModel:n}))}))},n.prototype.getGroupSolid=function(){var e=this.props.model,n=e.x,i=e.y,o=e.width,r=e.height,a=e.getResizeOutlineStyle();return Rp(t.Rect,g({},a,{x:n,y:i,width:o,height:r}))},n.prototype.render=function(){return Rp("g",{className:"lf-resize-control",children:[this.getGroupSolid(),this.getResizeControl()]})},n}(t.Component),Ip=function(e){function t(t,n){var i=e.call(this,t,n)||this,o=t.properties.nodeSize;return o&&(i.rx=o.rx,i.ry=o.ry),i}return p(t,e),t.prototype.initNodeData=function(t){e.prototype.initNodeData.call(this,t),this.minWidth=30,this.minHeight=30,this.maxWidth=2e3,this.maxHeight=2e3},t.prototype.getOutlineStyle=function(){var t=e.prototype.getOutlineStyle.call(this);return this.graphModel.editConfigModel.isSilentMode||(t.stroke="none",t.hover&&(t.hover.stroke="none")),t},t.prototype.getResizeOutlineStyle=function(){return{fill:"none",stroke:"transparent",strokeWidth:1,strokeDasharray:"3,3"}},t.prototype.getControlPointStyle=function(){return{width:7,height:7,fill:"#FFFFFF",stroke:"#000000"}},t.prototype.enableProportionResize=function(e){if(void 0===e&&(e=!0),e){var t={basisWidth:this.rx,basisHeight:this.ry},n={maxScaleLimit:Math.min(this.maxWidth/(2*this.rx)*100,this.maxHeight/(2*this.ry)*100),minScaleLimit:Math.max(this.minWidth/(2*this.rx)*100,this.minHeight/(2*this.ry)*100)};this.PCTResizeInfo={ResizePCT:{widthPCT:100,heightPCT:100},ResizeBasis:t,ScaleLimit:n}}else delete this.PCTResizeInfo},t}(t.EllipseNodeModel),Lp=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return p(t,e),t.prototype.getControlGroup=function(){var e=this.props,t=e.model,n=e.graphModel;return Rp(Dp,{model:t,graphModel:n})},t.prototype.getResizeShape=function(){return e.prototype.getShape.call(this)},t.prototype.getShape=function(){var e=this.props,t=e.model,n=e.graphModel.editConfigModel.isSilentMode;return Rp("g",{children:[this.getResizeShape(),t.isSelected&&!n?this.getControlGroup():""]})},t}(t.EllipseNode),Bp={type:"ellipse",view:Lp,model:Ip},jp=function(e){function t(t,n){var i=e.call(this,t,n)||this,o=t.properties.nodeSize;return o&&(i.rx=o.rx,i.ry=o.ry),i}return p(t,e),t.prototype.initNodeData=function(t){e.prototype.initNodeData.call(this,t),this.minWidth=30,this.minHeight=30,this.maxWidth=2e3,this.maxHeight=2e3,this.gridSize=1},t.prototype.getOutlineStyle=function(){var t=e.prototype.getOutlineStyle.call(this);return this.graphModel.editConfigModel.isSilentMode||(t.stroke="none",t.hover&&(t.hover.stroke="none")),t},t.prototype.getResizeOutlineStyle=function(){return{fill:"none",stroke:"transparent",strokeWidth:1,strokeDasharray:"3,3"}},t.prototype.getControlPointStyle=function(){return{width:7,height:7,fill:"#FFFFFF",stroke:"#000000"}},t.prototype.enableProportionResize=function(e){if(void 0===e&&(e=!0),e){var t={basisWidth:this.rx,basisHeight:this.ry},n={maxScaleLimit:Math.min(this.maxWidth/(2*this.rx)*100,this.maxHeight/(2*this.ry)*100),minScaleLimit:Math.max(this.minWidth/(2*this.rx)*100,this.minHeight/(2*this.ry)*100)};this.PCTResizeInfo={ResizePCT:{widthPCT:100,heightPCT:100},ResizeBasis:t,ScaleLimit:n}}else delete this.PCTResizeInfo},t}(t.DiamondNodeModel),Fp=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return p(n,e),n.prototype.getControlGroup=function(){var e=this.props,t=e.model,n=e.graphModel;return Rp(Dp,{model:t,graphModel:n})},n.prototype.getResizeShape=function(){var e=this.props.model,n=e.points,i=e.getNodeStyle();return Rp("g",{children:Rp(t.Polygon,g({},i,{points:n}))})},n.prototype.getShape=function(){var e=this.props,t=e.model.isSelected,n=e.graphModel.editConfigModel.isSilentMode;return Rp("g",{children:[this.getResizeShape(),t&&!n?this.getControlGroup():""]})},n}(t.DiamondNode),Hp={type:"diamond",view:Fp,model:jp},Wp=function(e){function t(t,n){var i=e.call(this,t,n)||this,o=t.properties.nodeSize;return o&&(i.width=o.width,i.height=o.height),i}return p(t,e),t.prototype.initNodeData=function(t){e.prototype.initNodeData.call(this,t),this.minWidth=30,this.minHeight=30,this.maxWidth=2e3,this.maxHeight=2e3},t.prototype.getOutlineStyle=function(){var t=e.prototype.getOutlineStyle.call(this);return this.graphModel.editConfigModel.isSilentMode||(t.stroke="none",t.hover&&(t.hover.stroke="none")),t},t.prototype.getResizeOutlineStyle=function(){return{fill:"none",stroke:"transparent",strokeWidth:1,strokeDasharray:"3,3"}},t.prototype.getControlPointStyle=function(){return{width:7,height:7,fill:"#FFFFFF",stroke:"#000000"}},t.prototype.enableProportionResize=function(e){if(void 0===e&&(e=!0),e){var t={basisWidth:this.width,basisHeight:this.height},n={maxScaleLimit:Math.min(this.maxWidth/this.width*100,this.maxHeight/this.height*100),minScaleLimit:Math.max(this.minWidth/this.width*100,this.minHeight/this.height*100)};this.PCTResizeInfo={ResizePCT:{widthPCT:100,heightPCT:100},ResizeBasis:t,ScaleLimit:n}}else delete this.PCTResizeInfo},t}(t.HtmlNodeModel),zp=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return p(t,e),t.prototype.getControlGroup=function(){var e=this.props,t=e.model,n=e.graphModel;return Rp(Dp,{model:t,graphModel:n})},t.prototype.getResizeShape=function(){return e.prototype.getShape.call(this)},t.prototype.getShape=function(){var e=this.props,t=e.model.isSelected,n=e.graphModel.editConfigModel.isSilentMode;return Rp("g",{children:[this.getResizeShape(),t&&!n?this.getControlGroup():""]})},t}(t.HtmlNode),Gp={type:"html",view:zp,model:Wp},Up=function(e){function t(t,n){var i=e.call(this,t,n)||this,o=t.properties.nodeSize;return o&&(i.width=o.width,i.height=o.height),i}return p(t,e),t.prototype.initNodeData=function(t){e.prototype.initNodeData.call(this,t),this.minWidth=30,this.minHeight=30,this.maxWidth=2e3,this.maxHeight=2e3},t.prototype.getOutlineStyle=function(){var t=e.prototype.getOutlineStyle.call(this);return this.graphModel.editConfigModel.isSilentMode||(t.stroke="none",t.hover&&(t.hover.stroke="none")),t},t.prototype.getResizeOutlineStyle=function(){return{fill:"none",stroke:"transparent",strokeWidth:1,strokeDasharray:"3,3"}},t.prototype.getControlPointStyle=function(){return{width:7,height:7,fill:"#FFFFFF",stroke:"#000000"}},t.prototype.enableProportionResize=function(e){if(void 0===e&&(e=!0),e){var t={basisWidth:this.width,basisHeight:this.height},n={maxScaleLimit:Math.min(this.maxWidth/this.width*100,this.maxHeight/this.height*100),minScaleLimit:Math.max(this.minWidth/this.width*100,this.minHeight/this.height*100)};this.PCTResizeInfo={ResizePCT:{widthPCT:100,heightPCT:100},ResizeBasis:t,ScaleLimit:n}}else delete this.PCTResizeInfo},t}(t.RectNodeModel),qp=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return p(t,e),t.prototype.getControlGroup=function(){var e=this.props,t=e.model,n=e.graphModel;return Rp(Dp,{model:t,graphModel:n})},t.prototype.getResizeShape=function(){return e.prototype.getShape.call(this)},t.prototype.getShape=function(){var e=this.props,t=e.model.isSelected,n=e.graphModel.editConfigModel.isSilentMode;return Rp("g",{children:[this.getResizeShape(),t&&!n?this.getControlGroup():""]})},t}(t.RectNode),Xp={type:"rect",view:qp,model:Up},Vp={pluginName:"nodeResize",step:0,install:function(e){e.register(Bp),e.register(Hp),e.register(Gp),e.register(Xp)}},Kp=function(e){function t(){var t=e.apply(this,E([],w(arguments),!1))||this;return t.isGroup=!0,t.isFolded=!1,t.unfoldedWidth=500,t.unfoldedHeight=300,t.childrenLastFoldStatus={},t}return p(t,e),t.prototype.initNodeData=function(t){var n=this;e.prototype.initNodeData.call(this,t);var i=[];tt(t.children)&&(i=t.children),this.children=new Set(i),this.width=500,this.height=300,this.foldedWidth=80,this.foldedHeight=60,this.zIndex=-1e4,this.radius=0,this.text.editable=!1,this.text.draggable=!1,this.isRestrict=!1,this.resizable=!1,this.autoToFront=!1,this.foldable=!1,void 0===this.properties.isFolded&&(this.properties.isFolded=!1),this.isFolded=!!this.properties.isFolded,setTimeout((function(){n.isFolded&&n.foldGroup(n.isFolded)}))},t.prototype.getResizeOutlineStyle=function(){var t=e.prototype.getResizeOutlineStyle.call(this);return t.stroke="none",t},t.prototype.foldGroup=function(e){var t=this;if(e!==this.isFolded){this.setProperty("isFolded",e),this.isFolded=e,e?(this.x=this.x-this.width/2+this.foldedWidth/2,this.y=this.y-this.height/2+this.foldedHeight/2,this.unfoldedWidth=this.width,this.unfoldedHeight=this.height,this.width=this.foldedWidth,this.height=this.foldedHeight):(this.width=this.unfoldedWidth,this.height=this.unfoldedHeight,this.x=this.x+this.width/2-this.foldedWidth/2,this.y=this.y+this.height/2-this.foldedHeight/2);var n=E(E([],w(this.incoming.edges),!1),w(this.outgoing.edges),!1);this.children.forEach((function(i){var o=t.graphModel.getElement(i);if(o){var r=o.isFolded;if(o.isGroup&&!o.isFolded&&o.foldGroup(e),o.isGroup&&!e){var a=t.childrenLastFoldStatus[i];void 0!==a&&a!==o.isFolded&&o.foldGroup(a)}t.childrenLastFoldStatus[i]=!!r,o.visible=!e;var s=o.incoming.edges,l=o.outgoing.edges;n=E(E(E([],w(n),!1),w(s),!1),w(l),!1)}})),this.foldEdge(e,n)}},t.prototype.getAnchorStyle=function(t){var n=e.prototype.getAnchorStyle.call(this,t);return n.stroke="transparent",n.fill="transparent",n.hover.fill="transparent",n.hover.stroke="transparent",n},t.prototype.foldEdge=function(e,t){var n=this;t.forEach((function(t,i){var o=t.id,r=t.sourceNodeId,a=t.targetNodeId,s=t.startPoint,l=t.endPoint,u=t.type,c=t.text,d=t.getProperties(),h={id:"".concat(o,"__").concat(i),sourceNodeId:r,targetNodeId:a,startPoint:s,endPoint:l,type:u,properties:d,text:null==c?void 0:c.value};t.virtual&&n.graphModel.deleteEdgeById(t.id);var f=n.graphModel.group.getNodeGroup(a);f||(f=n.graphModel.getNodeModelById(a));var p=n.graphModel.group.getNodeGroup(r);p||(p=n.graphModel.getNodeModelById(r)),e&&!1!==t.visible&&(n.children.has(r)||n.id===r?(h.startPoint=void 0,h.sourceNodeId=n.id):(h.endPoint=void 0,h.targetNodeId=n.id),f.id===n.id&&p.id===n.id||n.createVirtualEdge(h),t.visible=!1),e||!1!==t.visible||(f&&f.isGroup&&f.isFolded?(h.targetNodeId=f.id,h.endPoint=void 0,n.createVirtualEdge(h)):p&&p.isGroup&&p.isFolded?(h.sourceNodeId=p.id,h.startPoint=void 0,n.createVirtualEdge(h)):t.visible=!0)}))},t.prototype.createVirtualEdge=function(e){e.pointsList=void 0;var t=this.graphModel.addEdge(e);t.virtual=!0,t.text.editable=!1,t.isFoldedEdge=!0},t.prototype.isInRange=function(e){var t=e.minX,n=e.minY,i=e.maxX,o=e.maxY;return t>=this.x-this.width/2&&i<=this.x+this.width/2&&n>=this.y-this.height/2&&o<=this.y+this.height/2},t.prototype.isAllowMoveTo=function(e){var t=e.minX,n=e.minY,i=e.maxX,o=e.maxY;return{x:t>=this.x-this.width/2&&i<=this.x+this.width/2,y:n>=this.y-this.height/2&&o<=this.y+this.height/2}},t.prototype.setAllowAppendChild=function(e){this.setProperty("groupAddable",e)},t.prototype.addChild=function(e){this.children.add(e),this.graphModel.eventCenter.emit("group:add-node",{data:this.getData()})},t.prototype.removeChild=function(e){this.children.delete(e),this.graphModel.eventCenter.emit("group:remove-node",{data:this.getData()})},t.prototype.getAddableOutlineStyle=function(){return{stroke:"#FEB663",strokeWidth:2,strokeDasharray:"4 4",fill:"transparent"}},t.prototype.getData=function(){var t=this,n=e.prototype.getData.call(this);n.children=[],this.children.forEach((function(e){var i=t.graphModel.getNodeModelById(e);i&&!i.virtual&&n.children.push(e)}));var i=n.properties;return null==i||delete i.groupAddable,null==i||delete i.isFolded,n},t.prototype.getHistoryData=function(){var t=e.prototype.getData.call(this);t.children=E([],w(this.children),!1),t.isGroup=!0;var n=t.properties;return null==n||delete n.groupAddable,(null==n?void 0:n.isFolded)&&(t.x=t.x+this.unfoldedWidth/2-this.foldedWidth/2,t.y=t.y+this.unfoldedHeight/2-this.foldedHeight/2),t},t.prototype.isAllowAppendIn=function(e){return!0},t.prototype.toBack=function(){this.zIndex--},t}(Up),Yp=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return p(n,e),n.prototype.getControlGroup=function(){var t=this.props.model,n=t.resizable,i=t.properties;return n&&!i.isFolded?e.prototype.getControlGroup.call(this):null},n.prototype.getAddableShape=function(){var e=this.props.model,n=e.width,i=e.height,o=e.x,r=e.y,a=e.radius,s=e.properties,l=e.getAddableOutlineStyle;if(!s.groupAddable)return null;var u=this.props.model.getNodeStyle().strokeWidth,c=void 0===u?0:u,d=l(),h=n+c+8,f=i+c+8;return t.h("rect",g(g({},d),{width:h,height:f,x:o-h/2,y:r-f/2,rx:a,ry:a}))},n.prototype.getFoldIcon=function(){var e=this.props.model,n=e.x-e.width/2+5,i=e.y-e.height/2+5;if(!e.foldable)return null;var o=t.h("path",{fill:"none",stroke:"#818281",strokeWidth:2,"pointer-events":"none",d:e.properties.isFolded?"M ".concat(n+3,",").concat(i+6," ").concat(n+11,",").concat(i+6," M").concat(n+7,",").concat(i+2," ").concat(n+7,",").concat(i+10):"M ".concat(n+3,",").concat(i+6," ").concat(n+11,",").concat(i+6," ")});return t.h("g",{},[t.h("rect",{height:12,width:14,rx:2,ry:2,strokeWidth:1,fill:"#F4F5F6",stroke:"#CECECE",cursor:"pointer",x:e.x-e.width/2+5,y:e.y-e.height/2+5,onClick:function(){e.foldGroup(!e.properties.isFolded)}}),o])},n.prototype.getResizeShape=function(){return t.h("g",{},[this.getAddableShape(),e.prototype.getResizeShape.call(this),this.getFoldIcon()])},n}(qp),$p={type:"group",view:Yp,model:Kp},Zp=-1e4,Jp=function(){function e(e){var t=e.lf,n=this;this.topGroupZIndex=Zp,this.nodeGroupMap=new Map,this.graphRendered=function(e){var t=e.data;t&&t.nodes&&(t.nodes.forEach((function(e){e.children&&e.children.forEach((function(t){n.nodeGroupMap.set(t,e.id)}))})),n.checkAndCorrectTopGroupZIndex(t.nodes))},this.appendNodeToGroup=function(e){var t=e.data,i=n.nodeGroupMap.get(t.id);if(i){var o=n.lf.getNodeModelById(i);o.removeChild(t.id),n.nodeGroupMap.delete(t.id),o.setAllowAppendChild(!1)}var r=n.lf.getNodeModelById(t.id),a=null==r?void 0:r.getBounds();if(a&&r){var s=n.getGroup(a,t);if(r.isGroup&&(t.children.forEach((function(e){n.nodeGroupMap.set(e,t.id)})),n.checkAndCorrectTopGroupZIndex([t]),n.nodeSelected({data:t,isSelected:!1,isMultiple:!1})),!s)return;if(!s.isAllowAppendIn(t))return void n.lf.emit("group:not-allowed",{group:s.getData(),node:t});s.addChild(t.id),n.nodeGroupMap.set(t.id,s.id),s.setAllowAppendChild(!1)}},this.deleteGroupChild=function(e){var t=e.data;t.children&&t.children.forEach((function(e){n.nodeGroupMap.delete(e),n.lf.deleteNode(e)}));var i=n.nodeGroupMap.get(t.id);i&&(n.lf.getNodeModelById(i).removeChild(t.id),n.nodeGroupMap.delete(t.id))},this.setActiveGroup=function(e){var t=e.data,i=n.lf.getNodeModelById(t.id),o=null==i?void 0:i.getBounds();if(i&&o){var r=n.getGroup(o,t);if(n.activeGroup&&n.activeGroup.setAllowAppendChild(!1),!r||i.isGroup&&r.id===t.id)return;if(!r.isAllowAppendIn(t))return;n.activeGroup=r,n.activeGroup.setAllowAppendChild(!0)}},this.findNodeAndChildMaxZIndex=function(e){var t=Zp;return e.isGroup&&(t=Math.max(t,e.zIndex)),e.children&&e.children.forEach((function(e){"object"==typeof e&&(e=e.id);var i=n.lf.getNodeModelById(e);if(null==i?void 0:i.isGroup){var o=n.findNodeAndChildMaxZIndex(i);t=Math.max(o,t)}})),t},this.checkAndCorrectTopGroupZIndex=function(e){var t=Zp;if(e.forEach((function(e){var i=n.lf.getNodeModelById(e.id);if(i){var o=n.findNodeAndChildMaxZIndex(i);o>t&&(t=o)}})),!(n.topGroupZIndex>=t)){for(var i=n.lf.graphModel.nodes.filter((function(e){return e.isGroup})),o=n.topGroupZIndex,r=0;r<i.length;r++){var a=i[r];a.zIndex>o&&(o=a.zIndex)}n.topGroupZIndex=o}},this.nodeSelected=function(e){var t=e.data,i=e.isMultiple,o=e.isSelected,r=n.lf.getNodeModelById(t.id);if(n.toFrontGroup(r),n.topGroupZIndex>-1e3){n.topGroupZIndex=Zp;for(var a=n.lf.graphModel.nodes.filter((function(e){return e.isGroup})).sort((function(e,t){return e.zIndex-t.zIndex})),s=0,l=0;l<a.length;l++){var u=a[l];u.zIndex!==s&&(n.topGroupZIndex++,s=u.zIndex),u.setZIndex(n.topGroupZIndex)}}if(i&&o)if(null==r?void 0:r.isGroup)r.children.forEach((function(e){var t=n.lf.graphModel.getElement(e);null==t||t.setSelected(!1)}));else{var c=n.nodeGroupMap.get(t.id);if(c){var d=n.lf.getNodeModelById(c);(null==d?void 0:d.isSelected)&&(null==r||r.setSelected(!1))}}},this.toFrontGroup=function(e){e&&e.isGroup&&(n.topGroupZIndex++,e.setZIndex(n.topGroupZIndex),e.children&&e.children.forEach((function(e){var t=n.lf.getNodeModelById(e);n.toFrontGroup(t)})))},t.register($p),this.lf=t,t.graphModel.addNodeMoveRules((function(e,i,o){if(e.isGroup){var r=n.getNodeAllChild(e);return t.graphModel.moveNodes(r,i,o,!0),!0}var a=t.getNodeModelById(n.nodeGroupMap.get(e.id));if(a&&a.isRestrict){var s=e.getBounds(),l=s.minX,u=s.minY,c=s.maxX,d=s.maxY;return a.isAllowMoveTo({minX:l+i,minY:u+o,maxX:c+i,maxY:d+o})}return!0})),t.graphModel.group=this,t.on("node:add,node:drop,node:dnd-add",this.appendNodeToGroup),t.on("node:delete",this.deleteGroupChild),t.on("node:dnd-drag,node:drag",this.setActiveGroup),t.on("node:click",this.nodeSelected),t.on("graph:rendered",this.graphRendered),t.addElements=function(e,i){var o=e.nodes,r=e.edges,a={},s={nodes:[],edges:[]},l=[];return xu(o,(function(e){var o=e.id,r=e.children,u=v(e,["children"]),c=t.addNode(u);if(!c)return{nodes:[],edges:[]};o&&(a[o]=c.id),s.nodes.push(c);var d=n.createAllChildNodes(a,r,c,i).edgesArray;l.push.apply(l,E([],w(d),!1))})),l.forEach((function(e){n.createEdgeModel(e,a,i)})),xu(r,(function(e){var t=n.createEdgeModel(e,a,0);s.edges.push(t)})),s}}return e.prototype.createAllChildNodes=function(e,n,i,o){var r=this,a=this.lf,s=[],l=[],u=[];null==n||n.forEach((function(n){var c=a.getNodeModelById(n);if(c){var d=c.x,h=c.y,f=c.properties,p=c.type,g=c.rotate,v=c.children,m={x:d+o,y:h+o,properties:f,type:p,rotate:g},y=t.EventType.NODE_GROUP_COPY||"node:group-copy-add",b=a.addNode(m,y);if(i.addChild(b.id),e[n]=b.id,u.push(b),c.incoming.edges.forEach((function(e){l.push(e)})),c.outgoing.edges.forEach((function(e){l.push(e)})),v instanceof Set){var x=r.createAllChildNodes(e,v,b,o),C=x.nodesArray,N=x.edgesArray;u.push.apply(u,E([],w(C),!1)),s.push.apply(s,E([],w(N),!1))}}}));var c=l.filter((function(t){return e[t.sourceNodeId]&&e[t.targetNodeId]})).map((function(e){return e.getData()}));return{nodesArray:u,edgesArray:s.concat(c)}},e.prototype.createEdgeModel=function(e,t,n){var i=this.lf,o=e.sourceNodeId,r=e.targetNodeId;t[o]&&(o=t[o]),t[r]&&(r=t[r]);var a=e.type,s=e.startPoint,l=e.endPoint,u=e.pointsList,c=e.text,d={x:((null==s?void 0:s.x)||0)+n,y:((null==s?void 0:s.y)||0)+n},h={x:((null==l?void 0:l.x)||0)+n,y:((null==l?void 0:l.y)||0)+n},f=[];u&&u.length>0&&(f=u.map((function(e){return e.x+=n,e.y+=n,e})));var p={type:a,startPoint:d,endPoint:h,sourceNodeId:o,targetNodeId:r,pointsList:f};return ht(c)&&!qc(c)&&(p.text=g(g({},c),{x:(null==c?void 0:c.x)+n,y:(null==c?void 0:c.y)+n})),i.graphModel.addEdge(p)},e.prototype.getNodeAllChild=function(e){var t=this,n=[];return e.children&&e.children.forEach((function(e){n.push(e);var i=t.lf.getNodeModelById(e);(null==i?void 0:i.isGroup)&&(n=n.concat(t.getNodeAllChild(i)))})),n},e.prototype.getGroup=function(e,t){var n=this.lf.graphModel.nodes.filter((function(n){return n.isGroup&&n.isInRange(e)&&n.id!==t.id}));if(0!==n.length){if(1===n.length)return n[0];for(var i=n[n.length-1],o=n.length-2;o>=0;o--)n[o].zIndex>i.zIndex&&(i=n[o]);return i}},e.prototype.getNodeGroup=function(e){var t=this.nodeGroupMap.get(e);if(t)return this.lf.getNodeModelById(t)},e.prototype.render=function(){},e.prototype.destroy=function(){},e.pluginName="group",e}();function Qp(){var e=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return p(n,e),n.prototype.getFoldIcon=function(){var e=this.props.model,n=e,i=n.x,o=n.y,r=n.width,a=n.height,s=n.properties,l=n.foldable,u=e.x-e.width/2+5,c=e.y-e.height/2+5;if(!l)return null;var d=t.h("path",{fill:"none",stroke:"#818281",strokeWidth:2,"pointer-events":"none",d:s.isFolded?"M ".concat(u+3,",").concat(c+6," ").concat(u+11,",").concat(c+6," M").concat(u+7,",").concat(c+2," ").concat(u+7,",").concat(c+10):"M ".concat(u+3,",").concat(c+6," ").concat(u+11,",").concat(c+6," ")});return t.h("g",{},[t.h("rect",{height:12,width:14,rx:2,ry:2,strokeWidth:1,fill:"#F4F5F6",stroke:"#CECECE",cursor:"pointer",x:i-r/2+5,y:o-a/2+5,onClick:function(t){var n,i;t.stopPropagation(),null===(i=(n=e).foldGroup)||void 0===i||i.call(n,!s.isFolded)}}),d])},n.prototype.getResizeShape=function(){var e=this.props.model,n=e.x,i=e.y,o=e.width,r=e.height,a=e.getNodeStyle(),s=g(g({},a),{x:n-o/2,y:i-r/2,width:o,height:r,stroke:"black",strokeWidth:2,strokeDasharray:"0 0"});return t.h("g",{},[t.h("rect",g({},s)),this.getFoldIcon()])},n}(Yp),n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return p(t,e),t.prototype.initNodeData=function(t){e.prototype.initNodeData.call(this,t),this.foldable=!0,this.resizable=!0,this.width=400,this.height=200,this.resetWidthHeight(),this.isTaskNode=!0,this.boundaryEvents=[]},t.prototype.resetWidthHeight=function(){var e,t,n=null===(e=this.properties.iniProp)||void 0===e?void 0:e.width,i=null===(t=this.properties.iniProp)||void 0===t?void 0:t.height;n&&(this.width=n),i&&(this.height=i)},t.prototype.getNodeStyle=function(){var t=e.prototype.getNodeStyle.call(this);return t.stroke="#989891",t.strokeWidth=1,t.strokeDasharray="3 3",this.isSelected&&(t.stroke="rgb(124, 15, 255)"),this.properties.isBoundaryEventTouchingTask&&(t.stroke="#00acff",t.strokeWidth=2),t},t.prototype.addChild=function(t){var n=this.graphModel.getElement(t);null==n||n.setProperties({parent:this.id}),e.prototype.addChild.call(this,t)},t.prototype.getAnchorStyle=function(){var t=e.prototype.getAnchorStyle.call(this);return t.stroke="#000",t.fill="#fff",t.hover||(t.hover={}),t.hover.stroke="transparent",t},t.prototype.getOutlineStyle=function(){var t=e.prototype.getOutlineStyle.call(this);return t.stroke="transparent",t.hover||(t.hover={}),t.hover.stroke="transparent",t},t.prototype.setTouching=function(e){this.setProperty("isBoundaryEventTouchingTask",e)},t.prototype.addBoundaryEvent=function(e){if(this.setTouching(!1),this.boundaryEvents.find((function(t){return t===e})))return!1;var t=this.graphModel.getNodeModelById(e);return null==t||t.setProperties({attachedToRef:this.id}),this.boundaryEvents.push(e),!0},t.prototype.deleteBoundaryEvent=function(e){this.boundaryEvents=this.boundaryEvents.filter((function(t){return t!==e}))},t}(Kp);return{type:"bpmn:subProcess",view:e,model:n}}function eg(e){var t=Ie("bpmn:serviceTask",Me),n=Ie("bpmn:userTask",Te);e.register(t),e.register(n),e.register(Qp()),function(e){function t(e,t){var n=e.x,i=e.y,o=e.width,r=e.height,a=e.id,s=n-o/2,l=n+o/2,u=i-r/2,c=i+r/2,d=t.x,h=t.y;return d>s-5&&d<l+5&&h>u-5&&h<c+5&&!(d>s+5&&d<l-5&&h>u+5&&h<c-5)?a:null}e.on("node:drag,node:dnd-drag",(function(n){var i,o,r=n.data;if("bpmn:boundaryEvent"===r.type){var a=e.graphModel.nodes;try{for(var s=x(a),l=s.next();!l.done;l=s.next()){var u=l.value;u.isTaskNode&&(t(u,r)?u.setTouching(!0):u.setTouching(!1))}}catch(e){i={error:e}}finally{try{l&&!l.done&&(o=s.return)&&o.call(s)}finally{if(i)throw i.error}}}})),e.on("node:drop,node:dnd-add",(function(n){var i,o,r=n.data,a=r.type,s=r.id;if("bpmn:boundaryEvent"===a){var l=e.graphModel.nodes;try{for(var u=x(l),c=u.next();!c.done;c=u.next()){var d,h=c.value;if(h.isTaskNode)if(null!==(d=t(h,r))){var f=e.graphModel.getNodeModelById(s),p=e.graphModel.getNodeModelById(d),g=f.properties.attachedToRef;return g&&g!==d&&e.graphModel.getNodeModelById(g).deleteBoundaryEvent(s),void p.addBoundaryEvent(s)}}}catch(e){i={error:e}}finally{try{c&&!c.done&&(o=u.return)&&o.call(u)}finally{if(i)throw i.error}}}})),e.graphModel.addNodeMoveRules((function(t,n,i){if(t.isTaskNode){var o=t.boundaryEvents;return e.graphModel.moveNodes(o,n,i,!0),!0}return!0}))}(e)}function tg(e){var n=function(t){function n(n,i){n.id||(n.id="Flow_".concat(ge()));var o=g(g(g({},e||{}),n.properties),{isDefaultFlow:!1});return n.properties=o,t.call(this,n,i)||this}return p(n,t),n.extendKey="SequenceFlowModel",n}(t.PolylineEdgeModel),i=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return p(n,e),n.prototype.getStartArrow=function(){return this.props.model.properties.isDefaultFlow?t.h("path",{refX:15,stroke:"#000000",strokeWidth:2,d:"M 20 5 10 -5 z"}):t.h("path",{d:""})},n.extendKey="SequenceFlowEdge",n}(t.PolylineEdge);return{type:"bpmn:sequenceFlow",view:i,model:n}}var ng=tg();var ig=[{nodes:["startEvent","intermediateCatchEvent","boundaryEvent"],definition:[{type:"bpmn:timerEventDefinition",icon:Ee,properties:{definitionType:"bpmn:timerEventDefinition",timerValue:"",timerType:""}}]}];function og(e){function t(t){t.forEach((function(t){var n,i;n=t.nodes,i=t.definition,n.forEach((function(t){(null==e?void 0:e[t])||(e[t]=new Map);var n=null==e?void 0:e[t];i.forEach((function(e){n.set(e.type,e)}))}))}))}return function(){return[e,t]}}var rg=function(){function e(e){var t=e.lf;t.definition={},t.useDefinition=og(t.definition);var n=w(t.useDefinition(),2);n[0];(0,n[1])(ig),function(e){e.register(be(e)),e.register(me(e)),e.register(ye(e)),e.register(we(e)),e.register(xe(e))}(t),function(e){var t=Pe("bpmn:exclusiveGateway",Ne),n=Pe("bpmn:parallelGateway",_e),i=Pe("bpmn:inclusiveGateway",Se);e.register(t),e.register(i),e.register(n)}(t),function(e){e.register(ng)}(t),eg(t),t.setDefaultEdgeType("bpmn:sequenceFlow")}return e.pluginName="BpmnElementsPlugin",e}(),ag=40,sg=40,lg=40,ug=40,cg=100,dg=80,hg=100,fg=80,pg=100,gg=80,vg=100,mg=80,yg=100,bg=80,xg=100,wg=80,Eg=100,Cg=80,Ng=100,_g=80,Sg=function(){};(Sg.ObjTree=function(){return this}).VERSION="0.23",Sg.ObjTree.prototype.xmlDecl='<?xml version="1.0" encoding="UTF-8" ?>\n',Sg.ObjTree.prototype.attr_prefix="-",Sg.ObjTree.prototype.parseXML=function(e){var t;if(window.DOMParser){var n=new DOMParser,i=n.parseFromString(e,"application/xml");if(!i)return;t=i.documentElement}else window.ActiveXObject&&((n=new ActiveXObject("Microsoft.XMLDOM")).async=!1,n.loadXML(e),t=n.documentElement);if(t)return this.parseDOM(t)},Sg.ObjTree.prototype.parseHTTP=function(e,t,n){var i,o={};for(var r in t)o[r]=t[r];if(o.method||(void 0===o.postBody&&void 0===o.postbody&&void 0===o.parameters?o.method="get":o.method="post"),n){o.asynchronous=!0;var a=this,s=n,l=o.onComplete;o.onComplete=function(e){var t;e&&e.responseXML&&e.responseXML.documentElement&&(t=a.parseDOM(e.responseXML.documentElement)),s(t,e),l&&l(e)}}else o.asynchronous=!1;if("undefined"!=typeof HTTP&&HTTP.Request)o.uri=e,(u=new HTTP.Request(o))&&(i=u.transport);else if("undefined"!=typeof Ajax&&Ajax.Request){var u;(u=new Ajax.Request(e,o))&&(i=u.transport)}return n?i:i&&i.responseXML&&i.responseXML.documentElement?this.parseDOM(i.responseXML.documentElement):void 0},Sg.ObjTree.prototype.parseDOM=function(e){if(e){if(this.__force_array={},this.force_array)for(var t=0;t<this.force_array.length;t++)this.__force_array[this.force_array[t]]=1;var n=this.parseElement(e);if(this.__force_array[e.nodeName]&&(n=[n]),11!==e.nodeType){var i={};i[e.nodeName]=n,n=i}return n}},Sg.ObjTree.prototype.parseElement=function(e){if(7!==e.nodeType){if(3===e.nodeType||4===e.nodeType||8===e.nodeType){if(null==e.nodeValue.match(/[^\x00-\x20]/))return;return e.nodeValue}var t=null,n={};if(e.attributes&&e.attributes.length){t={};for(var i=0;i<e.attributes.length;i++){if("string"==typeof(s=e.attributes[i].nodeName)){var o=e.attributes[i].nodeValue;try{o=JSON.parse(e.attributes[i].nodeValue.replace(/'/g,'"'))}catch(t){o=e.attributes[i].nodeValue}null!=o&&(void 0===n[s=this.attr_prefix+s]&&(n[s]=0),n[s]++,this.addNode(t,s,n[s],o))}}}if(e.childNodes&&e.childNodes.length){var r=!0;t&&(r=!1);for(i=0;i<e.childNodes.length&&r;i++){var a=e.childNodes[i].nodeType;3!==a&&4!==a&&8!==a&&(r=!1)}if(r){t||(t="");for(i=0;i<e.childNodes.length;i++)t+=e.childNodes[i].nodeValue}else{t||(t={});for(i=0;i<e.childNodes.length;i++){var s;if("string"==typeof(s=e.childNodes[i].nodeName))(o=this.parseElement(e.childNodes[i]))&&(void 0===n[s]&&(n[s]=0),n[s]++,this.addNode(t,s,n[s],o))}}}else null===t&&(t={});return t}},Sg.ObjTree.prototype.addNode=function(e,t,n,i){this.__force_array[t]?(1===n&&(e[t]=[]),e[t][e[t].length]=i):1===n?e[t]=i:2===n?e[t]=[e[t],i]:e[t][e[t].length]=i},Sg.ObjTree.prototype.writeXML=function(e){var t=this.hash_to_xml(null,e);return this.xmlDecl+t},Sg.ObjTree.prototype.hash_to_xml=function(e,t){var n=[],i=[];for(var o in t)if(pc(t,o)){var r=t[o];o.charAt(0)!==this.attr_prefix?void 0===r||null==r?n[n.length]="<".concat(o," />"):"object"==typeof r&&r.constructor===Array?n[n.length]=this.array_to_xml(o,r):n[n.length]="object"==typeof r?this.hash_to_xml(o,r):this.scalar_to_xml(o,r):i[i.length]=" ".concat(o.substring(1),'="').concat(this.xml_escape(r),'"')}var a=i.join(""),s=n.join("");return void 0===e||null==e||(s=n.length>0?s.match(/\n/)?"<".concat(e).concat(a,">\n").concat(s,"</").concat(e,">\n"):"<".concat(e).concat(a,">").concat(s,"</").concat(e,">\n"):"<".concat(e).concat(a," />\n")),s},Sg.ObjTree.prototype.array_to_xml=function(e,t){for(var n=[],i=0;i<t.length;i++){var o=t[i];void 0===o||null==o?n[n.length]="<".concat(e," />"):"object"==typeof o&&o.constructor===Array?n[n.length]=this.array_to_xml(e,o):n[n.length]="object"==typeof o?this.hash_to_xml(e,o):this.scalar_to_xml(e,o)}return n.join("")},Sg.ObjTree.prototype.scalar_to_xml=function(e,t){return"#text"===e?this.xml_escape(t):"<".concat(e,">").concat(this.xml_escape(t),"</").concat(e,">\n")},Sg.ObjTree.prototype.xml_escape=function(e){return e.replace(/&/g,"&").replace(/</g,"<").replace(/>/g,">").replace(/"/g,'"')};function Mg(e){return Object.prototype.toString.call(e)}function Tg(e){return"  ".repeat(e)}function Ag(e){return"[object Object]"===Mg(e)?Object.keys(e).reduce((function(t,n){var i=n;return"-"===n.charAt(0)&&(i=n.substring(1)),t[i]=Ag(e[n]),t}),{}):Array.isArray(e)?e.map((function(e){return Ag(e)})):e}var kg,Rg="\t\n";function Og(e,t,n){var i=Tg(n),o="",r=Rg+i;if("-json"===t)return"";if("#text"===t)return r+e;if("#cdata-section"===t)return"".concat(r,"<![CDATA[").concat(e,"]]>");if("#comment"===t)return"".concat(r,"\x3c!--").concat(e,"--\x3e");if("-"==="".concat(t).charAt(0))return" ".concat(t.substring(1),'="').concat(function(e){var t=e;try{"string"!=typeof t&&(t=JSON.parse(e))}catch(n){t=JSON.stringify(Ag(e)).replace(/"/g,"'")}return t}(e),'"');if(Array.isArray(e))o+=e.map((function(e){return Og(e,t,n+1)})).join("");else if("[object Object]"===Mg(e)){var a=Object.keys(e),s="",l=e["-json"]?Rg+Tg(n+1)+e["-json"]:"";o+="".concat(0===n?"":r,"<").concat(t),a.forEach((function(t){"-"===t.charAt(0)?s+=Og(e[t],t,n+1):l+=Og(e[t],t,n+1)})),o+=s+(""!==l?">".concat(l).concat(r,"</").concat(t,">"):" />")}else o+="".concat(r,"<").concat(t,">").concat(e.toString(),"</").concat(t,">");return o}!function(e){e.START="bpmn:startEvent",e.END="bpmn:endEvent",e.INTERMEDIATE_CATCH="bpmn:intermediateCatchEvent",e.INTERMEDIATE_THROW="bpmn:intermediateThrowEvent",e.BOUNDARY="bpmn:boundaryEvent",e.PARALLEL_GATEWAY="bpmn:parallelGateway",e.INCLUSIVE_GATEWAY="bpmn:inclusiveGateway",e.EXCLUSIVE_GATEWAY="bpmn:exclusiveGateway",e.USER="bpmn:userTask",e.SYSTEM="bpmn:serviceTask",e.FLOW="bpmn:sequenceFlow",e.SUBPROCESS="bpmn:subProcess"}(kg||(kg={}));var Pg=["-name","-id","bpmn:incoming","bpmn:outgoing","-sourceRef","-targetRef","-children"],Dg=["properties","startPoint","endPoint","pointsList"],Ig={in:[],out:["properties.panels","properties.nodeSize","properties.definitionId","properties.timerValue","properties.timerType","properties.definitionType","properties.parent","properties.isBoundaryEventTouchingTask"]},Lg=function(e,t){return Object.keys(t||{}).forEach((function(n){if(e[n]){var i=t[n],o=i.in,r=i.out;o&&(e[n].in=o),r&&(e[n].out=r)}else e[n]=t[n]})),e},Bg={"bpmn:startEvent":{out:function(e){var t,n,i=e.properties;return(null===(n=null===(t=Bg[i.definitionType])||void 0===t?void 0:t.out)||void 0===n?void 0:n.call(t,e))||{}}},"bpmn:intermediateCatchEvent":{out:function(e){var t,n,i=e.properties;return(null===(n=null===(t=Bg[i.definitionType])||void 0===t?void 0:t.out)||void 0===n?void 0:n.call(t,e))||{}}},"bpmn:intermediateThrowEvent":{out:function(e){var t,n,i=e.properties;return(null===(n=null===(t=Bg[i.definitionType])||void 0===t?void 0:t.out)||void 0===n?void 0:n.call(t,e))||{}}},"bpmn:boundaryEvent":{out:function(e){var t,n,i=e.properties;return(null===(n=null===(t=Bg[i.definitionType])||void 0===t?void 0:t.out)||void 0===n?void 0:n.call(t,e))||{}}},"bpmn:sequenceFlow":{out:function(e){var t=e.properties,n=t.expressionType,i=t.condition;return i?"cdata"===n?{json:'<bpmn:conditionExpression xsi:type="bpmn2:tFormalExpression"><![CDATA[${'.concat(i,"}]]></bpmn:conditionExpression>")}:{json:'<bpmn:conditionExpression xsi:type="bpmn2:tFormalExpression">'.concat(i,"</bpmn:conditionExpression>")}:{json:""}}},"bpmn:timerEventDefinition":{out:function(e){var t=e.properties,n=t.timerType,i=t.timerValue,o=t.definitionId;return{json:'<bpmn:timerEventDefinition id="'.concat(o,'"').concat(n&&i?">".concat("<bpmn:".concat(n,' xsi:type="bpmn:tFormalExpression">').concat(i,"</bpmn:").concat(n,">"),"</bpmn:timerEventDefinition>"):"/>")}},in:function(e,t){var n,i,o,r=e,a=t["-id"],s="",l="";try{for(var u=x(Object.keys(t)),c=u.next();!c.done;c=u.next()){var d=c.value;d.includes("bpmn:")&&(s=w(d.split(":"),2)[1],l=null===(o=t[d])||void 0===o?void 0:o["#text"])}}catch(e){n={error:e}}finally{try{c&&!c.done&&(i=u.return)&&i.call(u)}finally{if(n)throw n.error}}return{"-definitionId":a,"-definitionType":r,"-timerType":s,"-timerValue":l}}},"bpmn:conditionExpression":{in:function(e,t){var n,i="",o="";return t["#cdata-section"]?(o="cdata",i=(null===(n=/^\$\{(.*)\}$/g.exec(t["#cdata-section"]))||void 0===n?void 0:n[1])||""):t["#text"]&&(o="normal",i=t["#text"]),{"-condition":i,"-expressionType":o}}}};function jg(e){var t=null!=e?e:{},n=t.retainedAttrsFields,i=t.excludeFields,o=t.transformer,r=new Set(E(E([],w(Dg),!1),w(n||[]),!1)),a={in:new Set(E(E([],w(Ig.in),!1),w((null==i?void 0:i.in)||[]),!1)),out:new Set(E(E([],w(Ig.out),!1),w((null==i?void 0:i.out)||[]),!1))};return Bg=Lg(Bg,o),function(e){var t=e.nodes,n=e.edges;return function e(i,o){var s,l;if(1!==(null==i?void 0:i.flag)){var u;if((u=Bg[i.type])&&u.out){var c=u.out(i),d=Object.keys(c);d.length>0&&d.forEach((function(e){i[e]=c[e]}))}(null==i?void 0:i.children)&&(i.children=i.children.map((function(e){return t.find((function(t){return t.id===e}))||n.find((function(t){return t.id===e}))||{}})));var h={};if("string"==typeof i)return i;if(Array.isArray(i))return i.map((function(t){return e(t,"")})).filter((function(e){return null!=e}));try{for(var f=x(Object.entries(i)),p=f.next();!p.done;p=f.next()){var g=w(p.value,2),v=g[0],m=g[1];if(1===(null==m?void 0:m.flag))return;var y=[o,v].filter((function(e){return e})).join(".");a.out.has(y)||("object"!=typeof m?0===v.indexOf("-")||["#text","#cdata-section","#comment"].includes(v)?h[v]=m:h["-".concat(v)]=m:r.has(y)?h["-".concat(v)]=e(m,y):h[v]=e(m,y))}}catch(e){s={error:e}}finally{try{p&&!p.done&&(l=f.return)&&l.call(f)}finally{if(s)throw s.error}}return h}}(e,"")}}function Fg(e){var t,n,i={};try{for(var o=x(Object.entries(e)),r=o.next();!r.done;r=o.next()){var a=w(r.value,2),s=a[0],l=a[1];0===s.indexOf("-")?i[s.substring(1)]=Ag(l):"string"==typeof l?i[s]=l:"[object Object]"===Object.prototype.toString.call(l)?i[s]=Fg(l):Array.isArray(l)?i[s]=l.map((function(e){return Fg(e)})):i[s]=l}}catch(e){t={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return i}function Hg(e,t){e["bpmndi:BPMNEdge"]=t.edges.map((function(e){var t,n=e.id,i=e.pointsList.map((function(e){return{"-x":e.x,"-y":e.y}})),o={"-id":"".concat(n,"_di"),"-bpmnElement":n,"di:waypoint":i};return(null===(t=e.text)||void 0===t?void 0:t.value)&&(o["bpmndi:BPMNLabel"]={"dc:Bounds":{"-x":e.text.x-10*e.text.value.length/2,"-y":e.text.y-7,"-width":10*e.text.value.length,"-height":14}}),o})),e["bpmndi:BPMNShape"]=t.nodes.map((function(e){var t,n=e.id,i=100,o=80,r=e.x,a=e.y,s=qg.shapeConfigMap.get(e.type);s&&(i=s.width,o=s.height),r-=i/2,a-=o/2;var l={"-id":"".concat(n,"_di"),"-bpmnElement":n,"dc:Bounds":{"-x":r,"-y":a,"-width":i,"-height":o}};return(null===(t=e.text)||void 0===t?void 0:t.value)&&(l["bpmndi:BPMNLabel"]={"dc:Bounds":{"-x":e.text.x-10*e.text.value.length/2,"-y":e.text.y-7,"-width":10*e.text.value.length,"-height":14}}),l}))}var Wg=["bpmn:incoming","bpmn:outgoing"];function zg(e,t){var n=[],i=[],o=new Map,r=null!=t?t:{},a=r.transformer,s=r.excludeFields,l={in:new Set(E(E([],w(Ig.in),!1),w((null==s?void 0:s.in)||[]),!1)),out:new Set(E(E([],w(Ig.out),!1),w((null==s?void 0:s.out)||[]),!1))};Bg=Lg(Bg,a);var u,c,d=e["bpmn:definitions"];if(d){var h=d["bpmn:process"];u=h,c=[function(e){function t(e){e["-children"]||(e["-children"]=[]),Object.keys(e).forEach((function(t){var n;0!==t.indexOf("bpmn:")||Wg.includes(t)||(h[t]||(h[t]=[]),!Array.isArray(h[t])&&(h[t]=[h[t]]),Array.isArray(e[t])?(n=h[t]).push.apply(n,E([],w(e[t]),!1)):h[t].push(e[t]),Array.isArray(e[t])?e[t].forEach((function(n){!t.includes("Flow")&&e["-children"].push(n["-id"])})):!t.includes("Flow")&&e["-children"].push(e[t]["-id"]),delete e[t])}))}if("bpmn:subProcess"===e){var n=h[e];Array.isArray(n)?n.forEach((function(n){"bpmn:subProcess"===e&&t(n)})):t(n)}},function(e){function t(e){var n;o.set(e["-id"],e),Array.isArray(e)?e.forEach((function(e){t(e)})):"object"==typeof e&&(n=e,Object.keys(n).forEach((function(e){var i,o;if(e.includes("bpmn:")){var r={};Bg[e]&&Bg[e].in?(r=null===(o=(i=Bg[e]).in)||void 0===o?void 0:o.call(i,e,fn.cloneDeep(n[e])),delete n[e]):t(n[e]);var a=void 0;(a=Reflect.ownKeys(r)).length>0&&a.forEach((function(e){Reflect.set(n,e,r[e])}))}})))}t(h[e])},function(e){if(0===e.indexOf("bpmn:")){var t=h[e];if("bpmn:sequenceFlow"===e){var r=d["bpmndi:BPMNDiagram"]["bpmndi:BPMNPlane"]["bpmndi:BPMNEdge"];i=function(e,t){var n=[];if(Array.isArray(e))e.forEach((function(e){var i;i=Array.isArray(t)?t.find((function(t){return t["-bpmnElement"]===e["-id"]})):t,n.push(Ug(i,e))}));else{var i=void 0;i=Array.isArray(t)?t.find((function(t){return t["-bpmnElement"]===e["-id"]})):t,n.push(Ug(i,e))}return n}(t,r)}else{var a=d["bpmndi:BPMNDiagram"]["bpmndi:BPMNPlane"]["bpmndi:BPMNShape"];if("bpmn:boundaryEvent"===e){var s=h[e],l=function(e){var t=e["-attachedToRef"],n=o.get(t);n["-boundaryEvents"]||(n["-boundaryEvents"]=[]),n["-boundaryEvents"].push(e["-id"])};Array.isArray(s)?s.forEach((function(e){l(e)})):l(s)}n=n.concat(function(e,t,n){var i=[];if(Array.isArray(e))e.forEach((function(e){var o=Gg(Array.isArray(t)?t.find((function(t){return t["-bpmnElement"]===e["-id"]})):t,n,e);i.push(o)}));else{var o=Gg(Array.isArray(t)?t.find((function(t){return t["-bpmnElement"]===e["-id"]})):t,n,e);i.push(o)}return i}(t,a,e))}}}],c.forEach((function(e){try{Object.keys(u).forEach((function(t){try{e(t)}catch(e){}}))}catch(e){}}))}var f=function(e,t,n){Object.keys(e).forEach((function(i){var o=n?"".concat(n,".").concat(i):i;t.has(o)?delete e[i]:"object"==typeof e[i]&&f(e[i],t,o)}))};return n.forEach((function(e){var n,i;if(null===(n=null==t?void 0:t.mapping)||void 0===n?void 0:n.in){var o=null===(i=null==t?void 0:t.mapping)||void 0===i?void 0:i.in,r=e.type;o[r]&&(e.type=o[r])}f(e,l.in,"")})),i.forEach((function(e){var n,i;if(null===(n=null==t?void 0:t.mapping)||void 0===n?void 0:n.in){var o=null===(i=null==t?void 0:t.mapping)||void 0===i?void 0:i.in,r=e.type;o[r]&&(e.type=o[r])}f(e,l.in,"")})),{nodes:n,edges:i}}function Gg(e,t,n){var i=Number(e["dc:Bounds"]["-x"]),o=Number(e["dc:Bounds"]["-y"]),r=n["-children"],a=n["-name"],s=qg.shapeConfigMap.get(t);s&&(i+=s.width/2,o+=s.height/2);var l,u={};if(Object.entries(n).forEach((function(e){var t=w(e,2),n=t[0],i=t[1];Pg.includes(n)||(u[n]=i)})),u=Fg(u),a&&(l={x:i,y:o,value:a},e["bpmndi:BPMNLabel"]&&e["bpmndi:BPMNLabel"]["dc:Bounds"])){var c=e["bpmndi:BPMNLabel"]["dc:Bounds"];l.x=Number(c["-x"])+Number(c["-width"])/2,l.y=Number(c["-y"])+Number(c["-height"])/2}var d={id:e["-bpmnElement"],type:t,x:i,y:o,properties:u};return r&&(d.children=r),l&&(d.text=l),d}function Ug(e,t){var n,i=t["-name"]?"".concat(t["-name"]):"";if(i){var o=e["bpmndi:BPMNLabel"]["dc:Bounds"],r=0;i.split("\n").forEach((function(e){r<e.length&&(r=e.length)})),n={value:i,x:Number(o["-x"])+10*r/2,y:Number(o["-y"])+7}}var a={};Object.entries(t).forEach((function(e){var t=w(e,2),n=t[0],i=t[1];Pg.includes(n)||(a[n]=i)})),a=Fg(a);var s=e["di:waypoint"].map((function(e){return{x:Number(e["-x"]),y:Number(e["-y"])}})),l={id:t["-id"],type:kg.FLOW,pointsList:s,sourceNodeId:t["-sourceRef"],targetNodeId:t["-targetRef"],properties:a};return n&&(l.text=n),l}var qg=function(){function e(e){var t=e.lf,n=this;this.adapterOut=function(e,t){var i,o,r=g({},n.processAttributes);!function(e,t,n){var i,o=new Map,r=jg(n)(t);r.nodes.forEach((function(t){var n=t["-id"],i=t["-type"],r=t.text,a=t.children,s=v(t,["-id","-type","text","children"]),l={"-id":n};(null==r?void 0:r["-value"])&&(l["-name"]=r["-value"]),s["-json"]&&(l["-json"]=s["-json"]),s["-properties"]&&Object.assign(l,s["-properties"]),a&&(l.children=a),e[i]||(e[i]=[]),e[i].push(l),o.set(n,l)}));var a=r.edges.map((function(e){var t=e["-id"],n=e["-sourceNodeId"],i=e["-targetNodeId"],r=e.text,a=v(e,["-id","-sourceNodeId","-targetNodeId","text"]),s=o.get(i);s["bpmn:incoming"]||(s["bpmn:incoming"]=[]),s["bpmn:incoming"].push(t);var l={"-id":t,"-sourceRef":n,"-targetRef":i};return(null==r?void 0:r["-value"])&&(l["-name"]=r["-value"]),a["-json"]&&(l["-json"]=a["-json"]),a["-properties"]&&Object.assign(l,a["-properties"]),l}));t.edges.forEach((function(e){var t=e.sourceNodeId,n=e.id,i=o.get(t);i["bpmn:outgoing"]||(i["bpmn:outgoing"]=[]),i["bpmn:outgoing"].push(n)})),null===(i=e["bpmn:subProcess"])||void 0===i||i.forEach((function(t){var n={"bpmn:incoming":new Set,"bpmn:outgoing":new Set},i=[];t.children.forEach((function(i){var r,a=o.get(i["-id"]);["bpmn:incoming","bpmn:outgoing"].forEach((function(e){a[e]&&a[e].forEach((function(t){n[e].add(t)}))}));var s=null===(r=e[i["-type"]])||void 0===r?void 0:r.findIndex((function(e){return e["-id"]===i["-id"]}));s>=0&&e[i["-type"]].splice(s,1),o.delete(i["-id"]),t[i["-type"]]||(t[i["-type"]]=[]),t[i["-type"]].push(a)}));var r=n["bpmn:incoming"];n["bpmn:outgoing"].forEach((function(e){r.has(e)&&i.push(e)}));for(var s,l=function(e){var n=a.findIndex((function(t){return t["-id"]===i[e]}));n>=0?(t["bpmn:sequenceFlow"]||(t["bpmn:sequenceFlow"]=[]),t["bpmn:sequenceFlow"].push(a[n]),a.splice(n,1)):e++,s=e},u=0;u<i.length;)l(u),u=s;delete t.children})),e[kg.FLOW]=a}(r,e,t);var a={"-id":"BPMNPlane_1","-bpmnElement":r["-id"]};Hg(a,e);var s=n.definitionAttributes;s["bpmn:process"]=r,s["bpmndi:BPMNDiagram"]={"-id":"BPMNDiagram_1","bpmndi:BPMNPlane":a};var l={"bpmn:definitions":s};if(null===(i=null==t?void 0:t.mapping)||void 0===i?void 0:i.out){var u=null===(o=null==t?void 0:t.mapping)||void 0===o?void 0:o.out,c=function(e){Array.isArray(e)&&e.forEach((function(e){return c(e)})),"object"==typeof e&&Object.keys(e).forEach((function(t){var n;(n=u[t])?(e[n]=fn.cloneDeep(e[t]),delete e[t],c(e[n])):c(e[t])}))};c(l)}return l},this.adapterIn=function(e,t){if(e)return zg(e,t)},t.adapterIn=this.adapterIn,t.adapterOut=this.adapterOut,this.processAttributes={"-isExecutable":"true","-id":"Process"},this.definitionAttributes={"-id":"Definitions","-xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","-xmlns:bpmn":"http://www.omg.org/spec/BPMN/20100524/MODEL","-xmlns:bpmndi":"http://www.omg.org/spec/BPMN/20100524/DI","-xmlns:dc":"http://www.omg.org/spec/DD/20100524/DC","-xmlns:di":"http://www.omg.org/spec/DD/20100524/DI","-targetNamespace":"http://logic-flow.org","-exporter":"logicflow","-exporterVersion":"1.2.10"}}return e.prototype.setCustomShape=function(t,n){e.shapeConfigMap.set(t,n)},e.pluginName="bpmn-adapter",e.shapeConfigMap=new Map,e}();qg.shapeConfigMap.set(kg.START,{width:ag,height:sg}),qg.shapeConfigMap.set(kg.END,{width:lg,height:ug}),qg.shapeConfigMap.set(kg.INTERMEDIATE_CATCH,{width:hg,height:fg}),qg.shapeConfigMap.set(kg.INTERMEDIATE_THROW,{width:hg,height:fg}),qg.shapeConfigMap.set(kg.BOUNDARY,{width:cg,height:dg}),qg.shapeConfigMap.set(kg.PARALLEL_GATEWAY,{width:pg,height:gg}),qg.shapeConfigMap.set(kg.INCLUSIVE_GATEWAY,{width:vg,height:mg}),qg.shapeConfigMap.set(kg.EXCLUSIVE_GATEWAY,{width:yg,height:bg}),qg.shapeConfigMap.set(kg.SYSTEM,{width:xg,height:wg}),qg.shapeConfigMap.set(kg.USER,{width:Eg,height:Cg}),qg.shapeConfigMap.set(kg.SUBPROCESS,{width:Ng,height:_g});var Xg=function(e){function t(t){var n=e.call(this,t)||this;n.adapterXmlIn=function(e){var t,i=(t=e,(new Sg.ObjTree).parseXML(t));return n.adapterIn(i,n.props)},n.adapterXmlOut=function(e){return function(e){var t="";for(var n in e)t+=Og(e[n],n,0);return t}(n.adapterOut(e,n.props))};var i=t.lf,o=t.props;return i.adapterIn=n.adapterXmlIn,i.adapterOut=n.adapterXmlOut,n.props=o,n}return p(t,e),t.pluginName="BPMNAdapter",t}(qg),Vg={SEQUENCE_FLOW:1,START_EVENT:2,END_EVENT:3,USER_TASK:4,EXCLUSIVE_GATEWAY:6},Kg={1:"bpmn:sequenceFlow",2:"bpmn:startEvent",3:"bpmn:endEvent",4:"bpmn:userTask",6:"bpmn:exclusiveGateway"};function Yg(e){switch(e){case"bpmn:sequenceFlow":return Vg.SEQUENCE_FLOW;case"bpmn:startEvent":return Vg.START_EVENT;case"bpmn:endEvent":return Vg.END_EVENT;case"bpmn:userTask":return Vg.USER_TASK;case"bpmn:exclusiveGateway":return Vg.EXCLUSIVE_GATEWAY;default:return e}}function $g(e,t,n){var i=t.x,o=t.y,r=e.x-i,a=e.y-o;return{x:r*Math.cos(n)-a*Math.sin(n)+i,y:r*Math.sin(n)+a*Math.cos(n)+o}}var Zg=function(e){function n(){var n=e.apply(this,E([],w(arguments),!1))||this;return n.childrenPositionMap=new Map,n.onNodeRotate=function(e){var t=e.model,i=n.props,o=i.model,r=i.graphModel,a=o.transformWithContainer,s=o.isRestrict,l=n.childrenPositionMap;if(a&&!s&&t.id===o.id){var u={x:o.x,y:o.y};xu(Array.from(o.children),(function(e){var n=r.getNodeModelById(e);if(n){var i={x:n.x,y:n.y};l.has(n.id)?i=l.get(n.id):l.set(n.id,i);var o=t.rotate*(180/Math.PI);o<0&&(o+=360);var a=o*(Math.PI/180),s=$g(i,u,a);n.moveTo(s.x,s.y),n.rotate=t.rotate}}))}},n.onNodeResize=function(e){var i=e.deltaX,o=e.deltaY,r=e.index,a=e.model,s=e.preData,l=n.props,u=l.model,c=l.graphModel,d=u.transformWithContainer,h=u.isRestrict;if(d&&!h&&a.id===u.id){var f=s.properties||{},p=f.width,g=f.height;xu(Array.from(u.children),(function(e){var n=c.getNodeModelById(e);if(n){var a=n.width/p*i,s=n.height/g*o;t.handleResize({deltaX:a,deltaY:s,index:r,nodeModel:n,graphModel:c,cancelCallback:function(){}})}}))}},n.onNodeMouseMove=function(){},n.graphRendered=function(){var e=n.props.model;e.isCollapsed&&e.toggleCollapse(!0)},n}return p(n,e),n.prototype.componentDidMount=function(){e.prototype.componentDidMount.call(this);var t=this.props.graphModel.eventCenter;t.on("node:rotate",this.onNodeRotate),t.on("node:resize",this.onNodeResize),t.on("node:mousemove",this.onNodeMouseMove),t.on("graph:rendered",this.graphRendered)},n.prototype.componentWillUnmount=function(){e.prototype.componentWillUnmount.call(this);var t=this.props.graphModel.eventCenter;t.off("node:rotate",this.onNodeRotate),t.off("node:resize",this.onNodeResize),t.off("node:mousemove",this.onNodeMouseMove),t.off("graph:rendered",this.graphRendered)},n.prototype.getNodesInGroup=function(e,t){var n=this,i=[];return e.isGroup&&xu(Array.from(e.children),(function(e){i.push(e);var o=t.getNodeModelById(e);(null==o?void 0:o.isGroup)&&(i=i.concat(n.getNodesInGroup(o,t)))})),i},n.prototype.getResizeControl=function(){var t=this.props.model,n=t.resizable,i=t.isCollapsed;return n&&!i?e.prototype.getResizeControl.call(this):null},n.prototype.getAppendAreaShape=function(){var e=this.props.model,n=e.width,i=e.height,o=e.x,r=e.y,a=e.radius;if(!e.groupAddable)return null;var s=e.getNodeStyle().strokeWidth,l=void 0===s?0:s,u=e.getAddableOutlineStyle(),c=n+l+8,d=i+l+8;return t.h("rect",g(g({},u),{width:c,height:d,x:o-c/2,y:r-d/2,rx:a,ry:a}))},n.prototype.getCollapseIcon=function(e,t){return"M ".concat(e+3,",").concat(t+6," ").concat(e+11,",").concat(t+6," M").concat(e+7,",").concat(t+2," ").concat(e+7,",").concat(t+10)},n.prototype.getExpandIcon=function(e,t){return"M ".concat(e+3,",").concat(t+6," ").concat(e+11,",").concat(t+6," ")},n.prototype.getOperateIcon=function(){var e=this.props.model,n=e.x,i=e.y,o=n-e.width/2+10,r=i-e.height/2+10;if(!e.collapsible)return null;var a=(null==e?void 0:e.isCollapsed)?this.getCollapseIcon(o,r):this.getExpandIcon(o,r),s=t.h("path",{fill:"none",stroke:"#818281",strokeWidth:2,"pointer-events":"none",d:a});return t.h("g",{},[t.h("rect",{height:12,width:14,rx:2,ry:2,strokeWidth:1,fill:"#f4f5f6",stroke:"#cecece",cursor:"pointer",x:o,y:r,onClick:function(){e.toggleCollapse(!e.isCollapsed)}}),s])},n.prototype.getShape=function(){return t.h("g",{},[this.getAppendAreaShape(),e.prototype.getShape.call(this),this.getOperateIcon()])},n}(t.RectNode),Jg=function(e){function n(t,n){var i=e.call(this,t,n)||this;return i.isGroup=!0,i.isRestrict=!1,i.autoResize=!1,i.collapsible=!0,i.isCollapsed=!1,i.groupAddable=!1,i.transformWithContainer=!1,i.childrenLastCollapseStateDict=new Map,i.childrenLastCollapseStateDict=new Map,i.initNodeData(t),i.setAttributes(),i}return p(n,e),n.prototype.initNodeData=function(t){var n;e.prototype.initNodeData.call(this,t);var i=null!==(n=t.properties)&&void 0!==n?n:{},o=i.children,r=i.width,a=i.height,s=i.collapsedWidth,l=i.collapsedHeight,u=i.collapsible,c=i.isCollapsed,d=i.zIndex,h=i.isRestrict,f=i.autoResize,p=i.autoToFront,g=i.transformWithContainer;this.children=o?new Set(o):new Set,this.zIndex=null!=d?d:-1e4,this.isCollapsed=null!=c&&c;var v=null!=r?r:400,m=null!=a?a:230;this.width=v,this.height=m,this.expandWidth=v,this.expandHeight=m,this.collapsedWidth=null!=s?s:80,this.collapsedHeight=null!=l?l:60,this.isRestrict=null!=h&&h,this.transformWithContainer=null!=g&&g,this.autoResize=null!=f&&f,this.collapsible=null==u||u,this.autoToFront=null!=p&&p,this.text.editable=!1,this.text.draggable=!1},n.prototype.setAttributes=function(){e.prototype.setAttributes.call(this)},n.prototype.getData=function(){var t=this,n=e.prototype.getData.call(this),i=[];return xu(Array.from(this.children),(function(e){var n=t.graphModel.getNodeModelById(e);n&&!n.virtual&&i.push(e)})),n.children=i,n.properties&&(n.properties.children=i,n.properties.isCollapsed=this.isCollapsed),n},n.prototype.getNodesInGroup=function(e){var t=[];return e.isGroup&&xu(Array.from(e.children),(function(e){t.push(e)})),t},n.prototype.getMoveDistance=function(t,n,i){void 0===i&&(i=!1);var o=w(e.prototype.getMoveDistance.call(this,t,n,i),2),r=o[0],a=o[1],s=this.getNodesInGroup(this);return this.graphModel.moveNodes(s,t,n,i),[r,a]},n.prototype.getHistoryData=function(){var t=e.prototype.getHistoryData.call(this);t.children=Array.from(this.children),t.isGroup=!0;var n=this,i=n.x,o=n.y,r=n.collapsedWidth,a=n.collapsedHeight,s=n.expandWidth,l=n.expandHeight;return n.isCollapsed&&(t.x=i+s/2-r/2,t.y=o+l/2-a/2,t.text&&(t.text.x=t.text.x+s/2-r/2,t.text.y=t.text.y+l/2-a/2)),t},n.prototype.toggleCollapse=function(e){var n=this,i=!!e;this.isCollapsed=i,i?this.collapse():this.expand();var o=E(E([],w(this.incoming.edges),!1),w(this.outgoing.edges),!1);xu(Array.from(this.children),(function(i){var r,a,s=n.graphModel.elementsModelMap.get(i);if(s){var l=s.isCollapsed;if(s.isGroup){var u=s;if(u.isCollapsed||u.toggleCollapse(e),!e){var c=null===(r=n.childrenLastCollapseStateDict)||void 0===r?void 0:r.get(i);void 0!==c&&c!==s.isCollapsed&&u.toggleCollapse(c)}}if(null===(a=n.childrenLastCollapseStateDict)||void 0===a||a.set(i,!!l),s.visible=!e,s.BaseType===t.ElementType.NODE){var d=s.incoming.edges,h=s.outgoing.edges;o=E(E(E([],w(o),!1),w(d),!1),w(h),!1)}}})),this.collapseEdge(i,o)},n.prototype.collapse=function(){var e=this,t=e.x,n=e.y,i=e.text,o=e.width,r=e.height,a=e.collapsedWidth,s=e.collapsedHeight;this.x=t-o/2+a/2,this.y=n-r/2+s/2,this.text.x=i.x-o/2+a/2,this.text.y=i.y-r/2+s/2,this.expandWidth=o,this.expandHeight=r,this.width=a,this.height=s},n.prototype.expand=function(){var e=this,t=e.x,n=e.y,i=e.text,o=e.expandWidth,r=e.expandHeight,a=e.collapsedWidth,s=e.collapsedHeight;this.width=o,this.height=r,this.x=t+this.width/2-a/2,this.y=n+this.height/2-s/2,this.text.x=i.x+this.width/2-a/2,this.text.y=i.y+this.height/2-s/2},n.prototype.createVirtualEdge=function(e){e.pointsList=void 0;var t=this.graphModel.addEdge(e);t.virtual=!0,t.text.editable=!1,t.isCollapsedEdge=!0},n.prototype.collapseEdge=function(e,t){var n=this,i=this.graphModel;xu(t,(function(t,o){var r,a=t.getData(),s=a.targetNodeId,l=a.sourceNodeId,u=g(g({},a),{id:"".concat(a.id,"__").concat(o),text:null===(r=a.text)||void 0===r?void 0:r.value});t.virtual&&i.deleteEdgeById(t.id);var c=i.dynamicGroup.getGroupByNodeId(s);c||(c=i.getNodeModelById(s));var d=i.dynamicGroup.getGroupByNodeId(l);d||(d=i.getNodeModelById(l)),e&&t.visible&&(n.children.has(l)||n.id===l?(u.startPoint=void 0,u.sourceNodeId=n.id):(u.endPoint=void 0,u.targetNodeId=n.id),c.id===n.id&&d.id===n.id||n.createVirtualEdge(u),t.visible=!1),e||t.visible||(c&&c.isGroup&&c.isCollapsed?(u.targetNodeId=c.id,u.endPoint=void 0,n.createVirtualEdge(u)):d&&d.isGroup&&d.isCollapsed?(u.sourceNodeId=d.id,u.startPoint=void 0,n.createVirtualEdge(u)):t.visible=!0)}))},n.prototype.isAllowAppendIn=function(e){return!0},n.prototype.setAllowAppendChild=function(e){this.groupAddable=e},n.prototype.addChild=function(e){this.children.add(e);var t=this.getData();this.graphModel.eventCenter.emit("group:add-node",{data:t})},n.prototype.removeChild=function(e){this.children.delete(e);var t=this.getData();this.graphModel.eventCenter.emit("group:remove-node",{data:t})},n.prototype.toBack=function(){this.zIndex--},n.prototype.getResizeOutlineStyle=function(){var t=e.prototype.getResizeOutlineStyle.call(this);return t.stroke="none",t},n.prototype.getAnchorStyle=function(){var t=e.prototype.getAnchorStyle.call(this);return t.stroke="transparent",t.fill="transparent",t.hover&&(t.hover.fill="transparent",t.hover.stroke="transparent"),t},n.prototype.getAddableOutlineStyle=function(){return{stroke:"#feb663",strokeWidth:2,strokeDasharray:"4 4",fill:"transparent"}},m([t.observable],n.prototype,"isCollapsed",void 0),m([t.observable],n.prototype,"groupAddable",void 0),m([t.observable],n.prototype,"transformWithContainer",void 0),n}(t.RectNodeModel);var Qg,ev={type:"dynamic-group",view:Zg,model:Jg},tv=-1e4,nv=function(){function e(e){var t=e.lf,n=e.options,i=this;this.topGroupZIndex=tv,this.nodeGroupMap=new Map,this.addNodeToGroup=function(e){var t=e.data,n=i.nodeGroupMap.get(t.id);n&&((s=i.lf.getNodeModelById(n)).removeChild(t.id),i.nodeGroupMap.delete(t.id),s.setAllowAppendChild(!1));var o=i.lf.getNodeModelById(t.id),r=null==o?void 0:o.getBounds();if(o&&r){if(o.isGroup){var a=o;xu(Array.from(a.children),(function(e){i.nodeGroupMap.set(e,t.id)})),i.calibrateTopGroupZIndex([t]),i.onNodeSelect({data:t,isSelected:!1,isMultiple:!1})}var s;if(s=i.getGroupByBounds(r,t))s.isAllowAppendIn(t)?(s.addChild(t.id),i.nodeGroupMap.set(t.id,s.id),s.setAllowAppendChild(!0)):i.lf.emit("group:not-allowed",{group:s.getData(),node:t})}},this.removeNodeFromGroup=function(e){var t=e.data;e.model.isGroup&&t.children&&xu(Array.from(t.children),(function(e){i.nodeGroupMap.delete(e),i.lf.deleteNode(e)}));var n=i.nodeGroupMap.get(t.id);if(n){var o=i.lf.getNodeModelById(n);o&&o.removeChild(t.id),i.nodeGroupMap.delete(t.id)}},this.setActiveGroup=function(e){var t=e.data,n=i.lf.getNodeModelById(t.id),o=null==n?void 0:n.getBounds();if(n&&o){var r=i.getGroupByBounds(o,t);if(i.activeGroup&&i.activeGroup.setAllowAppendChild(!1),!r||n.isGroup&&r.id===t.id)return;if(!r.isAllowAppendIn(t))return;i.activeGroup=r,i.activeGroup.setAllowAppendChild(!0)}},this.onNodeSelect=function(e){var t=e.data,n=e.isMultiple,o=e.isSelected,r=i.lf.getNodeModelById(t.id);if(i.sendNodeToFront(r),i.topGroupZIndex>-1e3){var a=i.lf.graphModel.nodes;i.topGroupZIndex=tv;var s=Jh(Hu(a,(function(e){return!!e.isGroup})),"zIndex"),l=0;xu(s,(function(e){e.zIndex!==l&&(i.topGroupZIndex++,l=e.zIndex),e.setZIndex(i.topGroupZIndex)}))}if(n&&o)if(null==r?void 0:r.isGroup){var u=r.children;xu(Array.from(u),(function(e){var t=i.lf.getNodeModelById(e);null==t||t.setSelected(!1)}))}else{var c=i.nodeGroupMap.get(t.id);if(c){var d=i.lf.getNodeModelById(c);(null==d?void 0:d.isSelected)&&(null==r||r.setSelected(!1))}}},this.onNodeMove=function(e){var t=e.deltaX,n=e.deltaY,o=e.data,r=o.id,a=o.x,s=o.y,l=o.properties;if(l){var u=l.width,c=l.height,d=i.nodeGroupMap.get(r);if(d){var h=i.lf.getNodeModelById(d);if(h&&h.isRestrict&&h.autoResize){var f=a+t/2,p=s+n/2,g=f-u/2,v=p-c/2,m=f+u/2,y=p+c/2,b=!1,x=h.getBounds(),w=Object.assign({},x);if(g<w.minX&&(w.minX=g,b=!0),v<w.minY&&(w.minY=v,b=!0),m>w.maxX&&(w.maxX=m,b=!0),y>w.maxY&&(w.maxY=y,b=!0),b){var E=w.minX+(w.maxX-w.minX)/2,C=w.minY+(w.maxY-w.minY)/2,N=w.maxX-w.minX,_=w.maxY-w.minY;h.moveTo(E,C),h.width=N,h.height=_}}}}},this.onGraphRendered=function(e){var t=e.data;xu(t.nodes,(function(e){e.children&&xu(e.children,(function(t){i.nodeGroupMap.set(t,e.id)}))})),i.calibrateTopGroupZIndex(t.nodes)},t.register(ev),this.lf=t,so(this,n),this.init()}return e.prototype.getGroupByNodeId=function(e){var t=this.nodeGroupMap.get(e);if(t)return this.lf.getNodeModelById(t)},e.prototype.getGroupByBounds=function(e,t){var n=Hu(this.lf.graphModel.nodes,(function(n){return!!n.isGroup&&function(e,t){var n=e.minX,i=e.minY,o=e.maxX,r=e.maxY,a=t.x,s=t.y,l=t.width,u=t.height;return n>=a-l/2&&o<=a+l/2&&i>=s-u/2&&r<=s+u/2}(e,n)&&n.id!==t.id})),i=n.length;if(i<=1)return n[0];for(var o=n[i-1],r=i-2;r>=0;r--)n[r].zIndex>o.zIndex&&(o=n[r]);return o},e.prototype.sendNodeToFront=function(e){var t=this;if(e&&e.isGroup&&(this.topGroupZIndex++,e.setZIndex(this.topGroupZIndex),e.children)){var n=e.children;xu(Array.from(n),(function(e){var n=t.lf.getNodeModelById(e);t.sendNodeToFront(n)}))}},e.prototype.getMaxZIndex=function(e){var t=this,n=tv;if(e.isGroup&&(n=Math.max(n,e.zIndex)),e.children){var i=e.children;xu(Array.from(i),(function(e){var i=t.lf.getNodeModelById(e);if(null==i?void 0:i.isGroup){var o=t.getMaxZIndex(i);n=Math.max(n,o)}}))}return n},e.prototype.calibrateTopGroupZIndex=function(e){var t=this,n=tv;if(xu(e,(function(e){var i=t.lf.getNodeModelById(e.id);if(i){var o=t.getMaxZIndex(i);o>n&&(n=o)}})),!(this.topGroupZIndex>=n)){var i=Hu(this.lf.graphModel.nodes,(function(e){return!!e.isGroup})),o=this.topGroupZIndex;xu(i,(function(e){e.zIndex>o&&(o=e.zIndex)})),this.topGroupZIndex=o}},e.prototype.removeChildrenInGroupNodeData=function(e){var t,n=Ls(e);return delete n.children,(null===(t=n.properties)||void 0===t?void 0:t.children)&&delete n.properties.children,n},e.prototype.initGroupChildNodes=function(e,n,i,o){var r=this,a=[],s=[],l=[];xu(Array.from(n),(function(n){var u=r.lf.getNodeModelById(n);if(u){var c=u.children,d=u.getData(),h=t.EventType.NODE_GROUP_COPY||"node:group-copy-add",f=t.transformNodeData(r.removeChildrenInGroupNodeData(d),o),p=r.lf.addNode(f,h);if(i.addChild(p.id),e[n]=p.id,a.push(p),l.push.apply(l,E([],w(E(E([],w(p.incoming.edges),!1),w(p.outgoing.edges),!1)),!1)),c instanceof Set){var g=r.initGroupChildNodes(e,c,p,o),v=g.childNodes,m=g.edgesData;a.push.apply(a,E([],w(v),!1)),s.push.apply(s,E([],w(m),!1))}}}));var u=Ju(Hu(l,(function(t){return pc(e,t.sourceNodeId)&&pc(e,t.targetNodeId)})),(function(e){return e.getData()}));return{childNodes:a,edgesData:s.concat(u)}},e.prototype.createEdge=function(e,n,i){var o,r,a=e.sourceNodeId,s=e.targetNodeId,l=null!==(o=n[a])&&void 0!==o?o:a,u=null!==(r=n[s])&&void 0!==r?r:s,c=Ls(e);return e.id&&"object"==typeof e.text&&null!==e.text&&(c=t.transformEdgeData(e,i)),this.lf.graphModel.addEdge(g(g({},c),{sourceNodeId:l,targetNodeId:u}))},e.prototype.checkGroupBoundsWithChildren=function(e,t,n,i,o){if(e.children)for(var r=e.children,a=e.x+t/2,s=e.y+n/2,l=a-i/2,u=s-o/2,c=a+i/2,d=s+o/2,h=Array.from(r),f=0;f<h.length;f++){var p=h[f],g=this.lf.getNodeModelById(p);if(g){var v=g.getBounds(),m=v.minX,y=v.minY,b=v.maxX,x=v.maxY;if(!(l<=m&&u<=y&&c>=b&&d>=x))return!1}}return!0},e.prototype.init=function(){var e=this,t=this.lf,n=t.graphModel;n.addNodeMoveRules((function(t,n,i){if(t.isGroup)return!0;var o=e.nodeGroupMap.get(t.id),r=e.lf.getNodeModelById(o);return!r||!r.isRestrict||(!!r.autoResize||function(e,t,n,i){var o=e.minX,r=e.minY,a=e.maxX,s=e.maxY,l=t.x,u=t.y,c=t.width,d=t.height;return{x:l+n>=o+c/2&&l+n<=a-c/2,y:u+i>=r+d/2&&u+i<=s-d/2}}(r.getBounds(),t,n,i))})),n.addNodeResizeRules((function(t,n,i,o,r){return!t.isGroup||!t.isRestrict||e.checkGroupBoundsWithChildren(t,n,i,o,r)})),n.dynamicGroup=this,t.on("node:add,node:drop,node:dnd-add",this.addNodeToGroup),t.on("node:delete",this.removeNodeFromGroup),t.on("node:drag,node:dnd-drag",this.setActiveGroup),t.on("node:click",this.onNodeSelect),t.on("node:mousemove",this.onNodeMove),t.on("graph:rendered",this.onGraphRendered),t.on("graph:updated",(function(e){e.data})),t.on("group:add-node",(function(e){e.data})),t.addElements=function(n,i){var o=n.nodes,r=n.edges;void 0===i&&(i=40);var a={},s={nodes:[],edges:[]},l=[];return xu(o,(function(n){var o,r,u=n.id,c=null!==(r=null===(o=n.properties)||void 0===o?void 0:o.children)&&void 0!==r?r:n.children,d=t.addNode(e.removeChildrenInGroupNodeData(n));if(u&&(a[u]=d.id),s.nodes.push(d),d.isGroup){var h=e.initGroupChildNodes(a,c,d,i).edgesData;l.push.apply(l,E([],w(h),!1))}})),xu(l,(function(t){e.createEdge(t,a,i)})),xu(r,(function(t){s.edges.push(e.createEdge(t,a,i))})),s},this.render()},e.prototype.render=function(){},e.prototype.destroy=function(){this.lf.off("node:add,node:drop,node:dnd-add",this.addNodeToGroup),this.lf.off("node:delete",this.removeNodeFromGroup),this.lf.off("node:drag,node:dnd-drag",this.setActiveGroup),this.lf.off("node:click",this.onNodeSelect),this.lf.off("node:mousemove",this.onNodeMove),this.lf.off("graph:rendered",this.onGraphRendered)},e.pluginName="dynamicGroup",e}();!function(e){e.HORIZONTAL="horizontal",e.VERTICAL="vertical"}(Qg||(Qg={}));var iv=function(e,t,n,i){return void 0===i&&(i=0),av(e,t,n)<=i};function ov(e){return e*e}function rv(e,t){return ov(e.x-t.x)+ov(e.y-t.y)}var av=function(e,t,n){return Math.sqrt(function(e,t,n){var i=rv(t,n);if(0===i)return rv(e,t);var o=((e.x-t.x)*(n.x-t.x)+(e.y-t.y)*(n.y-t.y))/i;return o=Math.max(0,Math.min(1,o)),rv(e,{x:t.x+o*(n.x-t.x),y:t.y+o*(n.y-t.y)})}(e,t,n))},sv=function(e,t,n){var i=function(e){var t=e.x,n=e.y,i=e.width,o=e.height;return{minX:t-i/2,minY:n-o/2,maxX:t+i/2,maxY:n+o/2,x:t,y:n,width:i,height:o,centerX:t,centerY:n}}(e),o=function(e,t){var n;return e.x===t.x?n=Qg.VERTICAL:e.y===t.y&&(n=Qg.HORIZONTAL),n}(t,n),r=Math.max(t.x,n.x),a=Math.min(t.x,n.x),s=Math.max(t.y,n.y),l=Math.min(t.y,n.y),u=e.x,c=e.y,d=e.width,h=e.height;if(o===Qg.HORIZONTAL){if(r>=i.maxX&&a<=i.minX)return{startCrossPoint:{x:t.x>n.x?u+d/2:u-d/2,y:t.y},endCrossPoint:{x:t.x>n.x?u-d/2:u+d/2,y:t.y}}}else if(o===Qg.VERTICAL&&s>=i.maxY&&l<=i.minY)return{startCrossPoint:{x:t.x,y:t.y>n.y?c+h/2:c-h/2},endCrossPoint:{x:t.x,y:t.y>n.y?c-h/2:c+h/2}}},lv=function(e,t,n){void 0===n&&(n=0);for(var i=e.x,o=e.y,r=t.pointsList,a=0;a<r.length-1;a++)if(iv({x:i,y:o},r[a],r[a+1],n)){var s=sv(e,r[a],r[a+1]);if(s)return{crossIndex:a+1,crossPoints:s}}return{crossIndex:-1,crossPoints:{startCrossPoint:{x:0,y:0},endCrossPoint:{x:0,y:0}}}},uv=function(){function e(e){var t=e.lf;this._lf=t,this.deviation=20,this.dndAdd=!0,this.dropAdd=!0,this.eventHandler()}return e.prototype.eventHandler=function(){var e=this;this.dndAdd&&this._lf.on("node:dnd-add",(function(t){var n=t.data;e.insetNode(n)})),this.dropAdd&&this._lf.on("node:drop",(function(t){for(var n=t.data,i=e._lf.graphModel.edges,o=n.id,r=!0,a=0;a<i.length;a++)if(i[a].sourceNodeId===o||i[a].targetNodeId===o){r=!1;break}r&&e.insetNode(n)}))},e.prototype.checkRuleBeforeInsetNode=function(e,n,i,o,r){var a=this._lf.getNodeModelById(e),s=this._lf.getNodeModelById(n),l=a.getAnchorInfo(i),u=s.getAnchorInfo(o),c=a.isAllowConnectedAsSource(r,l,u),d=s.isAllowConnectedAsTarget(r,l,u),h=t.formatAnchorConnectValidateData(c),f=h.isAllPass,p=h.msg,g=t.formatAnchorConnectValidateData(d),v=g.isAllPass;return{isPass:f&&v,sourceMsg:p,targetMsg:g.msg}},e.prototype.insetNode=function(e){var n=this,i=this._lf.graphModel.edges,o=this._lf.getNodeModelById(e.id),r=null==o?void 0:o.getDefaultAnchor();if(!r||0===r.length)this._lf.graphModel.eventCenter.emit(t.EventType.CONNECTION_NOT_ALLOWED,{data:e,msg:"自定义类型节点不显示锚点，也不允许其他节点连接到此节点"});else if(o)for(var a=0;a<i.length;a++){var s=lv(o,i[a],this.deviation),l=s.crossIndex,u=s.crossPoints;if(l>=0){var c=i[a],d=c.sourceNodeId,h=c.targetNodeId,f=c.id,p=c.type,g=c.pointsList,v=c.sourceAnchorId,m=c.targetAnchorId,y=Ls(g[0]),b=Ls(u.startCrossPoint);this._lf.deleteEdge(f);var x=this.checkRuleBeforeInsetNode(d,h,v,m,e);if(this._lf.addEdge({type:p,sourceNodeId:d,targetNodeId:e.id,startPoint:y,endPoint:b,pointsList:E(E([],w(g.slice(0,l)),!1),[u.startCrossPoint],!1)}),this._lf.addEdge({type:p,sourceNodeId:e.id,targetNodeId:h,startPoint:Ls(u.endCrossPoint),endPoint:Ls(g[g.length-1]),pointsList:E([u.endCrossPoint],w(g.slice(l)),!1)}),x.isPass)break;this._lf.graphModel.eventCenter.emit(t.EventType.CONNECTION_NOT_ALLOWED,{data:e,msg:x.targetMsg||x.sourceMsg}),setTimeout((function(){n._lf.undo()}),200);break}}},e.pluginName="insertNodeInPolyline",e}(),cv="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},dv={};!function(e){!function(){var t={}.hasOwnProperty;function n(){for(var e="",t=0;t<arguments.length;t++){var n=arguments[t];n&&(e=o(e,i(n)))}return e}function i(e){if("string"==typeof e||"number"==typeof e)return e;if("object"!=typeof e)return"";if(Array.isArray(e))return n.apply(null,e);if(e.toString!==Object.prototype.toString&&!e.toString.toString().includes("[native code]"))return e.toString();var i="";for(var r in e)t.call(e,r)&&e[r]&&(i=o(i,r));return i}function o(e,t){return t?e?e+" "+t:e+t:e}e.exports?(n.default=n,e.exports=n):window.classNames=n}()}({get exports(){return dv},set exports(e){dv=e}});var hv=dv,fv=function(e){function n(n){var i=e.call(this,n)||this;i.textRef=t.createRef(),i.setHoverOn=function(){var e=i.props.element;e.isDragging||i.state.isHovered||(i.setState({isHovered:!0}),e.setHovered(!0))},i.setHoverOff=function(){var e=i.props.element;i.state.isHovered&&(i.setState({isHovered:!1}),e.setHovered(!1))},i.handleMouseDown=function(e){var t,n=i.props,o=n.label,r=n.graphModel.editConfigModel.nodeTextDraggable;!(null!==(t=o.draggable)&&void 0!==t?t:r)||i.state.isDragging||i.state.isEditing||i.stepDrag.handleMouseDown(e)},i.handleMouseUp=function(e){i.state.isDragging&&i.stepDrag.handleMouseUp(e)},i.handleDragging=function(e){var t=e.deltaX,n=e.deltaY;i.state.isDragging||i.setState({isDragging:!0});var o=i.props,r=o.label,a=o.graphModel,s=w(a.transformModel.fixDeltaXY(t,n),2),l=s[0],u=s[1];i.setElementModelLabelInfo({x:r.x+l,y:r.y+u}),a.eventCenter.emit("label:drag",{data:r.getData(),model:r})},i.handleDragEnd=function(){i.setState({isDragging:!1})},i.handleClick=function(e){var t=i.props,n=t.label,o=t.element,r=t.graphModel;o.setSelected(!i.state.isSelected),i.setState({isSelected:!i.state.isSelected}),i.setElementModelLabelInfo({isSelected:!0}),r.eventCenter.emit("label:click",{data:n.getData(),e:e,model:o})},i.handleDbClick=function(e){var n=i.props,o=n.label,r=n.element;if(n.graphModel.eventCenter.emit("label:dblclick",{data:o.getData(),e:e,model:r}),o.editable){if(r.setSelected(),r.setElementState(t.ElementState.TEXT_EDIT),i.setState({isEditing:!0}),i.textRef.current){i.textRef.current.contentEditable="true",i.textRef.current.focus();var a=document.createRange(),s=window.getSelection();a.selectNodeContents(i.textRef.current),a.collapse(!1),null==s||s.removeAllRanges(),null==s||s.addRange(a)}}else r.setSelected(!0)},i.handleBlur=function(e){var t=i.props,n=t.label,o=t.element;t.graphModel.eventCenter.emit("label:blur",{e:e,model:o,data:n.getData(),element:i.textRef.current}),i.setState({isDragging:!1,isHovered:!1,isSelected:!1})},i.handleInput=function(e){var t=i.props,n=t.label;t.graphModel.eventCenter.emit("label:input",{e:e,data:n.getData()})},i.reCalcLabelSize=function(){};var o=n.label,r=n.graphModel,a=r.gridSize,s=r.eventCenter;return i.stepDrag=new t.StepDrag({onDragging:i.handleDragging,onDragEnd:i.handleDragEnd,step:a,eventType:"LABEL",model:o,eventCenter:s}),i.state={isEditing:!1,isHovered:!1,isDragging:!1,isSelected:!1},i}return p(n,e),n.prototype.setElementModelLabelInfo=function(e){var t=this.props,n=t.label,i=t.element,o=t.graphModel,r=i.properties._label,a=Gu(r,(function(e){return e.id===n.id})),s=r[a];r[a]=g(g({},s),e);var l=o.getElement(i.id);null==l||l.setProperty("_label",r)},n.prototype.componentDidMount=function(){var e=this,n=this.props,i=n.label,o=n.element;n.graphModel.eventCenter.on("blank:click,node:click,edge:click,label:click",(function(n){var r,a,s,l,u=n.data;if(("label"!==(null==u?void 0:u.type)||"label"===u.type&&u.id!==i.id||e.state.isSelected)&&e.setState({isSelected:!1}),("label"!==(null==u?void 0:u.type)||"label"==u.type&&u.id!==i.id)&&e.state.isEditing){e.setState({isEditing:!1});var c=null!==(a=null===(r=e.textRef.current)||void 0===r?void 0:r.innerText)&&void 0!==a?a:"",d=null!==(l=null===(s=e.textRef.current)||void 0===s?void 0:s.innerHTML)&&void 0!==l?l:"";e.setElementModelLabelInfo({value:c,content:d,isSelected:!1}),o.setElementState(t.ElementState.DEFAULT)}("label"!==(null==u?void 0:u.type)||"label"==u.type&&u.id!==i.id)&&e.textRef.current&&(e.textRef.current.contentEditable="false")}))},n.prototype.componentDidUpdate=function(){},n.prototype.componentWillUnmount=function(){this.props.graphModel.eventCenter.off("blank:click,node:click,edge:click")},n.prototype.render=function(){var e,t=this.props,n=t.label,i=t.element,o=t.graphModel,r=this.state,a=r.isDragging,s=r.isHovered,l=r.isSelected,u=r.isEditing,c=o.transformModel.getTransformStyle().transform,d=n.id,h=n.x,f=n.y,p=n.zIndex,v=n.vertical,m=n.style,y=n.rotate,b=n.content,x=n.labelWidth,w=n.textOverflowMode,E=null!=x?x:"node"===i.BaseType?i.width-20:80,C={left:"".concat(h-E/2,"px"),top:"".concat(f-10,"px"),width:"".concat(E,"px"),height:"20px",zIndex:null!=p?p:1,transform:y?"".concat(c," rotate(").concat(y,"deg)"):"".concat(c," rotate(").concat(v?-.25:0,"turn)")};return Rp("div",{id:"element-container-".concat(d),className:hv("lf-label-editor-container"),style:C,onMouseDown:this.handleMouseDown,onMouseUp:this.handleMouseUp,onClick:this.handleClick,onDblClick:this.handleDbClick,onBlur:this.handleBlur,onMouseEnter:this.setHoverOn,onMouseOver:this.setHoverOn,onMouseLeave:this.setHoverOff,children:Rp("div",{ref:this.textRef,id:"editor-container-".concat(d),className:hv("lf-label-editor",(e={"lf-label-editor-dragging":a,"lf-label-editor-editing":u,"lf-label-editor-hover":!u&&(s||l)},e["lf-label-editor-".concat(w)]=!u,e)),onInput:this.handleInput,style:g({maxWidth:"".concat(E,"px"),boxSizing:"border-box",display:"inline-block",background:u||"edge"===i.BaseType?"#fff":"transparent"},m),dangerouslySetInnerHTML:{__html:b}})})},n=m([t.observer],n)}(t.Component),pv=t.LogicFlowUtil.createUuid,gv=function(){function e(e,t,n){var i;this.type="label",this.content="",this.value="",this.style={},this.vertical=!1,this.editable=!0,this.draggable=!0,this.textOverflowMode="default",this.element=t,this.graphModel=n,this.id=null!==(i=e.id)&&void 0!==i?i:pv(),this.initLabelData(e)}return e.prototype.initLabelData=function(e){so(this,e)},e.prototype.getData=function(){return{id:this.id,x:this.x,y:this.y,type:"label",content:this.content,value:this.value,rotate:this.rotate,style:t.toJS(this.style),draggable:this.draggable,editable:this.editable,labelWidth:this.labelWidth,textOverflowMode:this.textOverflowMode,vertical:this.vertical}},m([t.observable],e.prototype,"x",void 0),m([t.observable],e.prototype,"y",void 0),m([t.observable],e.prototype,"content",void 0),m([t.observable],e.prototype,"value",void 0),m([t.observable],e.prototype,"rotate",void 0),m([t.observable],e.prototype,"style",void 0),m([t.observable],e.prototype,"zIndex",void 0),m([t.observable],e.prototype,"vertical",void 0),m([t.observable],e.prototype,"editable",void 0),m([t.observable],e.prototype,"draggable",void 0),m([t.observable],e.prototype,"labelWidth",void 0),m([t.observable],e.prototype,"textOverflowMode",void 0),e}(),vv={};!function(e){"classList"in document.createElement("_")||function(e){if("Element"in e){var t="classList",n="prototype",i=e.Element[n],o=Object,r=String[n].trim||function(){return this.replace(/^\s+|\s+$/g,"")},a=Array[n].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1},s=function(e,t){this.name=e,this.code=DOMException[e],this.message=t},l=function(e,t){if(""===t)throw new s("SYNTAX_ERR","An invalid or illegal string was specified");if(/\s/.test(t))throw new s("INVALID_CHARACTER_ERR","String contains an invalid character");return a.call(e,t)},u=function(e){for(var t=r.call(e.getAttribute("class")||""),n=t?t.split(/\s+/):[],i=0,o=n.length;i<o;i++)this.push(n[i]);this._updateClassName=function(){e.setAttribute("class",this.toString())}},c=u[n]=[],d=function(){return new u(this)};if(s[n]=Error[n],c.item=function(e){return this[e]||null},c.contains=function(e){return-1!==l(this,e+="")},c.add=function(){var e,t=arguments,n=0,i=t.length,o=!1;do{-1===l(this,e=t[n]+"")&&(this.push(e),o=!0)}while(++n<i);o&&this._updateClassName()},c.remove=function(){var e,t,n=arguments,i=0,o=n.length,r=!1;do{for(t=l(this,e=n[i]+"");-1!==t;)this.splice(t,1),r=!0,t=l(this,e)}while(++i<o);r&&this._updateClassName()},c.toggle=function(e,t){e+="";var n=this.contains(e),i=n?!0!==t&&"remove":!1!==t&&"add";return i&&this[i](e),!0===t||!1===t?t:!n},c.toString=function(){return this.join(" ")},o.defineProperty){var h={get:d,enumerable:!0,configurable:!0};try{o.defineProperty(i,t,h)}catch(e){-2146823252===e.number&&(h.enumerable=!1,o.defineProperty(i,t,h))}}else o[n].__defineGetter__&&i.__defineGetter__(t,d)}}(self),function(e){if(e.URL=e.URL||e.webkitURL,e.Blob&&e.URL)try{return void new Blob}catch(e){}var t=e.BlobBuilder||e.WebKitBlobBuilder||e.MozBlobBuilder||function(e){var t=function(e){return Object.prototype.toString.call(e).match(/^\[object\s(.*)\]$/)[1]},n=function(){this.data=[]},i=function(e,t,n){this.data=e,this.size=e.length,this.type=t,this.encoding=n},o=n.prototype,r=i.prototype,a=e.FileReaderSync,s=function(e){this.code=this[this.name=e]},l="NOT_FOUND_ERR SECURITY_ERR ABORT_ERR NOT_READABLE_ERR ENCODING_ERR NO_MODIFICATION_ALLOWED_ERR INVALID_STATE_ERR SYNTAX_ERR".split(" "),u=l.length,c=e.URL||e.webkitURL||e,d=c.createObjectURL,h=c.revokeObjectURL,f=c,p=e.btoa,g=e.atob,v=e.ArrayBuffer,m=e.Uint8Array,y=/^[\w-]+:\/*\[?[\w\.:-]+\]?(?::[0-9]+)?/;for(i.fake=r.fake=!0;u--;)s.prototype[l[u]]=u+1;return c.createObjectURL||(f=e.URL=function(e){var t,n=document.createElementNS("http://www.w3.org/1999/xhtml","a");return n.href=e,"origin"in n||("data:"===n.protocol.toLowerCase()?n.origin=null:(t=e.match(y),n.origin=t&&t[1])),n}),f.createObjectURL=function(e){var t,n=e.type;return null===n&&(n="application/octet-stream"),e instanceof i?(t="data:"+n,"base64"===e.encoding?t+";base64,"+e.data:"URI"===e.encoding?t+","+decodeURIComponent(e.data):p?t+";base64,"+p(e.data):t+","+encodeURIComponent(e.data)):d?d.call(c,e):void 0},f.revokeObjectURL=function(e){"data:"!==e.substring(0,5)&&h&&h.call(c,e)},o.append=function(e){var n=this.data;if(m&&(e instanceof v||e instanceof m)){for(var o="",r=new m(e),l=0,u=r.length;l<u;l++)o+=String.fromCharCode(r[l]);n.push(o)}else if("Blob"===t(e)||"File"===t(e)){if(!a)throw new s("NOT_READABLE_ERR");var c=new a;n.push(c.readAsBinaryString(e))}else e instanceof i?"base64"===e.encoding&&g?n.push(g(e.data)):"URI"===e.encoding?n.push(decodeURIComponent(e.data)):"raw"===e.encoding&&n.push(e.data):("string"!=typeof e&&(e+=""),n.push(unescape(encodeURIComponent(e))))},o.getBlob=function(e){return arguments.length||(e=null),new i(this.data.join(""),e,"raw")},o.toString=function(){return"[object BlobBuilder]"},r.slice=function(e,t,n){var o=arguments.length;return o<3&&(n=null),new i(this.data.slice(e,o>1?t:this.data.length),n,this.encoding)},r.toString=function(){return"[object Blob]"},r.close=function(){this.size=0,delete this.data},n}(e);e.Blob=function(e,n){var i=n&&n.type||"",o=new t;if(e)for(var r=0,a=e.length;r<a;r++)Uint8Array&&e[r]instanceof Uint8Array?o.append(e[r].buffer):o.append(e[r]);var s=o.getBlob(i);return!s.slice&&s.webkitSlice&&(s.slice=s.webkitSlice),s};var n=Object.getPrototypeOf||function(e){return e.__proto__};e.Blob.prototype=n(new e.Blob)}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||cv.content||cv),function(t,n){"undefined"!=typeof process&&process&&process.versions&&process.versions.electron?t.MediumEditor=n:e.exports=n}(cv,function(){function e(e,t){return this.init(e,t)}var t,n,i,o,r,a,s,l,u,c,d;return e.extensions={},function(t){function n(e,t){var n,i=Array.prototype.slice.call(arguments,2);t=t||{};for(var o=0;o<i.length;o++){var r=i[o];if(r)for(n in r)r.hasOwnProperty(n)&&void 0!==r[n]&&(e||!1===t.hasOwnProperty(n))&&(t[n]=r[n])}return t}var i=!1;try{var o=document.createElement("div"),r=document.createTextNode(" ");o.appendChild(r),i=o.contains(r)}catch(e){}var a={isIE:"Microsoft Internet Explorer"===navigator.appName||"Netscape"===navigator.appName&&null!==new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})").exec(navigator.userAgent),isEdge:null!==/Edge\/\d+/.exec(navigator.userAgent),isFF:navigator.userAgent.toLowerCase().indexOf("firefox")>-1,isMac:t.navigator.platform.toUpperCase().indexOf("MAC")>=0,keyCode:{BACKSPACE:8,TAB:9,ENTER:13,ESCAPE:27,SPACE:32,DELETE:46,K:75,M:77,V:86},isMetaCtrlKey:function(e){return!!(a.isMac&&e.metaKey||!a.isMac&&e.ctrlKey)},isKey:function(e,t){var n=a.getKeyCode(e);return!1===Array.isArray(t)?n===t:-1!==t.indexOf(n)},getKeyCode:function(e){var t=e.which;return null===t&&(t=null!==e.charCode?e.charCode:e.keyCode),t},blockContainerElementNames:["p","h1","h2","h3","h4","h5","h6","blockquote","pre","ul","li","ol","address","article","aside","audio","canvas","dd","dl","dt","fieldset","figcaption","figure","footer","form","header","hgroup","main","nav","noscript","output","section","video","table","thead","tbody","tfoot","tr","th","td"],emptyElementNames:["br","col","colgroup","hr","img","input","source","wbr"],extend:function(){var e=[!0].concat(Array.prototype.slice.call(arguments));return n.apply(this,e)},defaults:function(){var e=[!1].concat(Array.prototype.slice.call(arguments));return n.apply(this,e)},createLink:function(e,t,n,i){var o=e.createElement("a");return a.moveTextRangeIntoElement(t[0],t[t.length-1],o),o.setAttribute("href",n),i&&("_blank"===i&&o.setAttribute("rel","noopener noreferrer"),o.setAttribute("target",i)),o},findOrCreateMatchingTextNodes:function(e,t,n){for(var i=e.createTreeWalker(t,NodeFilter.SHOW_ALL,null,!1),o=[],r=0,s=!1,l=null,u=null;null!==(l=i.nextNode());)if(!(l.nodeType>3))if(3===l.nodeType){if(!s&&n.start<r+l.nodeValue.length&&(s=!0,u=a.splitStartNodeIfNeeded(l,n.start,r)),s&&a.splitEndNodeIfNeeded(l,u,n.end,r),s&&r===n.end)break;if(s&&r>n.end+1)throw new Error("PerformLinking overshot the target!");s&&o.push(u||l),r+=l.nodeValue.length,null!==u&&(r+=u.nodeValue.length,i.nextNode()),u=null}else"img"===l.tagName.toLowerCase()&&(!s&&n.start<=r&&(s=!0),s&&o.push(l));return o},splitStartNodeIfNeeded:function(e,t,n){return t!==n?e.splitText(t-n):null},splitEndNodeIfNeeded:function(e,t,n,i){var o,r;o=i+e.nodeValue.length+(t?t.nodeValue.length:0)-1,r=n-i-(t?e.nodeValue.length:0),o>=n&&i!==o&&0!==r&&(t||e).splitText(r)},splitByBlockElements:function(t){if(3!==t.nodeType&&1!==t.nodeType)return[];var n=[],i=e.util.blockContainerElementNames.join(",");if(3===t.nodeType||0===t.querySelectorAll(i).length)return[t];for(var o=0;o<t.childNodes.length;o++){var r=t.childNodes[o];if(3===r.nodeType)n.push(r);else if(1===r.nodeType){0===r.querySelectorAll(i).length?n.push(r):n=n.concat(e.util.splitByBlockElements(r))}}return n},findAdjacentTextNodeWithContent:function(e,t,n){var i,o=!1,r=n.createNodeIterator(e,NodeFilter.SHOW_TEXT,null,!1);for(i=r.nextNode();i;){if(i===t)o=!0;else if(o&&3===i.nodeType&&i.nodeValue&&i.nodeValue.trim().length>0)break;i=r.nextNode()}return i},findPreviousSibling:function(e){if(!e||a.isMediumEditorElement(e))return!1;for(var t=e.previousSibling;!t&&!a.isMediumEditorElement(e.parentNode);)t=(e=e.parentNode).previousSibling;return t},isDescendant:function(e,t,n){if(!e||!t)return!1;if(e===t)return!!n;if(1!==e.nodeType)return!1;if(i||3!==t.nodeType)return e.contains(t);for(var o=t.parentNode;null!==o;){if(o===e)return!0;o=o.parentNode}return!1},isElement:function(e){return!(!e||1!==e.nodeType)},throttle:function(e,t){var n,i,o,r=null,a=0,s=function(){a=Date.now(),r=null,o=e.apply(n,i),r||(n=i=null)};return t||0===t||(t=50),function(){var l=Date.now(),u=t-(l-a);return n=this,i=arguments,u<=0||u>t?(r&&(clearTimeout(r),r=null),a=l,o=e.apply(n,i),r||(n=i=null)):r||(r=setTimeout(s,u)),o}},traverseUp:function(e,t){if(!e)return!1;do{if(1===e.nodeType){if(t(e))return e;if(a.isMediumEditorElement(e))return!1}e=e.parentNode}while(e);return!1},htmlEntities:function(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},insertHTMLCommand:function(t,n){var i,o,r,s,l,u,c,d=!1,h=["insertHTML",!1,n];if(!e.util.isEdge&&t.queryCommandSupported("insertHTML"))try{return t.execCommand.apply(t,h)}catch(e){}if((i=t.getSelection()).rangeCount){if(c=(o=i.getRangeAt(0)).commonAncestorContainer,a.isMediumEditorElement(c)&&!c.firstChild)o.selectNode(c.appendChild(t.createTextNode("")));else if(3===c.nodeType&&0===o.startOffset&&o.endOffset===c.nodeValue.length||3!==c.nodeType&&c.innerHTML===o.toString()){for(;!a.isMediumEditorElement(c)&&c.parentNode&&1===c.parentNode.childNodes.length&&!a.isMediumEditorElement(c.parentNode);)c=c.parentNode;o.selectNode(c)}for(o.deleteContents(),(r=t.createElement("div")).innerHTML=n,s=t.createDocumentFragment();r.firstChild;)l=r.firstChild,u=s.appendChild(l);o.insertNode(s),u&&((o=o.cloneRange()).setStartAfter(u),o.collapse(!0),e.selection.selectRange(t,o)),d=!0}return t.execCommand.callListeners&&t.execCommand.callListeners(h,d),d},execFormatBlock:function(t,n){var i=a.getTopBlockContainer(e.selection.getSelectionStart(t));if("blockquote"===n){if(i&&Array.prototype.slice.call(i.childNodes).some((function(e){return a.isBlockContainer(e)})))return t.execCommand("outdent",!1,null);if(a.isIE)return t.execCommand("indent",!1,n)}if(i&&n===i.nodeName.toLowerCase()&&(n="p"),a.isIE&&(n="<"+n+">"),i&&"blockquote"===i.nodeName.toLowerCase()){if(a.isIE&&"<p>"===n)return t.execCommand("outdent",!1,n);if((a.isFF||a.isEdge)&&"p"===n)return Array.prototype.slice.call(i.childNodes).some((function(e){return!a.isBlockContainer(e)}))&&t.execCommand("formatBlock",!1,n),t.execCommand("outdent",!1,n)}return t.execCommand("formatBlock",!1,n)},setTargetBlank:function(e,t){var n,i=t||!1;if("a"===e.nodeName.toLowerCase())e.target="_blank",e.rel="noopener noreferrer";else for(e=e.getElementsByTagName("a"),n=0;n<e.length;n+=1)!1!==i&&i!==e[n].attributes.href.value||(e[n].target="_blank",e[n].rel="noopener noreferrer")},removeTargetBlank:function(e,t){var n;if("a"===e.nodeName.toLowerCase())e.removeAttribute("target"),e.removeAttribute("rel");else for(e=e.getElementsByTagName("a"),n=0;n<e.length;n+=1)t===e[n].attributes.href.value&&(e[n].removeAttribute("target"),e[n].removeAttribute("rel"))},addClassToAnchors:function(e,t){var n,i,o=t.split(" ");if("a"===e.nodeName.toLowerCase())for(i=0;i<o.length;i+=1)e.classList.add(o[i]);else{var r=e.getElementsByTagName("a");if(0===r.length){var s=a.getClosestTag(e,"a");e=s?[s]:[]}else e=r;for(n=0;n<e.length;n+=1)for(i=0;i<o.length;i+=1)e[n].classList.add(o[i])}},isListItem:function(e){if(!e)return!1;if("li"===e.nodeName.toLowerCase())return!0;for(var t=e.parentNode,n=t.nodeName.toLowerCase();"li"===n||!a.isBlockContainer(t)&&"div"!==n;){if("li"===n)return!0;if(!(t=t.parentNode))return!1;n=t.nodeName.toLowerCase()}return!1},cleanListDOM:function(t,n){if("li"===n.nodeName.toLowerCase()){var i=n.parentElement;"p"===i.parentElement.nodeName.toLowerCase()&&(a.unwrap(i.parentElement,t),e.selection.moveCursor(t,n.firstChild,n.firstChild.textContent.length))}},splitOffDOMTree:function(e,t,n){for(var i=t,o=null,r=!n;i!==e;){var a,s=i.parentNode,l=s.cloneNode(!1),u=r?i:s.firstChild;for(o&&(r?l.appendChild(o):a=o),o=l;u;){var c=u.nextSibling;u===i?(u.hasChildNodes()?u=u.cloneNode(!1):u.parentNode.removeChild(u),u.textContent&&o.appendChild(u),u=r?c:null):(u.parentNode.removeChild(u),(u.hasChildNodes()||u.textContent)&&o.appendChild(u),u=c)}a&&o.appendChild(a),i=s}return o},moveTextRangeIntoElement:function(e,t,n){if(!e||!t)return!1;var i=a.findCommonRoot(e,t);if(!i)return!1;if(t===e){var o=e.parentNode,r=e.nextSibling;return o.removeChild(e),n.appendChild(e),r?o.insertBefore(n,r):o.appendChild(n),n.hasChildNodes()}for(var s,l,u,c=[],d=0;d<i.childNodes.length;d++)if(u=i.childNodes[d],s){if(a.isDescendant(u,t,!0)){l=u;break}c.push(u)}else a.isDescendant(u,e,!0)&&(s=u);var h=l.nextSibling,f=i.ownerDocument.createDocumentFragment();return s===e?(s.parentNode.removeChild(s),f.appendChild(s)):f.appendChild(a.splitOffDOMTree(s,e)),c.forEach((function(e){e.parentNode.removeChild(e),f.appendChild(e)})),l===t?(l.parentNode.removeChild(l),f.appendChild(l)):f.appendChild(a.splitOffDOMTree(l,t,!0)),n.appendChild(f),l.parentNode===i?i.insertBefore(n,l):h?i.insertBefore(n,h):i.appendChild(n),n.hasChildNodes()},depthOfNode:function(e){for(var t=0,n=e;null!==n.parentNode;)n=n.parentNode,t++;return t},findCommonRoot:function(e,t){for(var n=a.depthOfNode(e),i=a.depthOfNode(t),o=e,r=t;n!==i;)n>i?(o=o.parentNode,n-=1):(r=r.parentNode,i-=1);for(;o!==r;)o=o.parentNode,r=r.parentNode;return o},isElementAtBeginningOfBlock:function(e){for(var t;!a.isBlockContainer(e)&&!a.isMediumEditorElement(e);){for(t=e;t=t.previousSibling;)if((3===t.nodeType?t.nodeValue:t.textContent).length>0)return!1;e=e.parentNode}return!0},isMediumEditorElement:function(e){return e&&e.getAttribute&&!!e.getAttribute("data-medium-editor-element")},getContainerEditorElement:function(e){return a.traverseUp(e,(function(e){return a.isMediumEditorElement(e)}))},isBlockContainer:function(e){return e&&3!==e.nodeType&&-1!==a.blockContainerElementNames.indexOf(e.nodeName.toLowerCase())},getClosestBlockContainer:function(e){return a.traverseUp(e,(function(e){return a.isBlockContainer(e)||a.isMediumEditorElement(e)}))},getTopBlockContainer:function(e){var t=!!a.isBlockContainer(e)&&e;return a.traverseUp(e,(function(e){return a.isBlockContainer(e)&&(t=e),!(t||!a.isMediumEditorElement(e))&&(t=e,!0)})),t},getFirstSelectableLeafNode:function(e){for(;e&&e.firstChild;)e=e.firstChild;if("table"===(e=a.traverseUp(e,(function(e){return-1===a.emptyElementNames.indexOf(e.nodeName.toLowerCase())}))).nodeName.toLowerCase()){var t=e.querySelector("th, td");t&&(e=t)}return e},getFirstTextNode:function(e){return a.warn("getFirstTextNode is deprecated and will be removed in version 6.0.0"),a._getFirstTextNode(e)},_getFirstTextNode:function(e){if(3===e.nodeType)return e;for(var t=0;t<e.childNodes.length;t++){var n=a._getFirstTextNode(e.childNodes[t]);if(null!==n)return n}return null},ensureUrlHasProtocol:function(e){return-1===e.indexOf("://")?"http://"+e:e},warn:function(){void 0!==t.console&&"function"==typeof t.console.warn&&t.console.warn.apply(t.console,arguments)},deprecated:function(e,t,n){var i=e+" is deprecated, please use "+t+" instead.";n&&(i+=" Will be removed in "+n),a.warn(i)},deprecatedMethod:function(e,t,n,i){a.deprecated(e,t,i),"function"==typeof this[t]&&this[t].apply(this,n)},cleanupAttrs:function(e,t){t.forEach((function(t){e.removeAttribute(t)}))},cleanupTags:function(e,t){-1!==t.indexOf(e.nodeName.toLowerCase())&&e.parentNode.removeChild(e)},unwrapTags:function(t,n){-1!==n.indexOf(t.nodeName.toLowerCase())&&e.util.unwrap(t,document)},getClosestTag:function(e,t){return a.traverseUp(e,(function(e){return e.nodeName.toLowerCase()===t.toLowerCase()}))},unwrap:function(e,t){for(var n=t.createDocumentFragment(),i=Array.prototype.slice.call(e.childNodes),o=0;o<i.length;o++)n.appendChild(i[o]);n.childNodes.length?e.parentNode.replaceChild(n,e):e.parentNode.removeChild(e)},guid:function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}};e.util=a}(window),(t=function(t){e.util.extend(this,t)}).extend=function(t){var n,i=this;n=t&&t.hasOwnProperty("constructor")?t.constructor:function(){return i.apply(this,arguments)},e.util.extend(n,i);var o=function(){this.constructor=n};return o.prototype=i.prototype,n.prototype=new o,t&&e.util.extend(n.prototype,t),n},t.prototype={init:function(){},base:void 0,name:void 0,checkState:void 0,destroy:void 0,queryCommandState:void 0,isActive:void 0,isAlreadyApplied:void 0,setActive:void 0,setInactive:void 0,getInteractionElements:void 0,window:void 0,document:void 0,getEditorElements:function(){return this.base.elements},getEditorId:function(){return this.base.id},getEditorOption:function(e){return this.base.options[e]}},["execAction","on","off","subscribe","trigger"].forEach((function(e){t.prototype[e]=function(){return this.base[e].apply(this.base,arguments)}})),e.Extension=t,function(){function t(t){return e.util.isBlockContainer(t)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}var n={findMatchingSelectionParent:function(t,n){var i,o=n.getSelection();return 0!==o.rangeCount&&(i=o.getRangeAt(0).commonAncestorContainer,e.util.traverseUp(i,t))},getSelectionElement:function(t){return this.findMatchingSelectionParent((function(t){return e.util.isMediumEditorElement(t)}),t)},exportSelection:function(e,t){if(!e)return null;var n=null,i=t.getSelection();if(i.rangeCount>0){var o,r=i.getRangeAt(0),a=r.cloneRange();a.selectNodeContents(e),a.setEnd(r.startContainer,r.startOffset),n={start:o=a.toString().length,end:o+r.toString().length},this.doesRangeStartWithImages(r,t)&&(n.startsWithImage=!0);var s=this.getTrailingImageCount(e,n,r.endContainer,r.endOffset);if(s&&(n.trailingImageCount=s),0!==o){var l=this.getIndexRelativeToAdjacentEmptyBlocks(t,e,r.startContainer,r.startOffset);-1!==l&&(n.emptyBlocksIndex=l)}}return n},importSelection:function(e,t,n,i){if(e&&t){var o=n.createRange();o.setStart(t,0),o.collapse(!0);var r,a=t,s=[],l=0,u=!1,c=!1,d=0,h=!1,f=!1,p=null;for((i||e.startsWithImage||void 0!==e.emptyBlocksIndex)&&(f=!0);!h&&a;)if(a.nodeType>3)a=s.pop();else{if(3!==a.nodeType||c){if(e.trailingImageCount&&c&&("img"===a.nodeName.toLowerCase()&&d++,d===e.trailingImageCount)){for(var g=0;a.parentNode.childNodes[g]!==a;)g++;o.setEnd(a.parentNode,g+1),h=!0}if(!h&&1===a.nodeType)for(var v=a.childNodes.length-1;v>=0;)s.push(a.childNodes[v]),v-=1}else r=l+a.length,!u&&e.start>=l&&e.start<=r&&(f||e.start<r?(o.setStart(a,e.start-l),u=!0):p=a),u&&e.end>=l&&e.end<=r&&(e.trailingImageCount?c=!0:(o.setEnd(a,e.end-l),h=!0)),l=r;h||(a=s.pop())}!u&&p&&(o.setStart(p,p.length),o.setEnd(p,p.length)),void 0!==e.emptyBlocksIndex&&(o=this.importSelectionMoveCursorPastBlocks(n,t,e.emptyBlocksIndex,o)),i&&(o=this.importSelectionMoveCursorPastAnchor(e,o)),this.selectRange(n,o)}},importSelectionMoveCursorPastAnchor:function(t,n){if(t.start===t.end&&3===n.startContainer.nodeType&&n.startOffset===n.startContainer.nodeValue.length&&e.util.traverseUp(n.startContainer,(function(e){return"a"===e.nodeName.toLowerCase()}))){for(var i=n.startContainer,o=n.startContainer.parentNode;null!==o&&"a"!==o.nodeName.toLowerCase();)o.childNodes[o.childNodes.length-1]!==i?o=null:(i=o,o=o.parentNode);if(null!==o&&"a"===o.nodeName.toLowerCase()){for(var r=null,a=0;null===r&&a<o.parentNode.childNodes.length;a++)o.parentNode.childNodes[a]===o&&(r=a);n.setStart(o.parentNode,r+1),n.collapse(!0)}}return n},importSelectionMoveCursorPastBlocks:function(n,i,o,r){var a,s,l=n.createTreeWalker(i,NodeFilter.SHOW_ELEMENT,t,!1),u=r.startContainer,c=0;for(o=o||1,a=3===u.nodeType&&e.util.isBlockContainer(u.previousSibling)?u.previousSibling:e.util.getClosestBlockContainer(u);l.nextNode();)if(s){if(s=l.currentNode,++c===o)break;if(s.textContent.length>0)break}else a===l.currentNode&&(s=l.currentNode);return s||(s=a),r.setStart(e.util.getFirstSelectableLeafNode(s),0),r},getIndexRelativeToAdjacentEmptyBlocks:function(n,i,o,r){if(o.textContent.length>0&&r>0)return-1;var a=o;if(3!==a.nodeType&&(a=o.childNodes[r]),a){if(!e.util.isElementAtBeginningOfBlock(a))return-1;var s=e.util.findPreviousSibling(a);if(!s)return-1;if(s.nodeValue)return-1}for(var l=e.util.getClosestBlockContainer(o),u=n.createTreeWalker(i,NodeFilter.SHOW_ELEMENT,t,!1),c=0;u.nextNode();){var d=""===u.currentNode.textContent;if((d||c>0)&&(c+=1),u.currentNode===l)return c;d||(c=0)}return c},doesRangeStartWithImages:function(e,t){if(0!==e.startOffset||1!==e.startContainer.nodeType)return!1;if("img"===e.startContainer.nodeName.toLowerCase())return!0;var n=e.startContainer.querySelector("img");if(!n)return!1;for(var i=t.createTreeWalker(e.startContainer,NodeFilter.SHOW_ALL,null,!1);i.nextNode();){var o=i.currentNode;if(o===n)break;if(o.nodeValue)return!1}return!0},getTrailingImageCount:function(e,t,n,i){if(0===i||1!==n.nodeType)return 0;if("img"!==n.nodeName.toLowerCase()&&!n.querySelector("img"))return 0;for(var o=n.childNodes[i-1];o.hasChildNodes();)o=o.lastChild;for(var r,a=e,s=[],l=0,u=!1,c=!1,d=!1,h=0;!d&&a;)if(a.nodeType>3)a=s.pop();else{if(3!==a.nodeType||c){if("img"===a.nodeName.toLowerCase()&&h++,a===o)d=!0;else if(1===a.nodeType)for(var f=a.childNodes.length-1;f>=0;)s.push(a.childNodes[f]),f-=1}else h=0,r=l+a.length,!u&&t.start>=l&&t.start<=r&&(u=!0),u&&t.end>=l&&t.end<=r&&(c=!0),l=r;d||(a=s.pop())}return h},selectionContainsContent:function(e){var t=e.getSelection();if(!t||t.isCollapsed||!t.rangeCount)return!1;if(""!==t.toString().trim())return!0;var n=this.getSelectedParentElement(t.getRangeAt(0));return!(!n||!("img"===n.nodeName.toLowerCase()||1===n.nodeType&&n.querySelector("img")))},selectionInContentEditableFalse:function(e){var t,n=this.findMatchingSelectionParent((function(e){var n=e&&e.getAttribute("contenteditable");return"true"===n&&(t=!0),"#text"!==e.nodeName&&"false"===n}),e);return!t&&n},getSelectionHtml:function(e){var t,n,i,o="",r=e.getSelection();if(r.rangeCount){for(i=e.createElement("div"),t=0,n=r.rangeCount;t<n;t+=1)i.appendChild(r.getRangeAt(t).cloneContents());o=i.innerHTML}return o},getCaretOffsets:function(e,t){var n,i;return t||(t=window.getSelection().getRangeAt(0)),n=t.cloneRange(),i=t.cloneRange(),n.selectNodeContents(e),n.setEnd(t.endContainer,t.endOffset),i.selectNodeContents(e),i.setStart(t.endContainer,t.endOffset),{left:n.toString().length,right:i.toString().length}},rangeSelectsSingleNode:function(e){var t=e.startContainer;return t===e.endContainer&&t.hasChildNodes()&&e.endOffset===e.startOffset+1},getSelectedParentElement:function(e){return e?this.rangeSelectsSingleNode(e)&&3!==e.startContainer.childNodes[e.startOffset].nodeType?e.startContainer.childNodes[e.startOffset]:3===e.startContainer.nodeType?e.startContainer.parentNode:e.startContainer:null},getSelectedElements:function(e){var t,n,i,o=e.getSelection();if(!o.rangeCount||o.isCollapsed||!o.getRangeAt(0).commonAncestorContainer)return[];if(3===(t=o.getRangeAt(0)).commonAncestorContainer.nodeType){for(n=[],i=t.commonAncestorContainer;i.parentNode&&1===i.parentNode.childNodes.length;)n.push(i.parentNode),i=i.parentNode;return n}return[].filter.call(t.commonAncestorContainer.getElementsByTagName("*"),(function(e){return"function"!=typeof o.containsNode||o.containsNode(e,!0)}))},selectNode:function(e,t){var n=t.createRange();n.selectNodeContents(e),this.selectRange(t,n)},select:function(e,t,n,i,o){var r=e.createRange();return r.setStart(t,n),i?r.setEnd(i,o):r.collapse(!0),this.selectRange(e,r),r},clearSelection:function(e,t){t?e.getSelection().collapseToStart():e.getSelection().collapseToEnd()},moveCursor:function(e,t,n){this.select(e,t,n)},getSelectionRange:function(e){var t=e.getSelection();return 0===t.rangeCount?null:t.getRangeAt(0)},selectRange:function(e,t){var n=e.getSelection();n.removeAllRanges(),n.addRange(t)},getSelectionStart:function(e){var t=e.getSelection().anchorNode;return t&&3===t.nodeType?t.parentNode:t}};e.selection=n}(),function(){function t(t,n){return!!t&&t.some((function(t){if("function"!=typeof t.getInteractionElements)return!1;var i=t.getInteractionElements();return!!i&&(Array.isArray(i)||(i=[i]),i.some((function(t){return e.util.isDescendant(t,n,!0)})))}))}var n=function(e){this.base=e,this.options=this.base.options,this.events=[],this.disabledEvents={},this.customEvents={},this.listeners={}};n.prototype={InputEventOnContenteditableSupported:!e.util.isIE&&!e.util.isEdge,attachDOMEvent:function(t,n,i,o){var r=this.base.options.contentWindow,a=this.base.options.ownerDocument;t=e.util.isElement(t)||[r,a].indexOf(t)>-1?[t]:t,Array.prototype.forEach.call(t,function(e){e.addEventListener(n,i,o),this.events.push([e,n,i,o])}.bind(this))},detachDOMEvent:function(t,n,i,o){var r,a,s=this.base.options.contentWindow,l=this.base.options.ownerDocument;t&&(t=e.util.isElement(t)||[s,l].indexOf(t)>-1?[t]:t,Array.prototype.forEach.call(t,function(e){-1!==(r=this.indexOfListener(e,n,i,o))&&(a=this.events.splice(r,1)[0])[0].removeEventListener(a[1],a[2],a[3])}.bind(this)))},indexOfListener:function(e,t,n,i){var o,r,a;for(o=0,r=this.events.length;o<r;o+=1)if((a=this.events[o])[0]===e&&a[1]===t&&a[2]===n&&a[3]===i)return o;return-1},detachAllDOMEvents:function(){for(var e=this.events.pop();e;)e[0].removeEventListener(e[1],e[2],e[3]),e=this.events.pop()},detachAllEventsFromElement:function(e){for(var t=this.events.filter((function(t){return t&&t[0].getAttribute&&t[0].getAttribute("medium-editor-index")===e.getAttribute("medium-editor-index")})),n=0,i=t.length;n<i;n++){var o=t[n];this.detachDOMEvent(o[0],o[1],o[2],o[3])}},attachAllEventsToElement:function(e){this.listeners.editableInput&&(this.contentCache[e.getAttribute("medium-editor-index")]=e.innerHTML),this.eventsCache&&this.eventsCache.forEach((function(t){this.attachDOMEvent(e,t.name,t.handler.bind(this))}),this)},enableCustomEvent:function(e){void 0!==this.disabledEvents[e]&&delete this.disabledEvents[e]},disableCustomEvent:function(e){this.disabledEvents[e]=!0},attachCustomEvent:function(e,t){this.setupListener(e),this.customEvents[e]||(this.customEvents[e]=[]),this.customEvents[e].push(t)},detachCustomEvent:function(e,t){var n=this.indexOfCustomListener(e,t);-1!==n&&this.customEvents[e].splice(n,1)},indexOfCustomListener:function(e,t){return this.customEvents[e]&&this.customEvents[e].length?this.customEvents[e].indexOf(t):-1},detachAllCustomEvents:function(){this.customEvents={}},triggerCustomEvent:function(e,t,n){this.customEvents[e]&&!this.disabledEvents[e]&&this.customEvents[e].forEach((function(e){e(t,n)}))},destroy:function(){this.detachAllDOMEvents(),this.detachAllCustomEvents(),this.detachExecCommand(),this.base.elements&&this.base.elements.forEach((function(e){e.removeAttribute("data-medium-focused")}))},attachToExecCommand:function(){this.execCommandListener||(this.execCommandListener=function(e){this.handleDocumentExecCommand(e)}.bind(this),this.wrapExecCommand(),this.options.ownerDocument.execCommand.listeners.push(this.execCommandListener))},detachExecCommand:function(){var e=this.options.ownerDocument;if(this.execCommandListener&&e.execCommand.listeners){var t=e.execCommand.listeners.indexOf(this.execCommandListener);-1!==t&&e.execCommand.listeners.splice(t,1),e.execCommand.listeners.length||this.unwrapExecCommand()}},wrapExecCommand:function(){var e=this.options.ownerDocument;if(!e.execCommand.listeners){var t=function(t,n){e.execCommand.listeners&&e.execCommand.listeners.forEach((function(e){e({command:t[0],value:t[2],args:t,result:n})}))},n=function(){var n=e.execCommand.orig.apply(this,arguments);if(!e.execCommand.listeners)return n;var i=Array.prototype.slice.call(arguments);return t(i,n),n};n.orig=e.execCommand,n.listeners=[],n.callListeners=t,e.execCommand=n}},unwrapExecCommand:function(){var e=this.options.ownerDocument;e.execCommand.orig&&(e.execCommand=e.execCommand.orig)},setupListener:function(e){if(!this.listeners[e]){switch(e){case"externalInteraction":this.attachDOMEvent(this.options.ownerDocument.body,"mousedown",this.handleBodyMousedown.bind(this),!0),this.attachDOMEvent(this.options.ownerDocument.body,"click",this.handleBodyClick.bind(this),!0),this.attachDOMEvent(this.options.ownerDocument.body,"focus",this.handleBodyFocus.bind(this),!0);break;case"blur":case"focus":this.setupListener("externalInteraction");break;case"editableInput":this.contentCache={},this.base.elements.forEach((function(e){this.contentCache[e.getAttribute("medium-editor-index")]=e.innerHTML}),this),this.InputEventOnContenteditableSupported&&this.attachToEachElement("input",this.handleInput),this.InputEventOnContenteditableSupported||(this.setupListener("editableKeypress"),this.keypressUpdateInput=!0,this.attachDOMEvent(document,"selectionchange",this.handleDocumentSelectionChange.bind(this)),this.attachToExecCommand());break;case"editableClick":this.attachToEachElement("click",this.handleClick);break;case"editableBlur":this.attachToEachElement("blur",this.handleBlur);break;case"editableKeypress":this.attachToEachElement("keypress",this.handleKeypress);break;case"editableKeyup":this.attachToEachElement("keyup",this.handleKeyup);break;case"editableKeydown":this.attachToEachElement("keydown",this.handleKeydown);break;case"editableKeydownSpace":case"editableKeydownEnter":case"editableKeydownTab":case"editableKeydownDelete":this.setupListener("editableKeydown");break;case"editableMouseover":this.attachToEachElement("mouseover",this.handleMouseover);break;case"editableDrag":this.attachToEachElement("dragover",this.handleDragging),this.attachToEachElement("dragleave",this.handleDragging);break;case"editableDrop":this.attachToEachElement("drop",this.handleDrop);break;case"editablePaste":this.attachToEachElement("paste",this.handlePaste)}this.listeners[e]=!0}},attachToEachElement:function(e,t){this.eventsCache||(this.eventsCache=[]),this.base.elements.forEach((function(n){this.attachDOMEvent(n,e,t.bind(this))}),this),this.eventsCache.push({name:e,handler:t})},cleanupElement:function(e){var t=e.getAttribute("medium-editor-index");t&&(this.detachAllEventsFromElement(e),this.contentCache&&delete this.contentCache[t])},focusElement:function(e){e.focus(),this.updateFocus(e,{target:e,type:"focus"})},updateFocus:function(n,i){var o,r=this.base.getFocusedElement();r&&"click"===i.type&&this.lastMousedownTarget&&(e.util.isDescendant(r,this.lastMousedownTarget,!0)||t(this.base.extensions,this.lastMousedownTarget))&&(o=r),o||this.base.elements.some((function(t){return!o&&e.util.isDescendant(t,n,!0)&&(o=t),!!o}),this);var a=!e.util.isDescendant(r,n,!0)&&!t(this.base.extensions,n);o!==r&&(r&&a&&(r.removeAttribute("data-medium-focused"),this.triggerCustomEvent("blur",i,r)),o&&(o.setAttribute("data-medium-focused",!0),this.triggerCustomEvent("focus",i,o))),a&&this.triggerCustomEvent("externalInteraction",i)},updateInput:function(e,t){if(this.contentCache){var n=e.getAttribute("medium-editor-index"),i=e.innerHTML;i!==this.contentCache[n]&&this.triggerCustomEvent("editableInput",t,e),this.contentCache[n]=i}},handleDocumentSelectionChange:function(t){if(t.currentTarget&&t.currentTarget.activeElement){var n,i=t.currentTarget.activeElement;this.base.elements.some((function(t){return!!e.util.isDescendant(t,i,!0)&&(n=t,!0)}),this),n&&this.updateInput(n,{target:i,currentTarget:n})}},handleDocumentExecCommand:function(){var e=this.base.getFocusedElement();e&&this.updateInput(e,{target:e,currentTarget:e})},handleBodyClick:function(e){this.updateFocus(e.target,e)},handleBodyFocus:function(e){this.updateFocus(e.target,e)},handleBodyMousedown:function(e){this.lastMousedownTarget=e.target},handleInput:function(e){this.updateInput(e.currentTarget,e)},handleClick:function(e){this.triggerCustomEvent("editableClick",e,e.currentTarget)},handleBlur:function(e){this.triggerCustomEvent("editableBlur",e,e.currentTarget)},handleKeypress:function(e){if(this.triggerCustomEvent("editableKeypress",e,e.currentTarget),this.keypressUpdateInput){var t={target:e.target,currentTarget:e.currentTarget};setTimeout(function(){this.updateInput(t.currentTarget,t)}.bind(this),0)}},handleKeyup:function(e){this.triggerCustomEvent("editableKeyup",e,e.currentTarget)},handleMouseover:function(e){this.triggerCustomEvent("editableMouseover",e,e.currentTarget)},handleDragging:function(e){this.triggerCustomEvent("editableDrag",e,e.currentTarget)},handleDrop:function(e){this.triggerCustomEvent("editableDrop",e,e.currentTarget)},handlePaste:function(e){this.triggerCustomEvent("editablePaste",e,e.currentTarget)},handleKeydown:function(t){return this.triggerCustomEvent("editableKeydown",t,t.currentTarget),e.util.isKey(t,e.util.keyCode.SPACE)?this.triggerCustomEvent("editableKeydownSpace",t,t.currentTarget):e.util.isKey(t,e.util.keyCode.ENTER)||t.ctrlKey&&e.util.isKey(t,e.util.keyCode.M)?this.triggerCustomEvent("editableKeydownEnter",t,t.currentTarget):e.util.isKey(t,e.util.keyCode.TAB)?this.triggerCustomEvent("editableKeydownTab",t,t.currentTarget):e.util.isKey(t,[e.util.keyCode.DELETE,e.util.keyCode.BACKSPACE])?this.triggerCustomEvent("editableKeydownDelete",t,t.currentTarget):void 0}},e.Events=n}(),n=e.Extension.extend({action:void 0,aria:void 0,tagNames:void 0,style:void 0,useQueryState:void 0,contentDefault:void 0,contentFA:void 0,classList:void 0,attrs:void 0,constructor:function(t){n.isBuiltInButton(t)?e.Extension.call(this,this.defaults[t]):e.Extension.call(this,t)},init:function(){e.Extension.prototype.init.apply(this,arguments),this.button=this.createButton(),this.on(this.button,"click",this.handleClick.bind(this))},getButton:function(){return this.button},getAction:function(){return"function"==typeof this.action?this.action(this.base.options):this.action},getAria:function(){return"function"==typeof this.aria?this.aria(this.base.options):this.aria},getTagNames:function(){return"function"==typeof this.tagNames?this.tagNames(this.base.options):this.tagNames},createButton:function(){var e=this.document.createElement("button"),t=this.contentDefault,n=this.getAria(),i=this.getEditorOption("buttonLabels");return e.classList.add("medium-editor-action"),e.classList.add("medium-editor-action-"+this.name),this.classList&&this.classList.forEach((function(t){e.classList.add(t)})),e.setAttribute("data-action",this.getAction()),n&&(e.setAttribute("title",n),e.setAttribute("aria-label",n)),this.attrs&&Object.keys(this.attrs).forEach((function(t){e.setAttribute(t,this.attrs[t])}),this),"fontawesome"===i&&this.contentFA&&(t=this.contentFA),e.innerHTML=t,e},handleClick:function(e){e.preventDefault(),e.stopPropagation();var t=this.getAction();t&&this.execAction(t)},isActive:function(){return this.button.classList.contains(this.getEditorOption("activeButtonClass"))},setInactive:function(){this.button.classList.remove(this.getEditorOption("activeButtonClass")),delete this.knownState},setActive:function(){this.button.classList.add(this.getEditorOption("activeButtonClass")),delete this.knownState},queryCommandState:function(){var e=null;return this.useQueryState&&(e=this.base.queryCommandState(this.getAction())),e},isAlreadyApplied:function(e){var t,n,i=!1,o=this.getTagNames();return!1===this.knownState||!0===this.knownState?this.knownState:(o&&o.length>0&&(i=-1!==o.indexOf(e.nodeName.toLowerCase())),!i&&this.style&&(t=this.style.value.split("|"),n=this.window.getComputedStyle(e,null).getPropertyValue(this.style.prop),t.forEach((function(e){this.knownState||((i=-1!==n.indexOf(e))||"text-decoration"!==this.style.prop)&&(this.knownState=i)}),this)),i)}}),n.isBuiltInButton=function(t){return"string"==typeof t&&e.extensions.button.prototype.defaults.hasOwnProperty(t)},e.extensions.button=n,e.extensions.button.prototype.defaults={bold:{name:"bold",action:"bold",aria:"bold",tagNames:["b","strong"],style:{prop:"font-weight",value:"700|bold"},useQueryState:!0,contentDefault:"<b>B</b>",contentFA:'<i class="fa fa-bold"></i>'},italic:{name:"italic",action:"italic",aria:"italic",tagNames:["i","em"],style:{prop:"font-style",value:"italic"},useQueryState:!0,contentDefault:"<b><i>I</i></b>",contentFA:'<i class="fa fa-italic"></i>'},underline:{name:"underline",action:"underline",aria:"underline",tagNames:["u"],style:{prop:"text-decoration",value:"underline"},useQueryState:!0,contentDefault:"<b><u>U</u></b>",contentFA:'<i class="fa fa-underline"></i>'},strikethrough:{name:"strikethrough",action:"strikethrough",aria:"strike through",tagNames:["strike"],style:{prop:"text-decoration",value:"line-through"},useQueryState:!0,contentDefault:"<s>A</s>",contentFA:'<i class="fa fa-strikethrough"></i>'},superscript:{name:"superscript",action:"superscript",aria:"superscript",tagNames:["sup"],contentDefault:"<b>x<sup>1</sup></b>",contentFA:'<i class="fa fa-superscript"></i>'},subscript:{name:"subscript",action:"subscript",aria:"subscript",tagNames:["sub"],contentDefault:"<b>x<sub>1</sub></b>",contentFA:'<i class="fa fa-subscript"></i>'},image:{name:"image",action:"image",aria:"image",tagNames:["img"],contentDefault:"<b>image</b>",contentFA:'<i class="fa fa-picture-o"></i>'},html:{name:"html",action:"html",aria:"evaluate html",tagNames:["iframe","object"],contentDefault:"<b>html</b>",contentFA:'<i class="fa fa-code"></i>'},orderedlist:{name:"orderedlist",action:"insertorderedlist",aria:"ordered list",tagNames:["ol"],useQueryState:!0,contentDefault:"<b>1.</b>",contentFA:'<i class="fa fa-list-ol"></i>'},unorderedlist:{name:"unorderedlist",action:"insertunorderedlist",aria:"unordered list",tagNames:["ul"],useQueryState:!0,contentDefault:"<b>&bull;</b>",contentFA:'<i class="fa fa-list-ul"></i>'},indent:{name:"indent",action:"indent",aria:"indent",tagNames:[],contentDefault:"<b>&rarr;</b>",contentFA:'<i class="fa fa-indent"></i>'},outdent:{name:"outdent",action:"outdent",aria:"outdent",tagNames:[],contentDefault:"<b>&larr;</b>",contentFA:'<i class="fa fa-outdent"></i>'},justifyCenter:{name:"justifyCenter",action:"justifyCenter",aria:"center justify",tagNames:[],style:{prop:"text-align",value:"center"},contentDefault:"<b>C</b>",contentFA:'<i class="fa fa-align-center"></i>'},justifyFull:{name:"justifyFull",action:"justifyFull",aria:"full justify",tagNames:[],style:{prop:"text-align",value:"justify"},contentDefault:"<b>J</b>",contentFA:'<i class="fa fa-align-justify"></i>'},justifyLeft:{name:"justifyLeft",action:"justifyLeft",aria:"left justify",tagNames:[],style:{prop:"text-align",value:"left"},contentDefault:"<b>L</b>",contentFA:'<i class="fa fa-align-left"></i>'},justifyRight:{name:"justifyRight",action:"justifyRight",aria:"right justify",tagNames:[],style:{prop:"text-align",value:"right"},contentDefault:"<b>R</b>",contentFA:'<i class="fa fa-align-right"></i>'},removeFormat:{name:"removeFormat",aria:"remove formatting",action:"removeFormat",contentDefault:"<b>X</b>",contentFA:'<i class="fa fa-eraser"></i>'},quote:{name:"quote",action:"append-blockquote",aria:"blockquote",tagNames:["blockquote"],contentDefault:"<b>&ldquo;</b>",contentFA:'<i class="fa fa-quote-right"></i>'},pre:{name:"pre",action:"append-pre",aria:"preformatted text",tagNames:["pre"],contentDefault:"<b>0101</b>",contentFA:'<i class="fa fa-code fa-lg"></i>'},h1:{name:"h1",action:"append-h1",aria:"header type one",tagNames:["h1"],contentDefault:"<b>H1</b>",contentFA:'<i class="fa fa-header"><sup>1</sup>'},h2:{name:"h2",action:"append-h2",aria:"header type two",tagNames:["h2"],contentDefault:"<b>H2</b>",contentFA:'<i class="fa fa-header"><sup>2</sup>'},h3:{name:"h3",action:"append-h3",aria:"header type three",tagNames:["h3"],contentDefault:"<b>H3</b>",contentFA:'<i class="fa fa-header"><sup>3</sup>'},h4:{name:"h4",action:"append-h4",aria:"header type four",tagNames:["h4"],contentDefault:"<b>H4</b>",contentFA:'<i class="fa fa-header"><sup>4</sup>'},h5:{name:"h5",action:"append-h5",aria:"header type five",tagNames:["h5"],contentDefault:"<b>H5</b>",contentFA:'<i class="fa fa-header"><sup>5</sup>'},h6:{name:"h6",action:"append-h6",aria:"header type six",tagNames:["h6"],contentDefault:"<b>H6</b>",contentFA:'<i class="fa fa-header"><sup>6</sup>'}},i=e.extensions.button.extend({init:function(){e.extensions.button.prototype.init.apply(this,arguments)},formSaveLabel:"&#10003;",formCloseLabel:"&times;",activeClass:"medium-editor-toolbar-form-active",hasForm:!0,getForm:function(){},isDisplayed:function(){return!!this.hasForm&&this.getForm().classList.contains(this.activeClass)},showForm:function(){this.hasForm&&this.getForm().classList.add(this.activeClass)},hideForm:function(){this.hasForm&&this.getForm().classList.remove(this.activeClass)},showToolbarDefaultActions:function(){var e=this.base.getExtensionByName("toolbar");e&&e.showToolbarDefaultActions()},hideToolbarDefaultActions:function(){var e=this.base.getExtensionByName("toolbar");e&&e.hideToolbarDefaultActions()},setToolbarPosition:function(){var e=this.base.getExtensionByName("toolbar");e&&e.setToolbarPosition()}}),e.extensions.form=i,o=e.extensions.form.extend({customClassOption:null,customClassOptionText:"Button",linkValidation:!1,placeholderText:"Paste or type a link",targetCheckbox:!1,targetCheckboxText:"Open in new window",name:"anchor",action:"createLink",aria:"link",tagNames:["a"],contentDefault:"<b>#</b>",contentFA:'<i class="fa fa-link"></i>',init:function(){e.extensions.form.prototype.init.apply(this,arguments),this.subscribe("editableKeydown",this.handleKeydown.bind(this))},handleClick:function(t){t.preventDefault(),t.stopPropagation();var n=e.selection.getSelectionRange(this.document);return"a"===n.startContainer.nodeName.toLowerCase()||"a"===n.endContainer.nodeName.toLowerCase()||e.util.getClosestTag(e.selection.getSelectedParentElement(n),"a")?this.execAction("unlink"):(this.isDisplayed()||this.showForm(),!1)},handleKeydown:function(t){e.util.isKey(t,e.util.keyCode.K)&&e.util.isMetaCtrlKey(t)&&!t.shiftKey&&this.handleClick(t)},getForm:function(){return this.form||(this.form=this.createForm()),this.form},getTemplate:function(){var e=['<input type="text" class="medium-editor-toolbar-input" placeholder="',this.placeholderText,'">'];return e.push('<a href="#" class="medium-editor-toolbar-save">',"fontawesome"===this.getEditorOption("buttonLabels")?'<i class="fa fa-check"></i>':this.formSaveLabel,"</a>"),e.push('<a href="#" class="medium-editor-toolbar-close">',"fontawesome"===this.getEditorOption("buttonLabels")?'<i class="fa fa-times"></i>':this.formCloseLabel,"</a>"),this.targetCheckbox&&e.push('<div class="medium-editor-toolbar-form-row">','<input type="checkbox" class="medium-editor-toolbar-anchor-target" id="medium-editor-toolbar-anchor-target-field-'+this.getEditorId()+'">','<label for="medium-editor-toolbar-anchor-target-field-'+this.getEditorId()+'">',this.targetCheckboxText,"</label>","</div>"),this.customClassOption&&e.push('<div class="medium-editor-toolbar-form-row">','<input type="checkbox" class="medium-editor-toolbar-anchor-button">',"<label>",this.customClassOptionText,"</label>","</div>"),e.join("")},isDisplayed:function(){return e.extensions.form.prototype.isDisplayed.apply(this)},hideForm:function(){e.extensions.form.prototype.hideForm.apply(this),this.getInput().value=""},showForm:function(t){var n=this.getInput(),i=this.getAnchorTargetCheckbox(),o=this.getAnchorButtonCheckbox();if("string"==typeof(t=t||{value:""})&&(t={value:t}),this.base.saveSelection(),this.hideToolbarDefaultActions(),e.extensions.form.prototype.showForm.apply(this),this.setToolbarPosition(),n.value=t.value,n.focus(),i&&(i.checked="_blank"===t.target),o){var r=t.buttonClass?t.buttonClass.split(" "):[];o.checked=-1!==r.indexOf(this.customClassOption)}},destroy:function(){if(!this.form)return!1;this.form.parentNode&&this.form.parentNode.removeChild(this.form),delete this.form},getFormOpts:function(){var e=this.getAnchorTargetCheckbox(),t=this.getAnchorButtonCheckbox(),n={value:this.getInput().value.trim()};return this.linkValidation&&(n.value=this.checkLinkFormat(n.value)),n.target="_self",e&&e.checked&&(n.target="_blank"),t&&t.checked&&(n.buttonClass=this.customClassOption),n},doFormSave:function(){var e=this.getFormOpts();this.completeFormSave(e)},completeFormSave:function(e){this.base.restoreSelection(),this.execAction(this.action,e),this.base.checkSelection()},ensureEncodedUri:function(e){return e===decodeURI(e)?encodeURI(e):e},ensureEncodedUriComponent:function(e){return e===decodeURIComponent(e)?encodeURIComponent(e):e},ensureEncodedParam:function(e){var t=e.split("="),n=t[0],i=t[1];return n+(void 0===i?"":"="+this.ensureEncodedUriComponent(i))},ensureEncodedQuery:function(e){return e.split("&").map(this.ensureEncodedParam.bind(this)).join("&")},checkLinkFormat:function(e){var t=/^([a-z]+:)?\/\/|^(mailto|tel|maps):|^\#/i.test(e),n="",i=e.match(/^(.*?)(?:\?(.*?))?(?:#(.*))?$/),o=i[1],r=i[2],a=i[3];if(/^\+?\s?\(?(?:\d\s?\-?\)?){3,20}$/.test(e))return"tel:"+e;if(!t){var s=o.split("/")[0];(s.match(/.+(\.|:).+/)||"localhost"===s)&&(n="http://")}return n+this.ensureEncodedUri(o)+(void 0===r?"":"?"+this.ensureEncodedQuery(r))+(void 0===a?"":"#"+a)},doFormCancel:function(){this.base.restoreSelection(),this.base.checkSelection()},attachFormEvents:function(e){var t=e.querySelector(".medium-editor-toolbar-close"),n=e.querySelector(".medium-editor-toolbar-save"),i=e.querySelector(".medium-editor-toolbar-input");this.on(e,"click",this.handleFormClick.bind(this)),this.on(i,"keyup",this.handleTextboxKeyup.bind(this)),this.on(t,"click",this.handleCloseClick.bind(this)),this.on(n,"click",this.handleSaveClick.bind(this),!0)},createForm:function(){var e=this.document.createElement("div");return e.className="medium-editor-toolbar-form",e.id="medium-editor-toolbar-form-anchor-"+this.getEditorId(),e.innerHTML=this.getTemplate(),this.attachFormEvents(e),e},getInput:function(){return this.getForm().querySelector("input.medium-editor-toolbar-input")},getAnchorTargetCheckbox:function(){return this.getForm().querySelector(".medium-editor-toolbar-anchor-target")},getAnchorButtonCheckbox:function(){return this.getForm().querySelector(".medium-editor-toolbar-anchor-button")},handleTextboxKeyup:function(t){if(t.keyCode===e.util.keyCode.ENTER)return t.preventDefault(),void this.doFormSave();t.keyCode===e.util.keyCode.ESCAPE&&(t.preventDefault(),this.doFormCancel())},handleFormClick:function(e){e.stopPropagation()},handleSaveClick:function(e){e.preventDefault(),this.doFormSave()},handleCloseClick:function(e){e.preventDefault(),this.doFormCancel()}}),e.extensions.anchor=o,r=e.Extension.extend({name:"anchor-preview",hideDelay:500,previewValueSelector:"a",showWhenToolbarIsVisible:!1,showOnEmptyLinks:!0,init:function(){this.anchorPreview=this.createPreview(),this.getEditorOption("elementsContainer").appendChild(this.anchorPreview),this.attachToEditables()},getInteractionElements:function(){return this.getPreviewElement()},getPreviewElement:function(){return this.anchorPreview},createPreview:function(){var e=this.document.createElement("div");return e.id="medium-editor-anchor-preview-"+this.getEditorId(),e.className="medium-editor-anchor-preview",e.innerHTML=this.getTemplate(),this.on(e,"click",this.handleClick.bind(this)),e},getTemplate:function(){return'<div class="medium-editor-toolbar-anchor-preview" id="medium-editor-toolbar-anchor-preview">    <a class="medium-editor-toolbar-anchor-preview-inner"></a></div>'},destroy:function(){this.anchorPreview&&(this.anchorPreview.parentNode&&this.anchorPreview.parentNode.removeChild(this.anchorPreview),delete this.anchorPreview)},hidePreview:function(){this.anchorPreview&&this.anchorPreview.classList.remove("medium-editor-anchor-preview-active"),this.activeAnchor=null},showPreview:function(e){return!(!this.anchorPreview.classList.contains("medium-editor-anchor-preview-active")&&!e.getAttribute("data-disable-preview"))||(this.previewValueSelector&&(this.anchorPreview.querySelector(this.previewValueSelector).textContent=e.attributes.href.value,this.anchorPreview.querySelector(this.previewValueSelector).href=e.attributes.href.value),this.anchorPreview.classList.add("medium-toolbar-arrow-over"),this.anchorPreview.classList.remove("medium-toolbar-arrow-under"),this.anchorPreview.classList.contains("medium-editor-anchor-preview-active")||this.anchorPreview.classList.add("medium-editor-anchor-preview-active"),this.activeAnchor=e,this.positionPreview(),this.attachPreviewHandlers(),this)},positionPreview:function(e){e=e||this.activeAnchor;var t,n,i,o,r,a=this.window.innerWidth,s=this.anchorPreview.offsetHeight,l=e.getBoundingClientRect(),u=this.diffLeft,c=this.diffTop,d=this.getEditorOption("elementsContainer"),h=["absolute","fixed"].indexOf(window.getComputedStyle(d).getPropertyValue("position"))>-1,f={};t=this.anchorPreview.offsetWidth/2;var p=this.base.getExtensionByName("toolbar");p&&(u=p.diffLeft,c=p.diffTop),n=u-t,h?(o=d.getBoundingClientRect(),["top","left"].forEach((function(e){f[e]=l[e]-o[e]})),f.width=l.width,f.height=l.height,l=f,a=o.width,r=d.scrollTop):r=this.window.pageYOffset,i=l.left+l.width/2,r+=s+l.top+l.height-c-this.anchorPreview.offsetHeight,this.anchorPreview.style.top=Math.round(r)+"px",this.anchorPreview.style.right="initial",i<t?(this.anchorPreview.style.left=n+t+"px",this.anchorPreview.style.right="initial"):a-i<t?(this.anchorPreview.style.left="auto",this.anchorPreview.style.right=0):(this.anchorPreview.style.left=n+i+"px",this.anchorPreview.style.right="initial")},attachToEditables:function(){this.subscribe("editableMouseover",this.handleEditableMouseover.bind(this)),this.subscribe("positionedToolbar",this.handlePositionedToolbar.bind(this))},handlePositionedToolbar:function(){this.showWhenToolbarIsVisible||this.hidePreview()},handleClick:function(e){var t=this.base.getExtensionByName("anchor"),n=this.activeAnchor;t&&n&&(e.preventDefault(),this.base.selectElement(this.activeAnchor),this.base.delay(function(){if(n){var e={value:n.attributes.href.value,target:n.getAttribute("target"),buttonClass:n.getAttribute("class")};t.showForm(e),n=null}}.bind(this))),this.hidePreview()},handleAnchorMouseout:function(){this.anchorToPreview=null,this.off(this.activeAnchor,"mouseout",this.instanceHandleAnchorMouseout),this.instanceHandleAnchorMouseout=null},handleEditableMouseover:function(t){var n=e.util.getClosestTag(t.target,"a");if(!1!==n){if(!this.showOnEmptyLinks&&(!/href=["']\S+["']/.test(n.outerHTML)||/href=["']#\S+["']/.test(n.outerHTML)))return!0;var i=this.base.getExtensionByName("toolbar");if(!this.showWhenToolbarIsVisible&&i&&i.isDisplayed&&i.isDisplayed())return!0;this.activeAnchor&&this.activeAnchor!==n&&this.detachPreviewHandlers(),this.anchorToPreview=n,this.instanceHandleAnchorMouseout=this.handleAnchorMouseout.bind(this),this.on(this.anchorToPreview,"mouseout",this.instanceHandleAnchorMouseout),this.base.delay(function(){this.anchorToPreview&&this.showPreview(this.anchorToPreview)}.bind(this))}},handlePreviewMouseover:function(){this.lastOver=(new Date).getTime(),this.hovering=!0},handlePreviewMouseout:function(e){e.relatedTarget&&/anchor-preview/.test(e.relatedTarget.className)||(this.hovering=!1)},updatePreview:function(){if(this.hovering)return!0;(new Date).getTime()-this.lastOver>this.hideDelay&&this.detachPreviewHandlers()},detachPreviewHandlers:function(){clearInterval(this.intervalTimer),this.instanceHandlePreviewMouseover&&(this.off(this.anchorPreview,"mouseover",this.instanceHandlePreviewMouseover),this.off(this.anchorPreview,"mouseout",this.instanceHandlePreviewMouseout),this.activeAnchor&&(this.off(this.activeAnchor,"mouseover",this.instanceHandlePreviewMouseover),this.off(this.activeAnchor,"mouseout",this.instanceHandlePreviewMouseout))),this.hidePreview(),this.hovering=this.instanceHandlePreviewMouseover=this.instanceHandlePreviewMouseout=null},attachPreviewHandlers:function(){this.lastOver=(new Date).getTime(),this.hovering=!0,this.instanceHandlePreviewMouseover=this.handlePreviewMouseover.bind(this),this.instanceHandlePreviewMouseout=this.handlePreviewMouseout.bind(this),this.intervalTimer=setInterval(this.updatePreview.bind(this),200),this.on(this.anchorPreview,"mouseover",this.instanceHandlePreviewMouseover),this.on(this.anchorPreview,"mouseout",this.instanceHandlePreviewMouseout),this.on(this.activeAnchor,"mouseover",this.instanceHandlePreviewMouseover),this.on(this.activeAnchor,"mouseout",this.instanceHandlePreviewMouseout)}}),e.extensions.anchorPreview=r,function(){var t,n,i,o,r;function a(t){return!e.util.getClosestTag(t,"a")}t=[" ","\t","\n","\r"," "," "," "," "," ","\u2028","\u2029"],i="(((?:(https?://|ftps?://|nntp://)|www\\d{0,3}[.]|[a-z0-9.\\-]+[.]("+(n="com|net|org|edu|gov|mil|aero|asia|biz|cat|coop|info|int|jobs|mobi|museum|name|post|pro|tel|travel|xxx|ac|ad|ae|af|ag|ai|al|am|an|ao|aq|ar|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cs|cu|cv|cx|cy|cz|dd|de|dj|dk|dm|do|dz|ec|ee|eg|eh|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|ja|sk|sl|sm|sn|so|sr|ss|st|su|sv|sx|sy|sz|tc|td|tf|tg|th|tj|tk|tl|tm|tn|to|tp|tr|tt|tv|tw|tz|ua|ug|uk|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|yu|za|zm|zw")+")\\/)\\S+(?:[^\\s`!\\[\\]{};:'\".,?«»“”‘’])))|(([a-z0-9\\-]+\\.)?[a-z0-9\\-]+\\.("+n+"))",o=new RegExp("^("+n+")$","i"),r=new RegExp(i,"gi");var s=e.Extension.extend({init:function(){e.Extension.prototype.init.apply(this,arguments),this.disableEventHandling=!1,this.subscribe("editableKeypress",this.onKeypress.bind(this)),this.subscribe("editableBlur",this.onBlur.bind(this)),this.document.execCommand("AutoUrlDetect",!1,!1)},isLastInstance:function(){for(var e=0,t=0;t<this.window._mediumEditors.length;t++){var n=this.window._mediumEditors[t];null!==n&&void 0!==n.getExtensionByName("autoLink")&&e++}return 1===e},destroy:function(){this.document.queryCommandSupported("AutoUrlDetect")&&this.isLastInstance()&&this.document.execCommand("AutoUrlDetect",!1,!0)},onBlur:function(e,t){this.performLinking(t)},onKeypress:function(t){this.disableEventHandling||e.util.isKey(t,[e.util.keyCode.SPACE,e.util.keyCode.ENTER])&&(clearTimeout(this.performLinkingTimeout),this.performLinkingTimeout=setTimeout(function(){try{var e=this.base.exportSelection();this.performLinking(t.target)&&this.base.importSelection(e,!0)}catch(e){window.console&&window.console.error("Failed to perform linking",e),this.disableEventHandling=!0}}.bind(this),0))},performLinking:function(t){var n=e.util.splitByBlockElements(t),i=!1;0===n.length&&(n=[t]);for(var o=0;o<n.length;o++)i=this.removeObsoleteAutoLinkSpans(n[o])||i,i=this.performLinkingWithinElement(n[o])||i;return this.base.events.updateInput(t,{target:t,currentTarget:t}),i},removeObsoleteAutoLinkSpans:function(t){if(!t||3===t.nodeType)return!1;for(var n=t.querySelectorAll('span[data-auto-link="true"]'),i=!1,o=0;o<n.length;o++){var r=n[o].textContent;if(-1===r.indexOf("://")&&(r=e.util.ensureUrlHasProtocol(r)),n[o].getAttribute("data-href")!==r&&a(n[o])){i=!0;var s=r.replace(/\s+$/,"");if(n[o].getAttribute("data-href")===s){var l=r.length-s.length,u=e.util.splitOffDOMTree(n[o],this.splitTextBeforeEnd(n[o],l));n[o].parentNode.insertBefore(u,n[o].nextSibling)}else e.util.unwrap(n[o],this.document)}}return i},splitTextBeforeEnd:function(e,t){for(var n,i,o,r=this.document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null,!1),a=!0;a;)a=null!==r.lastChild();for(;t>0&&null!==o;)(i=(n=r.currentNode).nodeValue).length>t?(o=n.splitText(i.length-t),t=0):(o=r.previousNode(),t-=i.length);return o},performLinkingWithinElement:function(t){for(var n=this.findLinkableText(t),i=0;i<n.length;i++){var o=e.util.findOrCreateMatchingTextNodes(this.document,t,n[i]);this.shouldNotLink(o)||this.createAutoLink(o,n[i].href)}return!1},shouldNotLink:function(t){for(var n=!1,i=0;i<t.length&&!1===n;i++)n=!!e.util.traverseUp(t[i],(function(e){return"a"===e.nodeName.toLowerCase()||e.getAttribute&&"true"===e.getAttribute("data-auto-link")}));return n},findLinkableText:function(e){for(var n=e.textContent,i=null,a=[];null!==(i=r.exec(n));){var s=i.index+i[0].length;!(0!==i.index&&-1===t.indexOf(n[i.index-1])||s!==n.length&&-1===t.indexOf(n[s]))&&(-1!==i[0].indexOf("/")||o.test(i[0].split(".").pop().split("?").shift()))&&a.push({href:i[0],start:i.index,end:s})}return a},createAutoLink:function(t,n){n=e.util.ensureUrlHasProtocol(n);var i=e.util.createLink(this.document,t,n,this.getEditorOption("targetBlank")?"_blank":null),o=this.document.createElement("span");for(o.setAttribute("data-auto-link","true"),o.setAttribute("data-href",n),i.insertBefore(o,i.firstChild);i.childNodes.length>1;)o.appendChild(i.childNodes[1])}});e.extensions.autoLink=s}(),function(){var t="medium-editor-dragover";function n(n){var i=e.util.getContainerEditorElement(n);Array.prototype.slice.call(i.parentElement.querySelectorAll("."+t)).forEach((function(e){e.classList.remove(t)}))}var i=e.Extension.extend({name:"fileDragging",allowedTypes:["image"],init:function(){e.Extension.prototype.init.apply(this,arguments),this.subscribe("editableDrag",this.handleDrag.bind(this)),this.subscribe("editableDrop",this.handleDrop.bind(this))},handleDrag:function(e){e.preventDefault(),e.dataTransfer.dropEffect="copy";var i=e.target.classList?e.target:e.target.parentElement;n(i),"dragover"===e.type&&i.classList.add(t)},handleDrop:function(e){e.preventDefault(),e.stopPropagation(),this.base.selectElement(e.target);var t=this.base.exportSelection();t.start=t.end,this.base.importSelection(t),e.dataTransfer.files&&Array.prototype.slice.call(e.dataTransfer.files).forEach((function(e){this.isAllowedFile(e)&&e.type.match("image")&&this.insertImageFile(e)}),this),n(e.target)},isAllowedFile:function(e){return this.allowedTypes.some((function(t){return!!e.type.match(t)}))},insertImageFile:function(t){if("function"==typeof FileReader){var n=new FileReader;n.readAsDataURL(t),n.addEventListener("load",function(t){var n=this.document.createElement("img");n.src=t.target.result,e.util.insertHTMLCommand(this.document,n.outerHTML)}.bind(this))}}});e.extensions.fileDragging=i}(),a=e.Extension.extend({name:"keyboard-commands",commands:[{command:"bold",key:"B",meta:!0,shift:!1,alt:!1},{command:"italic",key:"I",meta:!0,shift:!1,alt:!1},{command:"underline",key:"U",meta:!0,shift:!1,alt:!1}],init:function(){e.Extension.prototype.init.apply(this,arguments),this.subscribe("editableKeydown",this.handleKeydown.bind(this)),this.keys={},this.commands.forEach((function(e){var t=e.key.charCodeAt(0);this.keys[t]||(this.keys[t]=[]),this.keys[t].push(e)}),this)},handleKeydown:function(t){var n=e.util.getKeyCode(t);if(this.keys[n]){var i=e.util.isMetaCtrlKey(t),o=!!t.shiftKey,r=!!t.altKey;this.keys[n].forEach((function(e){e.meta!==i||e.shift!==o||e.alt!==r&&void 0!==e.alt||(t.preventDefault(),t.stopPropagation(),"function"==typeof e.command?e.command.apply(this):!1!==e.command&&this.execAction(e.command))}),this)}}}),e.extensions.keyboardCommands=a,s=e.extensions.form.extend({name:"fontname",action:"fontName",aria:"change font name",contentDefault:"&#xB1;",contentFA:'<i class="fa fa-font"></i>',fonts:["","Arial","Verdana","Times New Roman"],init:function(){e.extensions.form.prototype.init.apply(this,arguments)},handleClick:function(e){if(e.preventDefault(),e.stopPropagation(),!this.isDisplayed()){var t=this.document.queryCommandValue("fontName")+"";this.showForm(t)}return!1},getForm:function(){return this.form||(this.form=this.createForm()),this.form},isDisplayed:function(){return"block"===this.getForm().style.display},hideForm:function(){this.getForm().style.display="none",this.getSelect().value=""},showForm:function(e){var t=this.getSelect();this.base.saveSelection(),this.hideToolbarDefaultActions(),this.getForm().style.display="block",this.setToolbarPosition(),t.value=e||"",t.focus()},destroy:function(){if(!this.form)return!1;this.form.parentNode&&this.form.parentNode.removeChild(this.form),delete this.form},doFormSave:function(){this.base.restoreSelection(),this.base.checkSelection()},doFormCancel:function(){this.base.restoreSelection(),this.clearFontName(),this.base.checkSelection()},createForm:function(){var e,t=this.document,n=t.createElement("div"),i=t.createElement("select"),o=t.createElement("a"),r=t.createElement("a");n.className="medium-editor-toolbar-form",n.id="medium-editor-toolbar-form-fontname-"+this.getEditorId(),this.on(n,"click",this.handleFormClick.bind(this));for(var a=0;a<this.fonts.length;a++)(e=t.createElement("option")).innerHTML=this.fonts[a],e.value=this.fonts[a],i.appendChild(e);return i.className="medium-editor-toolbar-select",n.appendChild(i),this.on(i,"change",this.handleFontChange.bind(this)),r.setAttribute("href","#"),r.className="medium-editor-toobar-save",r.innerHTML="fontawesome"===this.getEditorOption("buttonLabels")?'<i class="fa fa-check"></i>':"&#10003;",n.appendChild(r),this.on(r,"click",this.handleSaveClick.bind(this),!0),o.setAttribute("href","#"),o.className="medium-editor-toobar-close",o.innerHTML="fontawesome"===this.getEditorOption("buttonLabels")?'<i class="fa fa-times"></i>':"&times;",n.appendChild(o),this.on(o,"click",this.handleCloseClick.bind(this)),n},getSelect:function(){return this.getForm().querySelector("select.medium-editor-toolbar-select")},clearFontName:function(){e.selection.getSelectedElements(this.document).forEach((function(e){"font"===e.nodeName.toLowerCase()&&e.hasAttribute("face")&&e.removeAttribute("face")}))},handleFontChange:function(){var e=this.getSelect().value;""===e?this.clearFontName():this.execAction("fontName",{value:e})},handleFormClick:function(e){e.stopPropagation()},handleSaveClick:function(e){e.preventDefault(),this.doFormSave()},handleCloseClick:function(e){e.preventDefault(),this.doFormCancel()}}),e.extensions.fontName=s,l=e.extensions.form.extend({name:"fontsize",action:"fontSize",aria:"increase/decrease font size",contentDefault:"&#xB1;",contentFA:'<i class="fa fa-text-height"></i>',init:function(){e.extensions.form.prototype.init.apply(this,arguments)},handleClick:function(e){if(e.preventDefault(),e.stopPropagation(),!this.isDisplayed()){var t=this.document.queryCommandValue("fontSize")+"";this.showForm(t)}return!1},getForm:function(){return this.form||(this.form=this.createForm()),this.form},isDisplayed:function(){return"block"===this.getForm().style.display},hideForm:function(){this.getForm().style.display="none",this.getInput().value=""},showForm:function(e){var t=this.getInput();this.base.saveSelection(),this.hideToolbarDefaultActions(),this.getForm().style.display="block",this.setToolbarPosition(),t.value=e||"",t.focus()},destroy:function(){if(!this.form)return!1;this.form.parentNode&&this.form.parentNode.removeChild(this.form),delete this.form},doFormSave:function(){this.base.restoreSelection(),this.base.checkSelection()},doFormCancel:function(){this.base.restoreSelection(),this.clearFontSize(),this.base.checkSelection()},createForm:function(){var e=this.document,t=e.createElement("div"),n=e.createElement("input"),i=e.createElement("a"),o=e.createElement("a");return t.className="medium-editor-toolbar-form",t.id="medium-editor-toolbar-form-fontsize-"+this.getEditorId(),this.on(t,"click",this.handleFormClick.bind(this)),n.setAttribute("type","range"),n.setAttribute("min","1"),n.setAttribute("max","7"),n.className="medium-editor-toolbar-input",t.appendChild(n),this.on(n,"change",this.handleSliderChange.bind(this)),o.setAttribute("href","#"),o.className="medium-editor-toobar-save",o.innerHTML="fontawesome"===this.getEditorOption("buttonLabels")?'<i class="fa fa-check"></i>':"&#10003;",t.appendChild(o),this.on(o,"click",this.handleSaveClick.bind(this),!0),i.setAttribute("href","#"),i.className="medium-editor-toobar-close",i.innerHTML="fontawesome"===this.getEditorOption("buttonLabels")?'<i class="fa fa-times"></i>':"&times;",t.appendChild(i),this.on(i,"click",this.handleCloseClick.bind(this)),t},getInput:function(){return this.getForm().querySelector("input.medium-editor-toolbar-input")},clearFontSize:function(){e.selection.getSelectedElements(this.document).forEach((function(e){"font"===e.nodeName.toLowerCase()&&e.hasAttribute("size")&&e.removeAttribute("size")}))},handleSliderChange:function(){var e=this.getInput().value;"4"===e?this.clearFontSize():this.execAction("fontSize",{value:e})},handleFormClick:function(e){e.stopPropagation()},handleSaveClick:function(e){e.preventDefault(),this.doFormSave()},handleCloseClick:function(e){e.preventDefault(),this.doFormCancel()}}),e.extensions.fontSize=l,function(){var t="%ME_PASTEBIN%",n=null,i=null,o=function(e){e.stopPropagation()};function r(e,t,n){var i=e.clipboardData||t.clipboardData||n.dataTransfer,o={};if(!i)return o;if(i.getData){var r=i.getData("Text");r&&r.length>0&&(o["text/plain"]=r)}if(i.types)for(var a=0;a<i.types.length;a++){var s=i.types[a];o[s]=i.getData(s)}return o}var a=e.Extension.extend({forcePlainText:!0,cleanPastedHTML:!1,preCleanReplacements:[],cleanReplacements:[],cleanAttrs:["class","style","dir"],cleanTags:["meta"],unwrapTags:[],init:function(){e.Extension.prototype.init.apply(this,arguments),(this.forcePlainText||this.cleanPastedHTML)&&(this.subscribe("editableKeydown",this.handleKeydown.bind(this)),this.getEditorElements().forEach((function(e){this.on(e,"paste",this.handlePaste.bind(this))}),this),this.subscribe("addElement",this.handleAddElement.bind(this)))},handleAddElement:function(e,t){this.on(t,"paste",this.handlePaste.bind(this))},destroy:function(){(this.forcePlainText||this.cleanPastedHTML)&&this.removePasteBin()},handlePaste:function(e,t){if(!e.defaultPrevented){var n=r(e,this.window,this.document),i=n["text/html"],o=n["text/plain"];this.window.clipboardData&&void 0===e.clipboardData&&!i&&(i=o),(i||o)&&(e.preventDefault(),this.doPaste(i,o,t))}},doPaste:function(t,n,i){var o,r,a="";if(this.cleanPastedHTML&&t)return this.cleanPaste(t);if(n){if(this.getEditorOption("disableReturn")||i&&i.getAttribute("data-disable-return"))a=e.util.htmlEntities(n);else if((o=n.split(/[\r\n]+/g)).length>1)for(r=0;r<o.length;r+=1)""!==o[r]&&(a+="<p>"+e.util.htmlEntities(o[r])+"</p>");else a=e.util.htmlEntities(o[0]);e.util.insertHTMLCommand(this.document,a)}},handlePasteBinPaste:function(e){if(e.defaultPrevented)this.removePasteBin();else{var t=r(e,this.window,this.document),n=t["text/html"],o=t["text/plain"],a=i;if(!this.cleanPastedHTML||n)return e.preventDefault(),this.removePasteBin(),this.doPaste(n,o,a),void this.trigger("editablePaste",{currentTarget:a,target:a},a);setTimeout(function(){this.cleanPastedHTML&&(n=this.getPasteBinHtml()),this.removePasteBin(),this.doPaste(n,o,a),this.trigger("editablePaste",{currentTarget:a,target:a},a)}.bind(this),0)}},handleKeydown:function(t,n){e.util.isKey(t,e.util.keyCode.V)&&e.util.isMetaCtrlKey(t)&&(t.stopImmediatePropagation(),this.removePasteBin(),this.createPasteBin(n))},createPasteBin:function(r){var a,s=e.selection.getSelectionRange(this.document),l=this.window.pageYOffset;i=r,s&&((a=s.getClientRects()).length?l+=a[0].top:void 0!==s.startContainer.getBoundingClientRect?l+=s.startContainer.getBoundingClientRect().top:l+=s.getBoundingClientRect().top),n=s;var u=this.document.createElement("div");u.id=this.pasteBinId="medium-editor-pastebin-"+ +Date.now(),u.setAttribute("style","border: 1px red solid; position: absolute; top: "+l+"px; width: 10px; height: 10px; overflow: hidden; opacity: 0"),u.setAttribute("contentEditable",!0),u.innerHTML=t,this.document.body.appendChild(u),this.on(u,"focus",o),this.on(u,"focusin",o),this.on(u,"focusout",o),u.focus(),e.selection.selectNode(u,this.document),this.boundHandlePaste||(this.boundHandlePaste=this.handlePasteBinPaste.bind(this)),this.on(u,"paste",this.boundHandlePaste)},removePasteBin:function(){null!==n&&(e.selection.selectRange(this.document,n),n=null),null!==i&&(i=null);var t=this.getPasteBin();t&&t&&(this.off(t,"focus",o),this.off(t,"focusin",o),this.off(t,"focusout",o),this.off(t,"paste",this.boundHandlePaste),t.parentElement.removeChild(t))},getPasteBin:function(){return this.document.getElementById(this.pasteBinId)},getPasteBinHtml:function(){var e=this.getPasteBin();if(!e)return!1;if(e.firstChild&&"mcepastebin"===e.firstChild.id)return!1;var n=e.innerHTML;return!(!n||n===t)&&n},cleanPaste:function(e){var t,n,i,o,r=/<p|<br|<div/.test(e),a=[].concat(this.preCleanReplacements||[],[[new RegExp(/^[\s\S]*<body[^>]*>\s*|\s*<\/body[^>]*>[\s\S]*$/g),""],[new RegExp(/<!--StartFragment-->|<!--EndFragment-->/g),""],[new RegExp(/<br>$/i),""],[new RegExp(/<[^>]*docs-internal-guid[^>]*>/gi),""],[new RegExp(/<\/b>(<br[^>]*>)?$/gi),""],[new RegExp(/<span class="Apple-converted-space">\s+<\/span>/g)," "],[new RegExp(/<br class="Apple-interchange-newline">/g),"<br>"],[new RegExp(/<span[^>]*(font-style:italic;font-weight:(bold|700)|font-weight:(bold|700);font-style:italic)[^>]*>/gi),'<span class="replace-with italic bold">'],[new RegExp(/<span[^>]*font-style:italic[^>]*>/gi),'<span class="replace-with italic">'],[new RegExp(/<span[^>]*font-weight:(bold|700)[^>]*>/gi),'<span class="replace-with bold">'],[new RegExp(/&lt;(\/?)(i|b|a)&gt;/gi),"<$1$2>"],[new RegExp(/&lt;a(?:(?!href).)+href=(?:&quot;|&rdquo;|&ldquo;|"|“|”)(((?!&quot;|&rdquo;|&ldquo;|"|“|”).)*)(?:&quot;|&rdquo;|&ldquo;|"|“|”)(?:(?!&gt;).)*&gt;/gi),'<a href="$1">'],[new RegExp(/<\/p>\n+/gi),"</p>"],[new RegExp(/\n+<p/gi),"<p"],[new RegExp(/<\/?o:[a-z]*>/gi),""],[new RegExp(/<!\[if !supportLists\]>(((?!<!).)*)<!\[endif]\>/gi),"$1"]],this.cleanReplacements||[]);for(t=0;t<a.length;t+=1)e=e.replace(a[t][0],a[t][1]);if(!r)return this.pasteHTML(e);for((i=this.document.createElement("div")).innerHTML="<p>"+e.split("<br><br>").join("</p><p>")+"</p>",n=i.querySelectorAll("a,p,div,br"),t=0;t<n.length;t+=1)switch((o=n[t]).innerHTML=o.innerHTML.replace(/\n/gi," "),o.nodeName.toLowerCase()){case"p":case"div":this.filterCommonBlocks(o);break;case"br":this.filterLineBreak(o)}this.pasteHTML(i.innerHTML)},pasteHTML:function(t,n){n=e.util.defaults({},n,{cleanAttrs:this.cleanAttrs,cleanTags:this.cleanTags,unwrapTags:this.unwrapTags});var i,o,r,a,s=this.document.createDocumentFragment();for(s.appendChild(this.document.createElement("body")),(a=s.querySelector("body")).innerHTML=t,this.cleanupSpans(a),i=a.querySelectorAll("*"),r=0;r<i.length;r+=1)"a"===(o=i[r]).nodeName.toLowerCase()&&this.getEditorOption("targetBlank")&&e.util.setTargetBlank(o),e.util.cleanupAttrs(o,n.cleanAttrs),e.util.cleanupTags(o,n.cleanTags),e.util.unwrapTags(o,n.unwrapTags);e.util.insertHTMLCommand(this.document,a.innerHTML.replace(/&nbsp;/g," "))},isCommonBlock:function(e){return e&&("p"===e.nodeName.toLowerCase()||"div"===e.nodeName.toLowerCase())},filterCommonBlocks:function(e){/^\s*$/.test(e.textContent)&&e.parentNode&&e.parentNode.removeChild(e)},filterLineBreak:function(e){this.isCommonBlock(e.previousElementSibling)?this.removeWithParent(e):!this.isCommonBlock(e.parentNode)||e.parentNode.firstChild!==e&&e.parentNode.lastChild!==e?e.parentNode&&1===e.parentNode.childElementCount&&""===e.parentNode.textContent&&this.removeWithParent(e):this.removeWithParent(e)},removeWithParent:function(e){e&&e.parentNode&&(e.parentNode.parentNode&&1===e.parentNode.childElementCount?e.parentNode.parentNode.removeChild(e.parentNode):e.parentNode.removeChild(e))},cleanupSpans:function(t){var n,i,o,r=t.querySelectorAll(".replace-with"),a=function(e){return e&&"#text"!==e.nodeName&&"false"===e.getAttribute("contenteditable")};for(n=0;n<r.length;n+=1)i=r[n],o=this.document.createElement(i.classList.contains("bold")?"b":"i"),i.classList.contains("bold")&&i.classList.contains("italic")?o.innerHTML="<i>"+i.innerHTML+"</i>":o.innerHTML=i.innerHTML,i.parentNode.replaceChild(o,i);for(r=t.querySelectorAll("span"),n=0;n<r.length;n+=1){if(i=r[n],e.util.traverseUp(i,a))return!1;e.util.unwrap(i,this.document)}}});e.extensions.paste=a}(),u=e.Extension.extend({name:"placeholder",text:"Type your text",hideOnClick:!0,init:function(){e.Extension.prototype.init.apply(this,arguments),this.initPlaceholders(),this.attachEventHandlers()},initPlaceholders:function(){this.getEditorElements().forEach(this.initElement,this)},handleAddElement:function(e,t){this.initElement(t)},initElement:function(e){e.getAttribute("data-placeholder")||e.setAttribute("data-placeholder",this.text),this.updatePlaceholder(e)},destroy:function(){this.getEditorElements().forEach(this.cleanupElement,this)},handleRemoveElement:function(e,t){this.cleanupElement(t)},cleanupElement:function(e){e.getAttribute("data-placeholder")===this.text&&e.removeAttribute("data-placeholder")},showPlaceholder:function(t){t&&(e.util.isFF&&0===t.childNodes.length?(t.classList.add("medium-editor-placeholder-relative"),t.classList.remove("medium-editor-placeholder")):(t.classList.add("medium-editor-placeholder"),t.classList.remove("medium-editor-placeholder-relative")))},hidePlaceholder:function(e){e&&(e.classList.remove("medium-editor-placeholder"),e.classList.remove("medium-editor-placeholder-relative"))},updatePlaceholder:function(e,t){if(e.querySelector("img, blockquote, ul, ol, table")||""!==e.textContent.replace(/^\s+|\s+$/g,""))return this.hidePlaceholder(e);t||this.showPlaceholder(e)},attachEventHandlers:function(){this.hideOnClick&&this.subscribe("focus",this.handleFocus.bind(this)),this.subscribe("editableInput",this.handleInput.bind(this)),this.subscribe("blur",this.handleBlur.bind(this)),this.subscribe("addElement",this.handleAddElement.bind(this)),this.subscribe("removeElement",this.handleRemoveElement.bind(this))},handleInput:function(e,t){var n=this.hideOnClick&&t===this.base.getFocusedElement();this.updatePlaceholder(t,n)},handleFocus:function(e,t){this.hidePlaceholder(t)},handleBlur:function(e,t){this.updatePlaceholder(t)}}),e.extensions.placeholder=u,c=e.Extension.extend({name:"toolbar",align:"center",allowMultiParagraphSelection:!0,buttons:["bold","italic","underline","anchor","h2","h3","quote"],diffLeft:0,diffTop:-10,firstButtonClass:"medium-editor-button-first",lastButtonClass:"medium-editor-button-last",standardizeSelectionStart:!1,static:!1,sticky:!1,stickyTopOffset:0,updateOnEmptySelection:!1,relativeContainer:null,init:function(){e.Extension.prototype.init.apply(this,arguments),this.initThrottledMethods(),this.relativeContainer?this.relativeContainer.appendChild(this.getToolbarElement()):this.getEditorOption("elementsContainer").appendChild(this.getToolbarElement())},forEachExtension:function(e,t){return this.base.extensions.forEach((function(n){if(n!==this)return e.apply(t||this,arguments)}),this)},createToolbar:function(){var e=this.document.createElement("div");return e.id="medium-editor-toolbar-"+this.getEditorId(),e.className="medium-editor-toolbar",this.static?e.className+=" static-toolbar":this.relativeContainer?e.className+=" medium-editor-relative-toolbar":e.className+=" medium-editor-stalker-toolbar",e.appendChild(this.createToolbarButtons()),this.forEachExtension((function(t){t.hasForm&&e.appendChild(t.getForm())})),this.attachEventHandlers(),e},createToolbarButtons:function(){var t,n,i,o,r,a,s=this.document.createElement("ul");return s.id="medium-editor-toolbar-actions"+this.getEditorId(),s.className="medium-editor-toolbar-actions",s.style.display="block",this.buttons.forEach((function(i){"string"==typeof i?(r=i,a=null):(r=i.name,a=i),(o=this.base.addBuiltInExtension(r,a))&&"function"==typeof o.getButton&&(n=o.getButton(this.base),t=this.document.createElement("li"),e.util.isElement(n)?t.appendChild(n):t.innerHTML=n,s.appendChild(t))}),this),(i=s.querySelectorAll("button")).length>0&&(i[0].classList.add(this.firstButtonClass),i[i.length-1].classList.add(this.lastButtonClass)),s},destroy:function(){this.toolbar&&(this.toolbar.parentNode&&this.toolbar.parentNode.removeChild(this.toolbar),delete this.toolbar)},getInteractionElements:function(){return this.getToolbarElement()},getToolbarElement:function(){return this.toolbar||(this.toolbar=this.createToolbar()),this.toolbar},getToolbarActionsElement:function(){return this.getToolbarElement().querySelector(".medium-editor-toolbar-actions")},initThrottledMethods:function(){this.throttledPositionToolbar=e.util.throttle(function(){this.base.isActive&&this.positionToolbarIfShown()}.bind(this))},attachEventHandlers:function(){this.subscribe("blur",this.handleBlur.bind(this)),this.subscribe("focus",this.handleFocus.bind(this)),this.subscribe("editableClick",this.handleEditableClick.bind(this)),this.subscribe("editableKeyup",this.handleEditableKeyup.bind(this)),this.on(this.document.documentElement,"mouseup",this.handleDocumentMouseup.bind(this)),this.static&&this.sticky&&this.on(this.window,"scroll",this.handleWindowScroll.bind(this),!0),this.on(this.window,"resize",this.handleWindowResize.bind(this))},handleWindowScroll:function(){this.positionToolbarIfShown()},handleWindowResize:function(){this.throttledPositionToolbar()},handleDocumentMouseup:function(t){if(t&&t.target&&e.util.isDescendant(this.getToolbarElement(),t.target))return!1;this.checkState()},handleEditableClick:function(){setTimeout(function(){this.checkState()}.bind(this),0)},handleEditableKeyup:function(){this.checkState()},handleBlur:function(){clearTimeout(this.hideTimeout),clearTimeout(this.delayShowTimeout),this.hideTimeout=setTimeout(function(){this.hideToolbar()}.bind(this),1)},handleFocus:function(){this.checkState()},isDisplayed:function(){return this.getToolbarElement().classList.contains("medium-editor-toolbar-active")},showToolbar:function(){clearTimeout(this.hideTimeout),this.isDisplayed()||(this.getToolbarElement().classList.add("medium-editor-toolbar-active"),this.trigger("showToolbar",{},this.base.getFocusedElement()))},hideToolbar:function(){this.isDisplayed()&&(this.getToolbarElement().classList.remove("medium-editor-toolbar-active"),this.trigger("hideToolbar",{},this.base.getFocusedElement()))},isToolbarDefaultActionsDisplayed:function(){return"block"===this.getToolbarActionsElement().style.display},hideToolbarDefaultActions:function(){this.isToolbarDefaultActionsDisplayed()&&(this.getToolbarActionsElement().style.display="none")},showToolbarDefaultActions:function(){this.hideExtensionForms(),this.isToolbarDefaultActionsDisplayed()||(this.getToolbarActionsElement().style.display="block"),this.delayShowTimeout=this.base.delay(function(){this.showToolbar()}.bind(this))},hideExtensionForms:function(){this.forEachExtension((function(e){e.hasForm&&e.isDisplayed()&&e.hideForm()}))},multipleBlockElementsSelected:function(){var t=new RegExp("<("+e.util.blockContainerElementNames.join("|")+")[^>]*>","g"),n=e.selection.getSelectionHtml(this.document).replace(/<[^\/>][^>]*><\/[^>]+>/gim,"").match(t);return!!n&&n.length>1},modifySelection:function(){var t=this.window.getSelection().getRangeAt(0);if(this.standardizeSelectionStart&&t.startContainer.nodeValue&&t.startOffset===t.startContainer.nodeValue.length){var n=e.util.findAdjacentTextNodeWithContent(e.selection.getSelectionElement(this.window),t.startContainer,this.document);if(n){for(var i=0;0===n.nodeValue.substr(i,1).trim().length;)i+=1;t=e.selection.select(this.document,n,i,t.endContainer,t.endOffset)}}},checkState:function(){if(!this.base.preventSelectionUpdates){if(!this.base.getFocusedElement()||e.selection.selectionInContentEditableFalse(this.window))return this.hideToolbar();var t=e.selection.getSelectionElement(this.window);return!t||-1===this.getEditorElements().indexOf(t)||t.getAttribute("data-disable-toolbar")?this.hideToolbar():this.updateOnEmptySelection&&this.static?this.showAndUpdateToolbar():!e.selection.selectionContainsContent(this.document)||!1===this.allowMultiParagraphSelection&&this.multipleBlockElementsSelected()?this.hideToolbar():void this.showAndUpdateToolbar()}},showAndUpdateToolbar:function(){this.modifySelection(),this.setToolbarButtonStates(),this.trigger("positionToolbar",{},this.base.getFocusedElement()),this.showToolbarDefaultActions(),this.setToolbarPosition()},setToolbarButtonStates:function(){this.forEachExtension((function(e){"function"==typeof e.isActive&&"function"==typeof e.setInactive&&e.setInactive()})),this.checkActiveButtons()},checkActiveButtons:function(){var t,n=[],i=null,o=e.selection.getSelectionRange(this.document),r=function(e){"function"==typeof e.checkState?e.checkState(t):"function"==typeof e.isActive&&"function"==typeof e.isAlreadyApplied&&"function"==typeof e.setActive&&!e.isActive()&&e.isAlreadyApplied(t)&&e.setActive()};if(o&&(this.forEachExtension((function(e){"function"!=typeof e.queryCommandState||null===(i=e.queryCommandState())?n.push(e):i&&"function"==typeof e.setActive&&e.setActive()})),t=e.selection.getSelectedParentElement(o),this.getEditorElements().some((function(n){return e.util.isDescendant(n,t,!0)}))))for(;t&&(n.forEach(r),!e.util.isMediumEditorElement(t));)t=t.parentNode},positionToolbarIfShown:function(){this.isDisplayed()&&this.setToolbarPosition()},setToolbarPosition:function(){var e=this.base.getFocusedElement(),t=this.window.getSelection();if(!e)return this;!this.static&&t.isCollapsed||(this.showToolbar(),this.relativeContainer||(this.static?this.positionStaticToolbar(e):this.positionToolbar(t)),this.trigger("positionedToolbar",{},this.base.getFocusedElement()))},positionStaticToolbar:function(e){this.getToolbarElement().style.left="0";var t,n=this.document.documentElement&&this.document.documentElement.scrollTop||this.document.body.scrollTop,i=this.window.innerWidth,o=this.getToolbarElement(),r=e.getBoundingClientRect(),a=r.top+n,s=r.left+r.width/2,l=o.offsetHeight,u=o.offsetWidth,c=u/2;switch(this.sticky?n>a+e.offsetHeight-l-this.stickyTopOffset?(o.style.top=a+e.offsetHeight-l+"px",o.classList.remove("medium-editor-sticky-toolbar")):n>a-l-this.stickyTopOffset?(o.classList.add("medium-editor-sticky-toolbar"),o.style.top=this.stickyTopOffset+"px"):(o.classList.remove("medium-editor-sticky-toolbar"),o.style.top=a-l+"px"):o.style.top=a-l+"px",this.align){case"left":t=r.left;break;case"right":t=r.right-u;break;case"center":t=s-c}t<0?t=0:t+u>i&&(t=i-Math.ceil(u)-1),o.style.left=t+"px"},positionToolbar:function(e){this.getToolbarElement().style.left="0",this.getToolbarElement().style.right="initial";var t=e.getRangeAt(0),n=t.getBoundingClientRect();(!n||0===n.height&&0===n.width&&t.startContainer===t.endContainer)&&(n=1===t.startContainer.nodeType&&t.startContainer.querySelector("img")?t.startContainer.querySelector("img").getBoundingClientRect():t.startContainer.getBoundingClientRect());var i,o,r=this.window.innerWidth,a=this.getToolbarElement(),s=a.offsetHeight,l=a.offsetWidth/2,u=this.diffLeft-l,c=this.getEditorOption("elementsContainer"),d=["absolute","fixed"].indexOf(window.getComputedStyle(c).getPropertyValue("position"))>-1,h={},f={};d?(o=c.getBoundingClientRect(),["top","left"].forEach((function(e){f[e]=n[e]-o[e]})),f.width=n.width,f.height=n.height,n=f,r=o.width,h.top=c.scrollTop):h.top=this.window.pageYOffset,i=n.left+n.width/2,h.top+=n.top-s,n.top<50?(a.classList.add("medium-toolbar-arrow-over"),a.classList.remove("medium-toolbar-arrow-under"),h.top+=50+n.height-this.diffTop):(a.classList.add("medium-toolbar-arrow-under"),a.classList.remove("medium-toolbar-arrow-over"),h.top+=this.diffTop),i<l?(h.left=u+l,h.right="initial"):r-i<l?(h.left="auto",h.right=0):(h.left=u+i,h.right="initial"),["top","left","right"].forEach((function(e){a.style[e]=h[e]+(isNaN(h[e])?"":"px")}))}}),e.extensions.toolbar=c,d=e.Extension.extend({init:function(){e.Extension.prototype.init.apply(this,arguments),this.subscribe("editableDrag",this.handleDrag.bind(this)),this.subscribe("editableDrop",this.handleDrop.bind(this))},handleDrag:function(e){var t="medium-editor-dragover";e.preventDefault(),e.dataTransfer.dropEffect="copy","dragover"===e.type?e.target.classList.add(t):"dragleave"===e.type&&e.target.classList.remove(t)},handleDrop:function(t){t.preventDefault(),t.stopPropagation(),t.dataTransfer.files&&Array.prototype.slice.call(t.dataTransfer.files,0).some(function(t){var n,i;t.type.match("image")&&((n=new FileReader).readAsDataURL(t),i="medium-img-"+ +new Date,e.util.insertHTMLCommand(this.document,'<img class="medium-editor-image-loading" id="'+i+'" />'),n.onload=function(){var e=this.document.getElementById(i);e&&(e.removeAttribute("id"),e.removeAttribute("class"),e.src=n.result)}.bind(this))}.bind(this)),t.target.classList.remove("medium-editor-dragover")}}),e.extensions.imageDragging=d,function(){function t(t){var n=e.selection.getSelectionStart(this.options.ownerDocument),i=n.textContent,o=e.selection.getCaretOffsets(n);(void 0===i[o.left-1]||""===i[o.left-1].trim()||void 0!==i[o.left]&&""===i[o.left].trim())&&t.preventDefault()}function n(t,n){if(this.options.disableReturn||n.getAttribute("data-disable-return"))t.preventDefault();else if(this.options.disableDoubleReturn||n.getAttribute("data-disable-double-return")){var i=e.selection.getSelectionStart(this.options.ownerDocument);(i&&""===i.textContent.trim()&&"li"!==i.nodeName.toLowerCase()||i.previousElementSibling&&"br"!==i.previousElementSibling.nodeName.toLowerCase()&&""===i.previousElementSibling.textContent.trim())&&t.preventDefault()}}function i(t){var n=e.selection.getSelectionStart(this.options.ownerDocument);"pre"===(n&&n.nodeName.toLowerCase())&&(t.preventDefault(),e.util.insertHTMLCommand(this.options.ownerDocument,"    ")),e.util.isListItem(n)&&(t.preventDefault(),t.shiftKey?this.options.ownerDocument.execCommand("outdent",!1,null):this.options.ownerDocument.execCommand("indent",!1,null))}function o(t){var n,i=e.selection.getSelectionStart(this.options.ownerDocument),o=i.nodeName.toLowerCase(),r=/^(\s+|<br\/?>)?$/i,a=/h\d/i;e.util.isKey(t,[e.util.keyCode.BACKSPACE,e.util.keyCode.ENTER])&&i.previousElementSibling&&a.test(o)&&0===e.selection.getCaretOffsets(i).left?e.util.isKey(t,e.util.keyCode.BACKSPACE)&&r.test(i.previousElementSibling.innerHTML)?(i.previousElementSibling.parentNode.removeChild(i.previousElementSibling),t.preventDefault()):!this.options.disableDoubleReturn&&e.util.isKey(t,e.util.keyCode.ENTER)&&((n=this.options.ownerDocument.createElement("p")).innerHTML="<br>",i.previousElementSibling.parentNode.insertBefore(n,i),t.preventDefault()):e.util.isKey(t,e.util.keyCode.DELETE)&&i.nextElementSibling&&i.previousElementSibling&&!a.test(o)&&r.test(i.innerHTML)&&a.test(i.nextElementSibling.nodeName.toLowerCase())?(e.selection.moveCursor(this.options.ownerDocument,i.nextElementSibling),i.previousElementSibling.parentNode.removeChild(i),t.preventDefault()):e.util.isKey(t,e.util.keyCode.BACKSPACE)&&"li"===o&&r.test(i.innerHTML)&&!i.previousElementSibling&&!i.parentElement.previousElementSibling&&i.nextElementSibling&&"li"===i.nextElementSibling.nodeName.toLowerCase()?((n=this.options.ownerDocument.createElement("p")).innerHTML="<br>",i.parentElement.parentElement.insertBefore(n,i.parentElement),e.selection.moveCursor(this.options.ownerDocument,n),i.parentElement.removeChild(i),t.preventDefault()):e.util.isKey(t,e.util.keyCode.BACKSPACE)&&!1!==e.util.getClosestTag(i,"blockquote")&&0===e.selection.getCaretOffsets(i).left?(t.preventDefault(),e.util.execFormatBlock(this.options.ownerDocument,"p")):e.util.isKey(t,e.util.keyCode.ENTER)&&!1!==e.util.getClosestTag(i,"blockquote")&&0===e.selection.getCaretOffsets(i).right?((n=this.options.ownerDocument.createElement("p")).innerHTML="<br>",i.parentElement.insertBefore(n,i.nextSibling),e.selection.moveCursor(this.options.ownerDocument,n),t.preventDefault()):e.util.isKey(t,e.util.keyCode.BACKSPACE)&&e.util.isMediumEditorElement(i.parentElement)&&!i.previousElementSibling&&i.nextElementSibling&&r.test(i.innerHTML)&&(t.preventDefault(),e.selection.moveCursor(this.options.ownerDocument,i.nextSibling),i.parentElement.removeChild(i))}function r(t){var n=e.selection.getSelectionStart(this.options.ownerDocument);n&&(e.util.isMediumEditorElement(n)&&0===n.children.length&&!e.util.isBlockContainer(n)&&this.options.ownerDocument.execCommand("formatBlock",!1,"p"),!e.util.isKey(t,e.util.keyCode.ENTER)||e.util.isListItem(n)||e.util.isBlockContainer(n)||("a"===n.nodeName.toLowerCase()?this.options.ownerDocument.execCommand("unlink",!1,null):t.shiftKey||t.ctrlKey||this.options.ownerDocument.execCommand("formatBlock",!1,"p")))}function a(e,t){var n=t.parentNode.querySelector('textarea[medium-editor-textarea-id="'+t.getAttribute("medium-editor-textarea-id")+'"]');n&&(n.value=t.innerHTML.trim())}function s(e){e._mediumEditors||(e._mediumEditors=[null]),this.id||(this.id=e._mediumEditors.length),e._mediumEditors[this.id]=this}function l(e){e._mediumEditors&&e._mediumEditors[this.id]&&(e._mediumEditors[this.id]=null)}function u(t,n,i){var o=[];if(t||(t=[]),"string"==typeof t&&(t=n.querySelectorAll(t)),e.util.isElement(t)&&(t=[t]),i)for(var r=0;r<t.length;r++){var a=t[r];!e.util.isElement(a)||a.getAttribute("data-medium-editor-element")||a.getAttribute("medium-editor-textarea-id")||o.push(a)}else o=Array.prototype.slice.apply(t);return o}function c(e){var t=e.parentNode.querySelector('textarea[medium-editor-textarea-id="'+e.getAttribute("medium-editor-textarea-id")+'"]');t&&(t.classList.remove("medium-editor-hidden"),t.removeAttribute("medium-editor-textarea-id")),e.parentNode&&e.parentNode.removeChild(e)}function d(e,t,n){return e=function(e,t){return Object.keys(t).forEach((function(n){void 0===e[n]&&(e[n]=t[n])})),e}(e,{window:n.options.contentWindow,document:n.options.ownerDocument,base:n}),"function"==typeof e.init&&e.init(),e.name||(e.name=t),e}function h(){return!this.elements.every((function(e){return!!e.getAttribute("data-disable-toolbar")}))&&!1!==this.options.toolbar}function f(){return!!h.call(this)&&!1!==this.options.anchorPreview}function p(){return!1!==this.options.placeholder}function g(){return!1!==this.options.autoLink}function v(){return!1!==this.options.imageDragging}function m(){return!1!==this.options.keyboardCommands}function y(){return!this.options.extensions.imageDragging}function b(e){for(var t=this.options.ownerDocument.createElement("div"),n=Date.now(),i="medium-editor-"+n,o=e.attributes;this.options.ownerDocument.getElementById(i);)n++,i="medium-editor-"+n;t.className=e.className,t.id=i,t.innerHTML=e.value,e.setAttribute("medium-editor-textarea-id",i);for(var r=0,a=o.length;r<a;r++)t.hasAttribute(o[r].nodeName)||t.setAttribute(o[r].nodeName,o[r].value);return e.form&&this.on(e.form,"reset",function(e){e.defaultPrevented||this.resetContent(this.options.ownerDocument.getElementById(i))}.bind(this)),e.classList.add("medium-editor-hidden"),e.parentNode.insertBefore(t,e),t}function x(t,i){if(!t.getAttribute("data-medium-editor-element")){"textarea"===t.nodeName.toLowerCase()&&(t=b.call(this,t),this.instanceHandleEditableInput||(this.instanceHandleEditableInput=a.bind(this),this.subscribe("editableInput",this.instanceHandleEditableInput))),this.options.disableEditing||t.getAttribute("data-disable-editing")||(t.setAttribute("contentEditable",!0),t.setAttribute("spellcheck",this.options.spellcheck)),this.instanceHandleEditableKeydownEnter||(t.getAttribute("data-disable-return")||t.getAttribute("data-disable-double-return"))&&(this.instanceHandleEditableKeydownEnter=n.bind(this),this.subscribe("editableKeydownEnter",this.instanceHandleEditableKeydownEnter)),this.options.disableReturn||t.getAttribute("data-disable-return")||this.on(t,"keyup",r.bind(this));var o=e.util.guid();t.setAttribute("data-medium-editor-element",!0),t.classList.add("medium-editor-element"),t.setAttribute("role","textbox"),t.setAttribute("aria-multiline",!0),t.setAttribute("data-medium-editor-editor-index",i),t.setAttribute("medium-editor-index",o),S[o]=t.innerHTML,this.events.attachAllEventsToElement(t)}return t}function w(){this.subscribe("editableKeydownTab",i.bind(this)),this.subscribe("editableKeydownDelete",o.bind(this)),this.subscribe("editableKeydownEnter",o.bind(this)),this.options.disableExtraSpaces&&this.subscribe("editableKeydownSpace",t.bind(this)),this.instanceHandleEditableKeydownEnter||(this.options.disableReturn||this.options.disableDoubleReturn)&&(this.instanceHandleEditableKeydownEnter=n.bind(this),this.subscribe("editableKeydownEnter",this.instanceHandleEditableKeydownEnter))}function E(){if(this.extensions=[],Object.keys(this.options.extensions).forEach((function(e){"toolbar"!==e&&this.options.extensions[e]&&this.extensions.push(d(this.options.extensions[e],e,this))}),this),y.call(this)){var t=this.options.fileDragging;t||(t={},v.call(this)||(t.allowedTypes=[])),this.addBuiltInExtension("fileDragging",t)}var n={paste:!0,"anchor-preview":f.call(this),autoLink:g.call(this),keyboardCommands:m.call(this),placeholder:p.call(this)};Object.keys(n).forEach((function(e){n[e]&&this.addBuiltInExtension(e)}),this);var i=this.options.extensions.toolbar;if(!i&&h.call(this)){var o=e.util.extend({},this.options.toolbar,{allowMultiParagraphSelection:this.options.allowMultiParagraphSelection});i=new e.extensions.toolbar(o)}i&&this.extensions.push(d(i,"toolbar",this))}function C(t,n){return n&&[["allowMultiParagraphSelection","toolbar.allowMultiParagraphSelection"]].forEach((function(t){n.hasOwnProperty(t[0])&&void 0!==n[t[0]]&&e.util.deprecated(t[0],t[1],"v6.0.0")})),e.util.defaults({},n,t)}function N(t,n){var i,o;if(i=/^append-(.+)$/gi.exec(t))return e.util.execFormatBlock(this.options.ownerDocument,i[1]);if("fontSize"===t)return n.size&&e.util.deprecated(".size option for fontSize command",".value","6.0.0"),o=n.value||n.size,this.options.ownerDocument.execCommand("fontSize",!1,o);if("fontName"===t)return n.name&&e.util.deprecated(".name option for fontName command",".value","6.0.0"),o=n.value||n.name,this.options.ownerDocument.execCommand("fontName",!1,o);if("createLink"===t)return this.createLink(n);if("image"===t){var r=this.options.contentWindow.getSelection().toString().trim();return this.options.ownerDocument.execCommand("insertImage",!1,r)}if("html"===t){var a=this.options.contentWindow.getSelection().toString().trim();return e.util.insertHTMLCommand(this.options.ownerDocument,a)}if(/justify([A-Za-z]*)$/g.exec(t)){var s=this.options.ownerDocument.execCommand(t,!1,null),l=e.selection.getSelectedParentElement(e.selection.getSelectionRange(this.options.ownerDocument));return l&&_.call(this,e.util.getTopBlockContainer(l)),s}return o=n&&n.value,this.options.ownerDocument.execCommand(t,!1,o)}function _(t){if(t){var n,i=Array.prototype.slice.call(t.childNodes).filter((function(e){var t="div"===e.nodeName.toLowerCase();return t&&!n&&(n=e.style.textAlign),t}));i.length&&(this.saveSelection(),i.forEach((function(t){if(t.style.textAlign===n){var i=t.lastChild;if(i){e.util.unwrap(t,this.options.ownerDocument);var o=this.options.ownerDocument.createElement("BR");i.parentNode.insertBefore(o,i.nextSibling)}}}),this),t.style.textAlign=n,this.restoreSelection())}}var S={};e.prototype={init:function(e,t){return this.options=C.call(this,this.defaults,t),this.origElements=e,this.options.elementsContainer||(this.options.elementsContainer=this.options.ownerDocument.body),this.setup()},setup:function(){this.isActive||(s.call(this,this.options.contentWindow),this.events=new e.Events(this),this.elements=[],this.addElements(this.origElements),0!==this.elements.length&&(this.isActive=!0,E.call(this),w.call(this)))},destroy:function(){this.isActive&&(this.isActive=!1,this.extensions.forEach((function(e){"function"==typeof e.destroy&&e.destroy()}),this),this.events.destroy(),this.elements.forEach((function(e){this.options.spellcheck&&(e.innerHTML=e.innerHTML),e.removeAttribute("contentEditable"),e.removeAttribute("spellcheck"),e.removeAttribute("data-medium-editor-element"),e.classList.remove("medium-editor-element"),e.removeAttribute("role"),e.removeAttribute("aria-multiline"),e.removeAttribute("medium-editor-index"),e.removeAttribute("data-medium-editor-editor-index"),e.getAttribute("medium-editor-textarea-id")&&c(e)}),this),this.elements=[],this.instanceHandleEditableKeydownEnter=null,this.instanceHandleEditableInput=null,l.call(this,this.options.contentWindow))},on:function(e,t,n,i){return this.events.attachDOMEvent(e,t,n,i),this},off:function(e,t,n,i){return this.events.detachDOMEvent(e,t,n,i),this},subscribe:function(e,t){return this.events.attachCustomEvent(e,t),this},unsubscribe:function(e,t){return this.events.detachCustomEvent(e,t),this},trigger:function(e,t,n){return this.events.triggerCustomEvent(e,t,n),this},delay:function(e){var t=this;return setTimeout((function(){t.isActive&&e()}),this.options.delay)},serialize:function(){var e,t={},n=this.elements.length;for(e=0;e<n;e+=1)t[""!==this.elements[e].id?this.elements[e].id:"element-"+e]={value:this.elements[e].innerHTML.trim()};return t},getExtensionByName:function(e){var t;return this.extensions&&this.extensions.length&&this.extensions.some((function(n){return n.name===e&&(t=n,!0)})),t},addBuiltInExtension:function(t,n){var i,o=this.getExtensionByName(t);if(o)return o;switch(t){case"anchor":i=e.util.extend({},this.options.anchor,n),o=new e.extensions.anchor(i);break;case"anchor-preview":o=new e.extensions.anchorPreview(this.options.anchorPreview);break;case"autoLink":o=new e.extensions.autoLink;break;case"fileDragging":o=new e.extensions.fileDragging(n);break;case"fontname":o=new e.extensions.fontName(this.options.fontName);break;case"fontsize":o=new e.extensions.fontSize(n);break;case"keyboardCommands":o=new e.extensions.keyboardCommands(this.options.keyboardCommands);break;case"paste":o=new e.extensions.paste(this.options.paste);break;case"placeholder":o=new e.extensions.placeholder(this.options.placeholder);break;default:e.extensions.button.isBuiltInButton(t)&&(n?(i=e.util.defaults({},n,e.extensions.button.prototype.defaults[t]),o=new e.extensions.button(i)):o=new e.extensions.button(t))}return o&&this.extensions.push(d(o,t,this)),o},stopSelectionUpdates:function(){this.preventSelectionUpdates=!0},startSelectionUpdates:function(){this.preventSelectionUpdates=!1},checkSelection:function(){var e=this.getExtensionByName("toolbar");return e&&e.checkState(),this},queryCommandState:function(e){var t,n=null;(t=/^full-(.+)$/gi.exec(e))&&(e=t[1]);try{n=this.options.ownerDocument.queryCommandState(e)}catch(e){n=null}return n},execAction:function(t,n){var i,o;return(i=/^full-(.+)$/gi.exec(t))?(this.saveSelection(),this.selectAllContents(),o=N.call(this,i[1],n),this.restoreSelection()):o=N.call(this,t,n),"insertunorderedlist"!==t&&"insertorderedlist"!==t||e.util.cleanListDOM(this.options.ownerDocument,this.getSelectedParentElement()),this.checkSelection(),o},getSelectedParentElement:function(t){return void 0===t&&(t=this.options.contentWindow.getSelection().getRangeAt(0)),e.selection.getSelectedParentElement(t)},selectAllContents:function(){var t=e.selection.getSelectionElement(this.options.contentWindow);if(t){for(;1===t.children.length;)t=t.children[0];this.selectElement(t)}},selectElement:function(t){e.selection.selectNode(t,this.options.ownerDocument);var n=e.selection.getSelectionElement(this.options.contentWindow);n&&this.events.focusElement(n)},getFocusedElement:function(){var e;return this.elements.some((function(t){return!e&&t.getAttribute("data-medium-focused")&&(e=t),!!e}),this),e},exportSelection:function(){var t=e.selection.getSelectionElement(this.options.contentWindow),n=this.elements.indexOf(t),i=null;return n>=0&&(i=e.selection.exportSelection(t,this.options.ownerDocument)),null!==i&&0!==n&&(i.editableElementIndex=n),i},saveSelection:function(){this.selectionState=this.exportSelection()},importSelection:function(t,n){if(t){var i=this.elements[t.editableElementIndex||0];e.selection.importSelection(t,i,this.options.ownerDocument,n)}},restoreSelection:function(){this.importSelection(this.selectionState)},createLink:function(t){var n,i=e.selection.getSelectionElement(this.options.contentWindow),o={};if(-1!==this.elements.indexOf(i)){try{if(this.events.disableCustomEvent("editableInput"),t.url&&e.util.deprecated(".url option for createLink",".value","6.0.0"),(n=t.url||t.value)&&n.trim().length>0){var r=this.options.contentWindow.getSelection();if(r){var a,s,l,u,c=r.getRangeAt(0),d=c.commonAncestorContainer;if(3===c.endContainer.nodeType&&3!==c.startContainer.nodeType&&0===c.startOffset&&c.startContainer.firstChild===c.endContainer&&(d=c.endContainer),s=e.util.getClosestBlockContainer(c.startContainer),l=e.util.getClosestBlockContainer(c.endContainer),3!==d.nodeType&&0!==d.textContent.length&&s===l){var h=s||i,f=this.options.ownerDocument.createDocumentFragment();this.execAction("unlink"),a=this.exportSelection(),f.appendChild(h.cloneNode(!0)),i===h?e.selection.select(this.options.ownerDocument,h.firstChild,0,h.lastChild,3===h.lastChild.nodeType?h.lastChild.nodeValue.length:h.lastChild.childNodes.length):e.selection.select(this.options.ownerDocument,h,0,h,h.childNodes.length);var p=this.exportSelection();0===(u=e.util.findOrCreateMatchingTextNodes(this.options.ownerDocument,f,{start:a.start-p.start,end:a.end-p.start,editableElementIndex:a.editableElementIndex})).length&&((f=this.options.ownerDocument.createDocumentFragment()).appendChild(d.cloneNode(!0)),u=[f.firstChild.firstChild,f.firstChild.lastChild]),e.util.createLink(this.options.ownerDocument,u,n.trim());var g=(f.firstChild.innerHTML.match(/^\s+/)||[""])[0].length;e.util.insertHTMLCommand(this.options.ownerDocument,f.firstChild.innerHTML.replace(/^\s+/,"")),a.start-=g,a.end-=g,this.importSelection(a)}else this.options.ownerDocument.execCommand("createLink",!1,n);this.options.targetBlank||"_blank"===t.target?e.util.setTargetBlank(e.selection.getSelectionStart(this.options.ownerDocument),n):e.util.removeTargetBlank(e.selection.getSelectionStart(this.options.ownerDocument),n),t.buttonClass&&e.util.addClassToAnchors(e.selection.getSelectionStart(this.options.ownerDocument),t.buttonClass)}}if(this.options.targetBlank||"_blank"===t.target||t.buttonClass){(o=this.options.ownerDocument.createEvent("HTMLEvents")).initEvent("input",!0,!0,this.options.contentWindow);for(var v=0,m=this.elements.length;v<m;v+=1)this.elements[v].dispatchEvent(o)}}finally{this.events.enableCustomEvent("editableInput")}this.events.triggerCustomEvent("editableInput",o,i)}},cleanPaste:function(e){this.getExtensionByName("paste").cleanPaste(e)},pasteHTML:function(e,t){this.getExtensionByName("paste").pasteHTML(e,t)},setContent:function(e,t){if(t=t||0,this.elements[t]){var n=this.elements[t];n.innerHTML=e,this.checkContentChanged(n)}},getContent:function(e){return e=e||0,this.elements[e]?this.elements[e].innerHTML.trim():null},checkContentChanged:function(t){t=t||e.selection.getSelectionElement(this.options.contentWindow),this.events.updateInput(t,{target:t,currentTarget:t})},resetContent:function(e){if(e){var t=this.elements.indexOf(e);-1!==t&&this.setContent(S[e.getAttribute("medium-editor-index")],t)}else this.elements.forEach((function(e,t){this.setContent(S[e.getAttribute("medium-editor-index")],t)}),this)},addElements:function(e){var t=u(e,this.options.ownerDocument,!0);if(0===t.length)return!1;t.forEach((function(e){e=x.call(this,e,this.id),this.elements.push(e),this.trigger("addElement",{target:e,currentTarget:e},e)}),this)},removeElements:function(e){var t=u(e,this.options.ownerDocument).map((function(e){return e.getAttribute("medium-editor-textarea-id")&&e.parentNode?e.parentNode.querySelector('div[medium-editor-textarea-id="'+e.getAttribute("medium-editor-textarea-id")+'"]'):e}));this.elements=this.elements.filter((function(e){return-1===t.indexOf(e)||(this.events.cleanupElement(e),e.getAttribute("medium-editor-textarea-id")&&c(e),this.trigger("removeElement",{target:e,currentTarget:e},e),!1)}),this)}},e.getEditorFromElement=function(e){var t=e.getAttribute("data-medium-editor-editor-index"),n=e&&e.ownerDocument&&(e.ownerDocument.defaultView||e.ownerDocument.parentWindow);return n&&n._mediumEditors&&n._mediumEditors[t]?n._mediumEditors[t]:null}}(),e.prototype.defaults={activeButtonClass:"medium-editor-button-active",buttonLabels:!1,delay:0,disableReturn:!1,disableDoubleReturn:!1,disableExtraSpaces:!1,disableEditing:!1,autoLink:!1,elementsContainer:!1,contentWindow:window,ownerDocument:document,targetBlank:!1,extensions:{},spellcheck:!0},e.parseVersionString=function(e){var t=e.split("-"),n=t[0].split("."),i=t.length>1?t[1]:"";return{major:parseInt(n[0],10),minor:parseInt(n[1],10),revision:parseInt(n[2],10),preRelease:i,toString:function(){return[n[0],n[1],n[2]].join(".")+(i?"-"+i:"")}}},e.version=e.parseVersionString.call(this,"5.23.3"),e}())}({get exports(){return vv},set exports(e){vv=e}});var mv=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},yv=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),bv=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],i=!0,o=!1,r=void 0;try{for(var a,s=e[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){o=!0,r=e}finally{try{!i&&s.return&&s.return()}finally{if(o)throw r}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")};String.prototype.startsWith=String.prototype.startsWith||function(e){return 0===this.indexOf(e)},String.prototype.padStart=String.prototype.padStart||function(e,t){for(var n=this;n.length<e;)n=t+n;return n};var xv={cb:"0f8ff",tqw:"aebd7",q:"-ffff",qmrn:"7fffd4",zr:"0ffff",bg:"5f5dc",bsq:"e4c4",bck:"---",nch:"ebcd",b:"--ff",bvt:"8a2be2",brwn:"a52a2a",brw:"deb887",ctb:"5f9ea0",hrt:"7fff-",chcT:"d2691e",cr:"7f50",rnw:"6495ed",crns:"8dc",crms:"dc143c",cn:"-ffff",Db:"--8b",Dcn:"-8b8b",Dgnr:"b8860b",Dgr:"a9a9a9",Dgrn:"-64-",Dkhk:"bdb76b",Dmgn:"8b-8b",Dvgr:"556b2f",Drng:"8c-",Drch:"9932cc",Dr:"8b--",Dsmn:"e9967a",Dsgr:"8fbc8f",DsTb:"483d8b",DsTg:"2f4f4f",Dtrq:"-ced1",Dvt:"94-d3",ppnk:"1493",pskb:"-bfff",mgr:"696969",grb:"1e90ff",rbrc:"b22222",rwht:"af0",stg:"228b22",chs:"-ff",gnsb:"dcdcdc",st:"8f8ff",g:"d7-",gnr:"daa520",gr:"808080",grn:"-8-0",grnw:"adff2f",hnw:"0fff0",htpn:"69b4",nnr:"cd5c5c",ng:"4b-82",vr:"0",khk:"0e68c",vnr:"e6e6fa",nrb:"0f5",wngr:"7cfc-",mnch:"acd",Lb:"add8e6",Lcr:"08080",Lcn:"e0ffff",Lgnr:"afad2",Lgr:"d3d3d3",Lgrn:"90ee90",Lpnk:"b6c1",Lsmn:"a07a",Lsgr:"20b2aa",Lskb:"87cefa",LsTg:"778899",Lstb:"b0c4de",Lw:"e0",m:"-ff-",mgrn:"32cd32",nn:"af0e6",mgnt:"-ff",mrn:"8--0",mqm:"66cdaa",mmb:"--cd",mmrc:"ba55d3",mmpr:"9370db",msg:"3cb371",mmsT:"7b68ee","":"-fa9a",mtr:"48d1cc",mmvt:"c71585",mnLb:"191970",ntc:"5fffa",mstr:"e4e1",mccs:"e4b5",vjw:"dead",nv:"--80",c:"df5e6",v:"808-0",vrb:"6b8e23",rng:"a5-",rngr:"45-",rch:"da70d6",pgnr:"eee8aa",pgrn:"98fb98",ptrq:"afeeee",pvtr:"db7093",ppwh:"efd5",pchp:"dab9",pr:"cd853f",pnk:"c0cb",pm:"dda0dd",pwrb:"b0e0e6",prp:"8-080",cc:"663399",r:"--",sbr:"bc8f8f",rb:"4169e1",sbrw:"8b4513",smn:"a8072",nbr:"4a460",sgrn:"2e8b57",ssh:"5ee",snn:"a0522d",svr:"c0c0c0",skb:"87ceeb",sTb:"6a5acd",sTgr:"708090",snw:"afa",n:"-ff7f",stb:"4682b4",tn:"d2b48c",t:"-8080",thst:"d8bfd8",tmT:"6347",trqs:"40e0d0",vt:"ee82ee",whT:"5deb3",wht:"",hts:"5f5f5",w:"-",wgrn:"9acd32"};function wv(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return(t>0?e.toFixed(t).replace(/0+$/,"").replace(/\.$/,""):e.toString())||"0"}var Ev=function(){function e(t,n,i,o){mv(this,e);var r=this;if(void 0===t);else if(Array.isArray(t))this.rgba=t;else if(void 0===i){var a=t&&""+t;a&&function(t){if(t.startsWith("hsl")){var n=t.match(/([\-\d\.e]+)/g).map(Number),i=bv(n,4),o=i[0],a=i[1],s=i[2],l=i[3];void 0===l&&(l=1),o/=360,a/=100,s/=100,r.hsla=[o,a,s,l]}else if(t.startsWith("rgb")){var u=t.match(/([\-\d\.e]+)/g).map(Number),c=bv(u,4),d=c[0],h=c[1],f=c[2],p=c[3];void 0===p&&(p=1),r.rgba=[d,h,f,p]}else t.startsWith("#")?r.rgba=e.hexToRgb(t):r.rgba=e.nameToRgb(t)||e.hexToRgb(t)}(a.toLowerCase())}else this.rgba=[t,n,i,void 0===o?1:o]}return yv(e,[{key:"printRGB",value:function(e){var t=(e?this.rgba:this.rgba.slice(0,3)).map((function(e,t){return wv(e,3===t?3:0)}));return e?"rgba("+t+")":"rgb("+t+")"}},{key:"printHSL",value:function(e){var t=[360,100,100,1],n=["","%","%",""],i=(e?this.hsla:this.hsla.slice(0,3)).map((function(e,i){return wv(e*t[i],3===i?3:1)+n[i]}));return e?"hsla("+i+")":"hsl("+i+")"}},{key:"printHex",value:function(e){var t=this.hex;return e?t:t.substring(0,7)}},{key:"rgba",get:function(){if(this._rgba)return this._rgba;if(!this._hsla)throw new Error("No color is set");return this._rgba=e.hslToRgb(this._hsla)},set:function(e){3===e.length&&(e[3]=1),this._rgba=e,this._hsla=null}},{key:"rgbString",get:function(){return this.printRGB()}},{key:"rgbaString",get:function(){return this.printRGB(!0)}},{key:"hsla",get:function(){if(this._hsla)return this._hsla;if(!this._rgba)throw new Error("No color is set");return this._hsla=e.rgbToHsl(this._rgba)},set:function(e){3===e.length&&(e[3]=1),this._hsla=e,this._rgba=null}},{key:"hslString",get:function(){return this.printHSL()}},{key:"hslaString",get:function(){return this.printHSL(!0)}},{key:"hex",get:function(){return"#"+this.rgba.map((function(e,t){return t<3?e.toString(16):Math.round(255*e).toString(16)})).map((function(e){return e.padStart(2,"0")})).join("")},set:function(t){this.rgba=e.hexToRgb(t)}}],[{key:"hexToRgb",value:function(e){var t=(e.startsWith("#")?e.slice(1):e).replace(/^(\w{3})$/,"$1F").replace(/^(\w)(\w)(\w)(\w)$/,"$1$1$2$2$3$3$4$4").replace(/^(\w{6})$/,"$1FF");if(!t.match(/^([0-9a-fA-F]{8})$/))throw new Error("Unknown hex color; "+e);var n=t.match(/^(\w\w)(\w\w)(\w\w)(\w\w)$/).slice(1).map((function(e){return parseInt(e,16)}));return n[3]=n[3]/255,n}},{key:"nameToRgb",value:function(t){var n=t.toLowerCase().replace("at","T").replace(/[aeiouyldf]/g,"").replace("ght","L").replace("rk","D").slice(-5,4),i=xv[n];return void 0===i?i:e.hexToRgb(i.replace(/\-/g,"00").padStart(6,"f"))}},{key:"rgbToHsl",value:function(e){var t=bv(e,4),n=t[0],i=t[1],o=t[2],r=t[3];n/=255,i/=255,o/=255;var a=Math.max(n,i,o),s=Math.min(n,i,o),l=void 0,u=void 0,c=(a+s)/2;if(a===s)l=u=0;else{var d=a-s;switch(u=c>.5?d/(2-a-s):d/(a+s),a){case n:l=(i-o)/d+(i<o?6:0);break;case i:l=(o-n)/d+2;break;case o:l=(n-i)/d+4}l/=6}return[l,u,c,r]}},{key:"hslToRgb",value:function(e){var t=bv(e,4),n=t[0],i=t[1],o=t[2],r=t[3],a=void 0,s=void 0,l=void 0;if(0===i)a=s=l=o;else{var u=function(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e},c=o<.5?o*(1+i):o+i-o*i,d=2*o-c;a=u(d,c,n+1/3),s=u(d,c,n),l=u(d,c,n-1/3)}var h=[255*a,255*s,255*l].map(Math.round);return h[3]=r,h}}]),e}(),Cv=function(){function e(){mv(this,e),this._events=[]}return yv(e,[{key:"add",value:function(e,t,n){e.addEventListener(t,n,!1),this._events.push({target:e,type:t,handler:n})}},{key:"remove",value:function(t,n,i){this._events=this._events.filter((function(o){var r=!0;return t&&t!==o.target&&(r=!1),n&&n!==o.type&&(r=!1),i&&i!==o.handler&&(r=!1),r&&e._doRemove(o.target,o.type,o.handler),!r}))}},{key:"destroy",value:function(){this._events.forEach((function(t){return e._doRemove(t.target,t.type,t.handler)})),this._events=[]}}],[{key:"_doRemove",value:function(e,t,n){e.removeEventListener(t,n,!1)}}]),e}();function Nv(e,t,n){var i=!1;function o(e,t,n){return Math.max(t,Math.min(e,n))}function r(e,r,a){if(a&&(i=!0),i){e.preventDefault();var s=t.getBoundingClientRect(),l=s.width,u=s.height,c=r.clientX,d=r.clientY,h=o(c-s.left,0,l),f=o(d-s.top,0,u);n(h/l,f/u)}}function a(e,t){1===(void 0===e.buttons?e.which:e.buttons)?r(e,e,t):i=!1}function s(e,t){1===e.touches.length?r(e,e.touches[0],t):i=!1}e.add(t,"mousedown",(function(e){a(e,!0)})),e.add(t,"touchstart",(function(e){s(e,!0)})),e.add(window,"mousemove",a),e.add(t,"touchmove",s),e.add(window,"mouseup",(function(e){i=!1})),e.add(t,"touchend",(function(e){i=!1})),e.add(t,"touchcancel",(function(e){i=!1}))}var _v="keydown",Sv="mousedown",Mv="focusin";function Tv(e,t){return(t||document).querySelector(e)}function Av(e,t,n,i,o){e.add(t,_v,(function(e){n.indexOf(e.key)>=0&&i(e)}))}var kv=function(){function e(t){mv(this,e),this.settings={popup:"right",layout:"default",alpha:!0,editor:!0,editorFormat:"hex",cancelButton:!1,defaultColor:"#0cf"},this._events=new Cv,this.onChange=null,this.onDone=null,this.onOpen=null,this.onClose=null,this.setOptions(t)}return yv(e,[{key:"setOptions",value:function(e){var t=this;if(e){var n=this.settings;if(e instanceof HTMLElement)n.parent=e;else{n.parent&&e.parent&&n.parent!==e.parent&&(this._events.remove(n.parent),this._popupInited=!1),function(e,t){for(var n in e)t[n]=e[n]}(e,n),e.onChange&&(this.onChange=e.onChange),e.onDone&&(this.onDone=e.onDone),e.onOpen&&(this.onOpen=e.onOpen),e.onClose&&(this.onClose=e.onClose);var i=e.color||e.colour;i&&this._setColor(i)}var o=n.parent;if(o&&n.popup&&!this._popupInited){var r=function(e){return t.openHandler(e)};this._events.add(o,"click",r),Av(this._events,o,[" ","Spacebar","Enter"],r),this._popupInited=!0}else e.parent&&!n.popup&&this.show()}}},{key:"openHandler",value:function(e){if(this.show()){e&&e.preventDefault(),this.settings.parent.style.pointerEvents="none";var t=e&&e.type===_v?this._domEdit:this.domElement;setTimeout((function(){return t.focus()}),100),this.onOpen&&this.onOpen(this.colour)}}},{key:"closeHandler",value:function(e){var t=e&&e.type,n=!1;if(e)if(t===Sv||t===Mv){var i=(this.__containedEvent||0)+100;e.timeStamp>i&&(n=!0)}else!function(e){e.preventDefault(),e.stopPropagation()}(e),n=!0;else n=!0;n&&this.hide()&&(this.settings.parent.style.pointerEvents="",t!==Sv&&this.settings.parent.focus(),this.onClose&&this.onClose(this.colour))}},{key:"movePopup",value:function(e,t){this.closeHandler(),this.setOptions(e),t&&this.openHandler()}},{key:"setColor",value:function(e,t){this._setColor(e,{silent:t})}},{key:"_setColor",value:function(e,t){if("string"==typeof e&&(e=e.trim()),e){t=t||{};var n=void 0;try{n=new Ev(e)}catch(e){if(t.failSilently)return;throw e}if(!this.settings.alpha){var i=n.hsla;i[3]=1,n.hsla=i}this.colour=this.color=n,this._setHSLA(null,null,null,null,t)}}},{key:"setColour",value:function(e,t){this.setColor(e,t)}},{key:"show",value:function(){if(!this.settings.parent)return!1;if(this.domElement){var e=this._toggleDOM(!0);return this._setPosition(),e}var t,n,i=this.settings.template||'<div class="picker_wrapper" tabindex="-1"><div class="picker_arrow"></div><div class="picker_hue picker_slider"><div class="picker_selector"></div></div><div class="picker_sl"><div class="picker_selector"></div></div><div class="picker_alpha picker_slider"><div class="picker_selector"></div></div><div class="picker_editor"><input aria-label="Type a color name or hex value"/></div><div class="picker_sample"></div><div class="picker_done"><button>Ok</button></div><div class="picker_cancel"><button>Cancel</button></div></div>',o=(t=i,(n=document.createElement("div")).innerHTML=t,n.firstElementChild);return this.domElement=o,this._domH=Tv(".picker_hue",o),this._domSL=Tv(".picker_sl",o),this._domA=Tv(".picker_alpha",o),this._domEdit=Tv(".picker_editor input",o),this._domSample=Tv(".picker_sample",o),this._domOkay=Tv(".picker_done button",o),this._domCancel=Tv(".picker_cancel button",o),o.classList.add("layout_"+this.settings.layout),this.settings.alpha||o.classList.add("no_alpha"),this.settings.editor||o.classList.add("no_editor"),this.settings.cancelButton||o.classList.add("no_cancel"),this._ifPopup((function(){return o.classList.add("popup")})),this._setPosition(),this.colour?this._updateUI():this._setColor(this.settings.defaultColor),this._bindEvents(),!0}},{key:"hide",value:function(){return this._toggleDOM(!1)}},{key:"destroy",value:function(){this._events.destroy(),this.domElement&&this.settings.parent.removeChild(this.domElement)}},{key:"_bindEvents",value:function(){var e=this,t=this,n=this.domElement,i=this._events;function o(e,t,n){i.add(e,t,n)}o(n,"click",(function(e){return e.preventDefault()})),Nv(i,this._domH,(function(e,n){return t._setHSLA(e)})),Nv(i,this._domSL,(function(e,n){return t._setHSLA(null,e,1-n)})),this.settings.alpha&&Nv(i,this._domA,(function(e,n){return t._setHSLA(null,null,null,1-n)}));var r=this._domEdit;o(r,"input",(function(e){t._setColor(this.value,{fromEditor:!0,failSilently:!0})})),o(r,"focus",(function(e){var t=this;t.selectionStart===t.selectionEnd&&t.select()})),this._ifPopup((function(){var t=function(t){return e.closeHandler(t)};o(window,Sv,t),o(window,Mv,t),Av(i,n,["Esc","Escape"],t);var r=function(t){e.__containedEvent=t.timeStamp};o(n,Sv,r),o(n,Mv,r),o(e._domCancel,"click",t)}));var a=function(t){e._ifPopup((function(){return e.closeHandler(t)})),e.onDone&&e.onDone(e.colour)};o(this._domOkay,"click",a),Av(i,n,["Enter"],a)}},{key:"_setPosition",value:function(){var e=this.settings.parent,t=this.domElement;e!==t.parentNode&&e.appendChild(t),this._ifPopup((function(n){"static"===getComputedStyle(e).position&&(e.style.position="relative");var i=!0===n?"popup_right":"popup_"+n;["popup_top","popup_bottom","popup_left","popup_right"].forEach((function(e){e===i?t.classList.add(e):t.classList.remove(e)})),t.classList.add(i)}))}},{key:"_setHSLA",value:function(e,t,n,i,o){o=o||{};var r=this.colour,a=r.hsla;[e,t,n,i].forEach((function(e,t){(e||0===e)&&(a[t]=e)})),r.hsla=a,this._updateUI(o),this.onChange&&!o.silent&&this.onChange(r)}},{key:"_updateUI",value:function(e){if(this.domElement){e=e||{};var t=this.colour,n=t.hsla,i="hsl("+360*n[0]+", 100%, 50%)",o=t.hslString,r=t.hslaString,a=this._domH,s=this._domSL,l=this._domA,u=Tv(".picker_selector",a),c=Tv(".picker_selector",s),d=Tv(".picker_selector",l);y(0,u,n[0]),this._domSL.style.backgroundColor=this._domH.style.color=i,y(0,c,n[1]),b(0,c,1-n[2]),s.style.color=o,b(0,d,1-n[3]);var h=o,f=h.replace("hsl","hsla").replace(")",", 0)"),p="linear-gradient("+[h,f]+")";if(this._domA.style.background=p+", linear-gradient(45deg, lightgrey 25%, transparent 25%, transparent 75%, lightgrey 75%) 0 0 / 2em 2em,\n                   linear-gradient(45deg, lightgrey 25%,       white 25%,       white 75%, lightgrey 75%) 1em 1em / 2em 2em",!e.fromEditor){var g=this.settings.editorFormat,v=this.settings.alpha,m=void 0;switch(g){case"rgb":m=t.printRGB(v);break;case"hsl":m=t.printHSL(v);break;default:m=t.printHex(v)}this._domEdit.value=m}this._domSample.style.color=r}function y(e,t,n){t.style.left=100*n+"%"}function b(e,t,n){t.style.top=100*n+"%"}}},{key:"_ifPopup",value:function(e,t){this.settings.parent&&this.settings.popup?e&&e(this.settings.popup):t&&t()}},{key:"_toggleDOM",value:function(e){var t=this.domElement;if(!t)return!1;var n=e?"":"none",i=t.style.display!==n;return i&&(t.style.display=n),i}}]),e}(),Rv=document.createElement("style");Rv.textContent='.picker_wrapper.no_alpha .picker_alpha{display:none}.picker_wrapper.no_editor .picker_editor{position:absolute;z-index:-1;opacity:0}.picker_wrapper.no_cancel .picker_cancel{display:none}.layout_default.picker_wrapper{display:flex;flex-flow:row wrap;justify-content:space-between;align-items:stretch;font-size:10px;width:25em;padding:.5em}.layout_default.picker_wrapper input,.layout_default.picker_wrapper button{font-size:1rem}.layout_default.picker_wrapper>*{margin:.5em}.layout_default.picker_wrapper::before{content:"";display:block;width:100%;height:0;order:1}.layout_default .picker_slider,.layout_default .picker_selector{padding:1em}.layout_default .picker_hue{width:100%}.layout_default .picker_sl{flex:1 1 auto}.layout_default .picker_sl::before{content:"";display:block;padding-bottom:100%}.layout_default .picker_editor{order:1;width:6.5rem}.layout_default .picker_editor input{width:100%;height:100%}.layout_default .picker_sample{order:1;flex:1 1 auto}.layout_default .picker_done,.layout_default .picker_cancel{order:1}.picker_wrapper{box-sizing:border-box;background:#f2f2f2;box-shadow:0 0 0 1px silver;cursor:default;font-family:sans-serif;color:#444;pointer-events:auto}.picker_wrapper:focus{outline:none}.picker_wrapper button,.picker_wrapper input{box-sizing:border-box;border:none;box-shadow:0 0 0 1px silver;outline:none}.picker_wrapper button:focus,.picker_wrapper button:active,.picker_wrapper input:focus,.picker_wrapper input:active{box-shadow:0 0 2px 1px #1e90ff}.picker_wrapper button{padding:.4em .6em;cursor:pointer;background-color:#f5f5f5;background-image:linear-gradient(0deg, gainsboro, transparent)}.picker_wrapper button:active{background-image:linear-gradient(0deg, transparent, gainsboro)}.picker_wrapper button:hover{background-color:#fff}.picker_selector{position:absolute;z-index:1;display:block;-webkit-transform:translate(-50%, -50%);transform:translate(-50%, -50%);border:2px solid #fff;border-radius:100%;box-shadow:0 0 3px 1px #67b9ff;background:currentColor;cursor:pointer}.picker_slider .picker_selector{border-radius:2px}.picker_hue{position:relative;background-image:linear-gradient(90deg, red, yellow, lime, cyan, blue, magenta, red);box-shadow:0 0 0 1px silver}.picker_sl{position:relative;box-shadow:0 0 0 1px silver;background-image:linear-gradient(180deg, white, rgba(255, 255, 255, 0) 50%),linear-gradient(0deg, black, rgba(0, 0, 0, 0) 50%),linear-gradient(90deg, #808080, rgba(128, 128, 128, 0))}.picker_alpha,.picker_sample{position:relative;background:linear-gradient(45deg, lightgrey 25%, transparent 25%, transparent 75%, lightgrey 75%) 0 0/2em 2em,linear-gradient(45deg, lightgrey 25%, white 25%, white 75%, lightgrey 75%) 1em 1em/2em 2em;box-shadow:0 0 0 1px silver}.picker_alpha .picker_selector,.picker_sample .picker_selector{background:none}.picker_editor input{font-family:monospace;padding:.2em .4em}.picker_sample::before{content:"";position:absolute;display:block;width:100%;height:100%;background:currentColor}.picker_arrow{position:absolute;z-index:-1}.picker_wrapper.popup{position:absolute;z-index:2;margin:1.5em}.picker_wrapper.popup,.picker_wrapper.popup .picker_arrow::before,.picker_wrapper.popup .picker_arrow::after{background:#f2f2f2;box-shadow:0 0 10px 1px rgba(0,0,0,.4)}.picker_wrapper.popup .picker_arrow{width:3em;height:3em;margin:0}.picker_wrapper.popup .picker_arrow::before,.picker_wrapper.popup .picker_arrow::after{content:"";display:block;position:absolute;top:0;left:0;z-index:-99}.picker_wrapper.popup .picker_arrow::before{width:100%;height:100%;-webkit-transform:skew(45deg);transform:skew(45deg);-webkit-transform-origin:0 100%;transform-origin:0 100%}.picker_wrapper.popup .picker_arrow::after{width:150%;height:150%;box-shadow:none}.popup.popup_top{bottom:100%;left:0}.popup.popup_top .picker_arrow{bottom:0;left:0;-webkit-transform:rotate(-90deg);transform:rotate(-90deg)}.popup.popup_bottom{top:100%;left:0}.popup.popup_bottom .picker_arrow{top:0;left:0;-webkit-transform:rotate(90deg) scale(1, -1);transform:rotate(90deg) scale(1, -1)}.popup.popup_left{top:0;right:100%}.popup.popup_left .picker_arrow{top:0;right:0;-webkit-transform:scale(-1, 1);transform:scale(-1, 1)}.popup.popup_right{top:0;left:100%}.popup.popup_right .picker_arrow{top:0;left:0}',document.documentElement.firstElementChild.appendChild(Rv),kv.StyleElement=Rv;var Ov={};!function(e){e.exports=function(){var e="object",t="function",n="undefined",i=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer"],o=["setStart","setStartBefore","setStartAfter","setEnd","setEndBefore","setEndAfter","collapse","selectNode","selectNodeContents","compareBoundaryPoints","deleteContents","extractContents","cloneContents","insertNode","surroundContents","cloneRange","toString","detach"],r=["boundingHeight","boundingLeft","boundingTop","boundingWidth","htmlText","text"],a=["collapse","compareEndPoints","duplicate","moveToElementText","parentElement","select","setEndPoint","getBoundingClientRect"];function s(n,i){var o=typeof n[i];return o==t||!(o!=e||!n[i])||"unknown"==o}function l(t,n){return!(typeof t[n]!=e||!t[n])}function u(e,t){return typeof e[t]!=n}function c(e){return function(t,n){for(var i=n.length;i--;)if(!e(t,n[i]))return!1;return!0}}var d=c(s),h=c(l),f=c(u);function p(e){return e&&d(e,a)&&f(e,r)}function g(e){return l(e,"body")?e.body:e.getElementsByTagName("body")[0]}var v,m,y=[].forEach?function(e,t){e.forEach(t)}:function(e,t){for(var n=0,i=e.length;n<i;++n)t(e[n],n)},b={},x=typeof window!=n&&typeof document!=n,w={isHostMethod:s,isHostObject:l,isHostProperty:u,areHostMethods:d,areHostObjects:h,areHostProperties:f,isTextRange:p,getBody:g,forEach:y},E={version:"1.3.1",initialized:!1,isBrowser:x,supported:!0,util:w,features:{},modules:b,config:{alertOnFail:!1,alertOnWarn:!1,preferTextRange:!1,autoInitialize:typeof rangyAutoInitialize==n||rangyAutoInitialize}};function C(e){typeof console!=n&&s(console,"log")}function N(e,t){x&&t?alert(e):C(e)}function _(e){E.initialized=!0,E.supported=!1,N("Rangy is not supported in this environment. Reason: "+e,E.config.alertOnFail)}function S(e){N("Rangy warning: "+e,E.config.alertOnWarn)}E.fail=_,E.warn=S,{}.hasOwnProperty?(w.extend=v=function(e,t,n){var i,o;for(var r in t)t.hasOwnProperty(r)&&(i=e[r],o=t[r],n&&null!==i&&"object"==typeof i&&null!==o&&"object"==typeof o&&v(i,o,!0),e[r]=o);return t.hasOwnProperty("toString")&&(e.toString=t.toString),e},w.createOptions=function(e,t){var n={};return v(n,t),e&&v(n,e),n}):_("hasOwnProperty not supported"),x||_("Rangy can only run in a browser"),function(){var e;if(x){var t=document.createElement("div");t.appendChild(document.createElement("span"));var n=[].slice;try{1==n.call(t.childNodes,0)[0].nodeType&&(e=function(e){return n.call(e,0)})}catch(e){}}e||(e=function(e){for(var t=[],n=0,i=e.length;n<i;++n)t[n]=e[n];return t}),w.toArray=e}(),x&&(s(document,"addEventListener")?m=function(e,t,n){e.addEventListener(t,n,!1)}:s(document,"attachEvent")?m=function(e,t,n){e.attachEvent("on"+t,n)}:_("Document does not have required addEventListener or attachEvent method"),w.addListener=m);var M=[];function T(e){return e.message||e.description||String(e)}function A(){if(x&&!E.initialized){var e,t=!1,n=!1;s(document,"createRange")&&(e=document.createRange(),d(e,o)&&f(e,i)&&(t=!0));var r=g(document);if(r&&"body"==r.nodeName.toLowerCase())if(r&&s(r,"createTextRange")&&p(e=r.createTextRange())&&(n=!0),t||n){var a;for(var l in E.initialized=!0,E.features={implementsDomRange:t,implementsTextRange:n},b)(a=b[l])instanceof D&&a.init(a,E);for(var u=0,c=M.length;u<c;++u)try{M[u](E)}catch(e){C("Rangy init listener threw an exception. Continuing. Detail: "+T(e))}}else _("Neither Range nor TextRange are available");else _("No body element found")}}function k(e,t,n){n&&(e+=" in module "+n.name),E.warn("DEPRECATED: "+e+" is deprecated. Please use "+t+" instead.")}function R(e,t,n,i){e[t]=function(){return k(t,n,i),e[n].apply(e,w.toArray(arguments))}}w.deprecationNotice=k,w.createAliasForDeprecatedMethod=R,E.init=A,E.addInitListener=function(e){E.initialized?e(E):M.push(e)};var O=[];function P(e){e=e||window,A();for(var t=0,n=O.length;t<n;++t)O[t](e)}function D(e,t,n){this.name=e,this.dependencies=t,this.initialized=!1,this.supported=!1,this.initializer=n}function I(e,t,n){var i=new D(e,t,(function(t){if(!t.initialized){t.initialized=!0;try{n(E,t),t.supported=!0}catch(t){C("Module '"+e+"' failed to load: "+T(t)),t.stack&&C(t.stack)}}}));return b[e]=i,i}function L(){}function B(){}E.addShimListener=function(e){O.push(e)},x&&(E.shim=E.createMissingNativeApi=P,R(E,"createMissingNativeApi","shim")),D.prototype={init:function(){for(var e,t,n=this.dependencies||[],i=0,o=n.length;i<o;++i){if(t=n[i],!((e=b[t])&&e instanceof D))throw new Error("required module '"+t+"' not found");if(e.init(),!e.supported)throw new Error("required module '"+t+"' not supported")}this.initializer(this)},fail:function(e){throw this.initialized=!0,this.supported=!1,new Error(e)},warn:function(e){E.warn("Module "+this.name+": "+e)},deprecationNotice:function(e,t){E.warn("DEPRECATED: "+e+" in module "+this.name+" is deprecated. Please use "+t+" instead")},createError:function(e){return new Error("Error in Rangy "+this.name+" module: "+e)}},E.createModule=function(e){var t,n;2==arguments.length?(t=arguments[1],n=[]):(t=arguments[2],n=arguments[1]);var i=I(e,n,t);E.initialized&&E.supported&&i.init()},E.createCoreModule=function(e,t,n){I(e,t,n)},E.RangePrototype=L,E.rangePrototype=new L,E.selectionPrototype=new B,E.createCoreModule("DomUtil",[],(function(e,t){var n="undefined",i=e.util,o=i.getBody;i.areHostMethods(document,["createDocumentFragment","createElement","createTextNode"])||t.fail("document missing a Node creation method"),i.isHostMethod(document,"getElementsByTagName")||t.fail("document missing getElementsByTagName method");var r=document.createElement("div");i.areHostMethods(r,["insertBefore","appendChild","cloneNode"]||!i.areHostObjects(r,["previousSibling","nextSibling","childNodes","parentNode"]))||t.fail("Incomplete Element implementation"),i.isHostProperty(r,"innerHTML")||t.fail("Element is missing innerHTML property");var a=document.createTextNode("test");i.areHostMethods(a,["splitText","deleteData","insertData","appendData","cloneNode"]||!i.areHostObjects(r,["previousSibling","nextSibling","childNodes","parentNode"])||!i.areHostProperties(a,["data"]))||t.fail("Incomplete Text Node implementation");var s=function(e,t){for(var n=e.length;n--;)if(e[n]===t)return!0;return!1};function l(e){var t;return typeof e.namespaceURI==n||null===(t=e.namespaceURI)||"http://www.w3.org/1999/xhtml"==t}function u(e){var t=e.parentNode;return 1==t.nodeType?t:null}function c(e){for(var t=0;e=e.previousSibling;)++t;return t}function d(e){switch(e.nodeType){case 7:case 10:return 0;case 3:case 8:return e.length;default:return e.childNodes.length}}function h(e,t){var n,i=[];for(n=e;n;n=n.parentNode)i.push(n);for(n=t;n;n=n.parentNode)if(s(i,n))return n;return null}function f(e,t,n){for(var i=n?t:t.parentNode;i;){if(i===e)return!0;i=i.parentNode}return!1}function p(e,t){return f(e,t,!0)}function g(e,t,n){for(var i,o=n?e:e.parentNode;o;){if((i=o.parentNode)===t)return o;o=i}return null}function v(e){var t=e.nodeType;return 3==t||4==t||8==t}function m(e){if(!e)return!1;var t=e.nodeType;return 3==t||8==t}function y(e,t){var n=t.nextSibling,i=t.parentNode;return n?i.insertBefore(e,n):i.appendChild(e),e}function b(e,t,n){var i=e.cloneNode(!1);if(i.deleteData(0,t),e.deleteData(t,e.length-t),y(i,e),n)for(var o,r=0;o=n[r++];)o.node==e&&o.offset>t?(o.node=i,o.offset-=t):o.node==e.parentNode&&o.offset>c(e)&&++o.offset;return i}function x(e){if(9==e.nodeType)return e;if(typeof e.ownerDocument!=n)return e.ownerDocument;if(typeof e.document!=n)return e.document;if(e.parentNode)return x(e.parentNode);throw t.createError("getDocument: no document found for node")}function w(e){var i=x(e);if(typeof i.defaultView!=n)return i.defaultView;if(typeof i.parentWindow!=n)return i.parentWindow;throw t.createError("Cannot get a window object for node")}function E(e){if(typeof e.contentDocument!=n)return e.contentDocument;if(typeof e.contentWindow!=n)return e.contentWindow.document;throw t.createError("getIframeDocument: No Document object found for iframe element")}function C(e){if(typeof e.contentWindow!=n)return e.contentWindow;if(typeof e.contentDocument!=n)return e.contentDocument.defaultView;throw t.createError("getIframeWindow: No Window object found for iframe element")}function N(e){return e&&i.isHostMethod(e,"setTimeout")&&i.isHostObject(e,"document")}function _(e,t,n){var o;if(e?i.isHostProperty(e,"nodeType")?o=1==e.nodeType&&"iframe"==e.tagName.toLowerCase()?E(e):x(e):N(e)&&(o=e.document):o=document,!o)throw t.createError(n+"(): Parameter must be a Window object or DOM node");return o}function S(e){for(var t;t=e.parentNode;)e=t;return e}function M(e,n,i,o){var r,a,s,l,u;if(e==i)return n===o?0:n<o?-1:1;if(r=g(i,e,!0))return n<=c(r)?-1:1;if(r=g(e,i,!0))return c(r)<o?-1:1;if(!(a=h(e,i)))throw new Error("comparePoints error: nodes have no common ancestor");if((s=e===a?a:g(e,a,!0))===(l=i===a?a:g(i,a,!0)))throw t.createError("comparePoints got to case 4 and childA and childB are the same!");for(u=a.firstChild;u;){if(u===s)return-1;if(u===l)return 1;u=u.nextSibling}}var T,A=!1;function k(e){try{return e.parentNode,!1}catch(e){return!0}}function R(e){if(!e)return"[No node]";if(A&&k(e))return"[Broken node]";if(v(e))return'"'+e.data+'"';if(1==e.nodeType){var t=e.id?' id="'+e.id+'"':"";return"<"+e.nodeName+t+">[index:"+c(e)+",length:"+e.childNodes.length+"]["+(e.innerHTML||"[innerHTML not supported]").slice(0,25)+"]"}return e.nodeName}function O(e){for(var t,n=x(e).createDocumentFragment();t=e.firstChild;)n.appendChild(t);return n}function P(e,t,n){var i=o(e),r=e.createElement("div");r.contentEditable=""+!!n,t&&(r.innerHTML=t);var a=i.firstChild;return a?i.insertBefore(r,a):i.appendChild(r),r}function D(e){return e.parentNode.removeChild(e)}function I(e){this.root=e,this._next=e}function L(e){return new I(e)}function B(e,t){this.node=e,this.offset=t}function j(e){this.code=this[e],this.codeName=e,this.message="DOMException: "+this.codeName}!function(){var t=document.createElement("b");t.innerHTML="1";var n=t.firstChild;t.innerHTML="<br />",A=k(n),e.features.crashyTextNodes=A}(),typeof window.getComputedStyle!=n?T=function(e,t){return w(e).getComputedStyle(e,null)[t]}:typeof document.documentElement.currentStyle!=n?T=function(e,t){return e.currentStyle?e.currentStyle[t]:""}:t.fail("No means of obtaining computed style properties found"),I.prototype={_current:null,hasNext:function(){return!!this._next},next:function(){var e,t,n=this._current=this._next;if(this._current)if(e=n.firstChild)this._next=e;else{for(t=null;n!==this.root&&!(t=n.nextSibling);)n=n.parentNode;this._next=t}return this._current},detach:function(){this._current=this._next=this.root=null}},B.prototype={equals:function(e){return!!e&&this.node===e.node&&this.offset==e.offset},inspect:function(){return"[DomPosition("+R(this.node)+":"+this.offset+")]"},toString:function(){return this.inspect()}},j.prototype={INDEX_SIZE_ERR:1,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INVALID_STATE_ERR:11,INVALID_NODE_TYPE_ERR:24},j.prototype.toString=function(){return this.message},e.dom={arrayContains:s,isHtmlNamespace:l,parentElement:u,getNodeIndex:c,getNodeLength:d,getCommonAncestor:h,isAncestorOf:f,isOrIsAncestorOf:p,getClosestAncestorIn:g,isCharacterDataNode:v,isTextOrCommentNode:m,insertAfter:y,splitDataNode:b,getDocument:x,getWindow:w,getIframeWindow:C,getIframeDocument:E,getBody:o,isWindow:N,getContentDocument:_,getRootContainer:S,comparePoints:M,isBrokenNode:k,inspectNode:R,getComputedStyleProperty:T,createTestElement:P,removeNode:D,fragmentFromNodeChildren:O,createIterator:L,DomPosition:B},e.DOMException=j})),E.createCoreModule("DomRange",["DomUtil"],(function(e,t){var n=e.dom,i=e.util,o=n.DomPosition,r=e.DOMException,a=n.isCharacterDataNode,s=n.getNodeIndex,l=n.isOrIsAncestorOf,u=n.getDocument,c=n.comparePoints,d=n.splitDataNode,h=n.getClosestAncestorIn,f=n.getNodeLength,p=n.arrayContains,g=n.getRootContainer,v=e.features.crashyTextNodes,m=n.removeNode;function y(e,t){return 3!=e.nodeType&&(l(e,t.startContainer)||l(e,t.endContainer))}function b(e){return e.document||u(e.startContainer)}function x(e){return g(e.startContainer)}function w(e){return new o(e.parentNode,s(e))}function E(e){return new o(e.parentNode,s(e)+1)}function C(e,t,i){var o=11==e.nodeType?e.firstChild:e;return a(t)?i==t.length?n.insertAfter(e,t):t.parentNode.insertBefore(e,0==i?t:d(t,i)):i>=t.childNodes.length?t.appendChild(e):t.insertBefore(e,t.childNodes[i]),o}function N(e,t,n){if($(e),$(t),b(t)!=b(e))throw new r("WRONG_DOCUMENT_ERR");var i=c(e.startContainer,e.startOffset,t.endContainer,t.endOffset),o=c(e.endContainer,e.endOffset,t.startContainer,t.startOffset);return n?i<=0&&o>=0:i<0&&o>0}function _(e){for(var t,n,i,o=b(e.range).createDocumentFragment();n=e.next();){if(t=e.isPartiallySelectedSubtree(),n=n.cloneNode(!t),t&&(i=e.getSubtreeIterator(),n.appendChild(_(i)),i.detach()),10==n.nodeType)throw new r("HIERARCHY_REQUEST_ERR");o.appendChild(n)}return o}function S(e,t,i){var o,r,a,s;for(i=i||{stop:!1};a=e.next();)if(e.isPartiallySelectedSubtree()){if(!1===t(a))return void(i.stop=!0);if(S(s=e.getSubtreeIterator(),t,i),s.detach(),i.stop)return}else for(o=n.createIterator(a);r=o.next();)if(!1===t(r))return void(i.stop=!0)}function M(e){for(var t;e.next();)e.isPartiallySelectedSubtree()?(M(t=e.getSubtreeIterator()),t.detach()):e.remove()}function T(e){for(var t,n,i=b(e.range).createDocumentFragment();t=e.next();){if(e.isPartiallySelectedSubtree()?(t=t.cloneNode(!1),n=e.getSubtreeIterator(),t.appendChild(T(n)),n.detach()):e.remove(),10==t.nodeType)throw new r("HIERARCHY_REQUEST_ERR");i.appendChild(t)}return i}function A(e,t,n){var i,o=!(!t||!t.length),r=!!n;o&&(i=new RegExp("^("+t.join("|")+")$"));var s=[];return S(new R(e,!1),(function(t){if((!o||i.test(t.nodeType))&&(!r||n(t))){var l=e.startContainer;if(t!=l||!a(l)||e.startOffset!=l.length){var u=e.endContainer;t==u&&a(u)&&0==e.endOffset||s.push(t)}}})),s}function k(e){return"["+(void 0===e.getName?"Range":e.getName())+"("+n.inspectNode(e.startContainer)+":"+e.startOffset+", "+n.inspectNode(e.endContainer)+":"+e.endOffset+")]"}function R(e,t){if(this.range=e,this.clonePartiallySelectedTextNodes=t,!e.collapsed){this.sc=e.startContainer,this.so=e.startOffset,this.ec=e.endContainer,this.eo=e.endOffset;var n=e.commonAncestorContainer;this.sc===this.ec&&a(this.sc)?(this.isSingleCharacterDataNode=!0,this._first=this._last=this._next=this.sc):(this._first=this._next=this.sc!==n||a(this.sc)?h(this.sc,n,!0):this.sc.childNodes[this.so],this._last=this.ec!==n||a(this.ec)?h(this.ec,n,!0):this.ec.childNodes[this.eo-1])}}R.prototype={_current:null,_next:null,_first:null,_last:null,isSingleCharacterDataNode:!1,reset:function(){this._current=null,this._next=this._first},hasNext:function(){return!!this._next},next:function(){var e=this._current=this._next;return e&&(this._next=e!==this._last?e.nextSibling:null,a(e)&&this.clonePartiallySelectedTextNodes&&(e===this.ec&&(e=e.cloneNode(!0)).deleteData(this.eo,e.length-this.eo),this._current===this.sc&&(e=e.cloneNode(!0)).deleteData(0,this.so))),e},remove:function(){var e,t,n=this._current;!a(n)||n!==this.sc&&n!==this.ec?n.parentNode&&m(n):(e=n===this.sc?this.so:0)!=(t=n===this.ec?this.eo:n.length)&&n.deleteData(e,t-e)},isPartiallySelectedSubtree:function(){return y(this._current,this.range)},getSubtreeIterator:function(){var e;if(this.isSingleCharacterDataNode)(e=this.range.cloneRange()).collapse(!1);else{e=new me(b(this.range));var t=this._current,n=t,i=0,o=t,r=f(t);l(t,this.sc)&&(n=this.sc,i=this.so),l(t,this.ec)&&(o=this.ec,r=this.eo),ve(e,n,i,o,r)}return new R(e,this.clonePartiallySelectedTextNodes)},detach:function(){this.range=this._current=this._next=this._first=this._last=this.sc=this.so=this.ec=this.eo=null}};var O=[1,3,4,5,7,8,10],P=[2,9,11],D=[5,6,10,12],I=[1,3,4,5,7,8,10,11],L=[1,3,4,5,7,8];function B(e){return function(t,n){for(var i,o=n?t:t.parentNode;o;){if(i=o.nodeType,p(e,i))return o;o=o.parentNode}return null}}var j=B([9,11]),F=B(D),H=B([6,10,12]),W=B([1]);function z(e,t){if(H(e,t))throw new r("INVALID_NODE_TYPE_ERR")}function G(e,t){if(!p(t,e.nodeType))throw new r("INVALID_NODE_TYPE_ERR")}function U(e,t){if(t<0||t>(a(e)?e.length:e.childNodes.length))throw new r("INDEX_SIZE_ERR")}function q(e,t){if(j(e,!0)!==j(t,!0))throw new r("WRONG_DOCUMENT_ERR")}function X(e){if(F(e,!0))throw new r("NO_MODIFICATION_ALLOWED_ERR")}function V(e,t){if(!e)throw new r(t)}function K(e,t){return t<=(a(e)?e.length:e.childNodes.length)}function Y(e){return!!e.startContainer&&!!e.endContainer&&!(v&&(n.isBrokenNode(e.startContainer)||n.isBrokenNode(e.endContainer)))&&g(e.startContainer)==g(e.endContainer)&&K(e.startContainer,e.startOffset)&&K(e.endContainer,e.endOffset)}function $(e){if(!Y(e))throw new Error("Range error: Range is not valid. This usually happens after DOM mutation. Range: ("+e.inspect()+")")}var Z=document.createElement("style"),J=!1;try{Z.innerHTML="<b>x</b>",J=3==Z.firstChild.nodeType}catch(e){}e.features.htmlParsingConforms=J;var Q=J?function(e){var t=this.startContainer,i=u(t);if(!t)throw new r("INVALID_STATE_ERR");var o=null;return 1==t.nodeType?o=t:a(t)&&(o=n.parentElement(t)),(o=null===o||"HTML"==o.nodeName&&n.isHtmlNamespace(u(o).documentElement)&&n.isHtmlNamespace(o)?i.createElement("body"):o.cloneNode(!1)).innerHTML=e,n.fragmentFromNodeChildren(o)}:function(e){var t=b(this).createElement("body");return t.innerHTML=e,n.fragmentFromNodeChildren(t)};function ee(e,t){$(e);var n=e.startContainer,i=e.startOffset,o=e.endContainer,r=e.endOffset,l=n===o;a(o)&&r>0&&r<o.length&&d(o,r,t),a(n)&&i>0&&i<n.length&&(n=d(n,i,t),l?(r-=i,o=n):o==n.parentNode&&r>=s(n)&&r++,i=0),e.setStartAndEnd(n,i,o,r)}function te(e){$(e);var t=e.commonAncestorContainer.parentNode.cloneNode(!1);return t.appendChild(e.cloneContents()),t.innerHTML}var ne=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer"],ie=0,oe=1,re=2,ae=3,se=0,le=1,ue=2,ce=3;function de(e){e.START_TO_START=ie,e.START_TO_END=oe,e.END_TO_END=re,e.END_TO_START=ae,e.NODE_BEFORE=se,e.NODE_AFTER=le,e.NODE_BEFORE_AND_AFTER=ue,e.NODE_INSIDE=ce}function he(e){de(e),de(e.prototype)}function fe(e,t){return function(){$(this);var n,i=this.startContainer,o=this.startOffset,r=this.commonAncestorContainer,a=new R(this,!0);i!==r&&(i=(n=E(h(i,r,!0))).node,o=n.offset),S(a,X),a.reset();var s=e(a);return a.detach(),t(this,i,o,i,o),s}}function pe(t,n){function o(e,t){return function(n){G(n,O),G(g(n),P);var i=(e?w:E)(n);(t?r:l)(this,i.node,i.offset)}}function r(e,t,i){var o=e.endContainer,r=e.endOffset;t===e.startContainer&&i===e.startOffset||(g(t)==g(o)&&1!=c(t,i,o,r)||(o=t,r=i),n(e,t,i,o,r))}function l(e,t,i){var o=e.startContainer,r=e.startOffset;t===e.endContainer&&i===e.endOffset||(g(t)==g(o)&&-1!=c(t,i,o,r)||(o=t,r=i),n(e,o,r,t,i))}var u=function(){};u.prototype=e.rangePrototype,t.prototype=new u,i.extend(t.prototype,{setStart:function(e,t){z(e,!0),U(e,t),r(this,e,t)},setEnd:function(e,t){z(e,!0),U(e,t),l(this,e,t)},setStartAndEnd:function(){var e=arguments,t=e[0],i=e[1],o=t,r=i;switch(e.length){case 3:r=e[2];break;case 4:o=e[2],r=e[3]}z(t,!0),U(t,i),z(o,!0),U(o,r),n(this,t,i,o,r)},setBoundary:function(e,t,n){this["set"+(n?"Start":"End")](e,t)},setStartBefore:o(!0,!0),setStartAfter:o(!1,!0),setEndBefore:o(!0,!1),setEndAfter:o(!1,!1),collapse:function(e){$(this),e?n(this,this.startContainer,this.startOffset,this.startContainer,this.startOffset):n(this,this.endContainer,this.endOffset,this.endContainer,this.endOffset)},selectNodeContents:function(e){z(e,!0),n(this,e,0,e,f(e))},selectNode:function(e){z(e,!1),G(e,O);var t=w(e),i=E(e);n(this,t.node,t.offset,i.node,i.offset)},extractContents:fe(T,n),deleteContents:fe(M,n),canSurroundContents:function(){$(this),X(this.startContainer),X(this.endContainer);var e=new R(this,!0),t=e._first&&y(e._first,this)||e._last&&y(e._last,this);return e.detach(),!t},splitBoundaries:function(){ee(this)},splitBoundariesPreservingPositions:function(e){ee(this,e)},normalizeBoundaries:function(){$(this);var e,t=this.startContainer,i=this.startOffset,o=this.endContainer,r=this.endOffset,l=function(e){var t=e.nextSibling;t&&t.nodeType==e.nodeType&&(o=e,r=e.length,e.appendData(t.data),m(t))},u=function(e){var n=e.previousSibling;if(n&&n.nodeType==e.nodeType){t=e;var a=e.length;if(i=n.length,e.insertData(0,n.data),m(n),t==o)r+=i,o=t;else if(o==e.parentNode){var l=s(e);r==l?(o=e,r=a):r>l&&r--}}},c=!0;if(a(o))r==o.length?l(o):0==r&&(e=o.previousSibling)&&e.nodeType==o.nodeType&&(r=e.length,t==o&&(c=!1),e.appendData(o.data),m(o),o=e);else{if(r>0){var d=o.childNodes[r-1];d&&a(d)&&l(d)}c=!this.collapsed}if(c){if(a(t))0==i?u(t):i==t.length&&(e=t.nextSibling)&&e.nodeType==t.nodeType&&(o==e&&(o=t,r+=t.length),t.appendData(e.data),m(e));else if(i<t.childNodes.length){var h=t.childNodes[i];h&&a(h)&&u(h)}}else t=o,i=r;n(this,t,i,o,r)},collapseToPoint:function(e,t){z(e,!0),U(e,t),this.setStartAndEnd(e,t)},parentElement:function(){return $(this),this.commonAncestorContainer?W(this.commonAncestorContainer,!0):null}}),he(t)}function ge(e){e.collapsed=e.startContainer===e.endContainer&&e.startOffset===e.endOffset,e.commonAncestorContainer=e.collapsed?e.startContainer:n.getCommonAncestor(e.startContainer,e.endContainer)}function ve(e,t,i,o,r){e.startContainer=t,e.startOffset=i,e.endContainer=o,e.endOffset=r,e.document=n.getDocument(t),ge(e)}function me(e){ve(this,e,0,e,0)}i.extend(e.rangePrototype,{compareBoundaryPoints:function(e,t){var n,i,o,r;$(this),q(this.startContainer,t.startContainer);var a=e==ae||e==ie?"start":"end",s=e==oe||e==ie?"start":"end";return n=this[a+"Container"],i=this[a+"Offset"],o=t[s+"Container"],r=t[s+"Offset"],c(n,i,o,r)},insertNode:function(e){if($(this),G(e,I),X(this.startContainer),l(e,this.startContainer))throw new r("HIERARCHY_REQUEST_ERR");var t=C(e,this.startContainer,this.startOffset);this.setStartBefore(t)},cloneContents:function(){var e,t;if($(this),this.collapsed)return b(this).createDocumentFragment();if(this.startContainer===this.endContainer&&a(this.startContainer))return(e=this.startContainer.cloneNode(!0)).data=e.data.slice(this.startOffset,this.endOffset),(t=b(this).createDocumentFragment()).appendChild(e),t;var n=new R(this,!0);return e=_(n),n.detach(),e},canSurroundContents:function(){$(this),X(this.startContainer),X(this.endContainer);var e=new R(this,!0),t=e._first&&y(e._first,this)||e._last&&y(e._last,this);return e.detach(),!t},surroundContents:function(e){if(G(e,L),!this.canSurroundContents())throw new r("INVALID_STATE_ERR");var t=this.extractContents();if(e.hasChildNodes())for(;e.lastChild;)e.removeChild(e.lastChild);C(e,this.startContainer,this.startOffset),e.appendChild(t),this.selectNode(e)},cloneRange:function(){$(this);for(var e,t=new me(b(this)),n=ne.length;n--;)t[e=ne[n]]=this[e];return t},toString:function(){$(this);var e=this.startContainer;if(e===this.endContainer&&a(e))return 3==e.nodeType||4==e.nodeType?e.data.slice(this.startOffset,this.endOffset):"";var t=[],n=new R(this,!0);return S(n,(function(e){3!=e.nodeType&&4!=e.nodeType||t.push(e.data)})),n.detach(),t.join("")},compareNode:function(e){$(this);var t=e.parentNode,n=s(e);if(!t)throw new r("NOT_FOUND_ERR");var i=this.comparePoint(t,n),o=this.comparePoint(t,n+1);return i<0?o>0?ue:se:o>0?le:ce},comparePoint:function(e,t){return $(this),V(e,"HIERARCHY_REQUEST_ERR"),q(e,this.startContainer),c(e,t,this.startContainer,this.startOffset)<0?-1:c(e,t,this.endContainer,this.endOffset)>0?1:0},createContextualFragment:Q,toHtml:function(){return te(this)},intersectsNode:function(e,t){if($(this),g(e)!=x(this))return!1;var n=e.parentNode,i=s(e);if(!n)return!0;var o=c(n,i,this.endContainer,this.endOffset),r=c(n,i+1,this.startContainer,this.startOffset);return t?o<=0&&r>=0:o<0&&r>0},isPointInRange:function(e,t){return $(this),V(e,"HIERARCHY_REQUEST_ERR"),q(e,this.startContainer),c(e,t,this.startContainer,this.startOffset)>=0&&c(e,t,this.endContainer,this.endOffset)<=0},intersectsRange:function(e){return N(this,e,!1)},intersectsOrTouchesRange:function(e){return N(this,e,!0)},intersection:function(e){if(this.intersectsRange(e)){var t=c(this.startContainer,this.startOffset,e.startContainer,e.startOffset),n=c(this.endContainer,this.endOffset,e.endContainer,e.endOffset),i=this.cloneRange();return-1==t&&i.setStart(e.startContainer,e.startOffset),1==n&&i.setEnd(e.endContainer,e.endOffset),i}return null},union:function(e){if(this.intersectsOrTouchesRange(e)){var t=this.cloneRange();return-1==c(e.startContainer,e.startOffset,this.startContainer,this.startOffset)&&t.setStart(e.startContainer,e.startOffset),1==c(e.endContainer,e.endOffset,this.endContainer,this.endOffset)&&t.setEnd(e.endContainer,e.endOffset),t}throw new r("Ranges do not intersect")},containsNode:function(e,t){return t?this.intersectsNode(e,!1):this.compareNode(e)==ce},containsNodeContents:function(e){return this.comparePoint(e,0)>=0&&this.comparePoint(e,f(e))<=0},containsRange:function(e){var t=this.intersection(e);return null!==t&&e.equals(t)},containsNodeText:function(e){var t=this.cloneRange();t.selectNode(e);var n=t.getNodes([3]);if(n.length>0){t.setStart(n[0],0);var i=n.pop();return t.setEnd(i,i.length),this.containsRange(t)}return this.containsNodeContents(e)},getNodes:function(e,t){return $(this),A(this,e,t)},getDocument:function(){return b(this)},collapseBefore:function(e){this.setEndBefore(e),this.collapse(!1)},collapseAfter:function(e){this.setStartAfter(e),this.collapse(!0)},getBookmark:function(t){var i=b(this),o=e.createRange(i);t=t||n.getBody(i),o.selectNodeContents(t);var r=this.intersection(o),a=0,s=0;return r&&(o.setEnd(r.startContainer,r.startOffset),s=(a=o.toString().length)+r.toString().length),{start:a,end:s,containerNode:t}},moveToBookmark:function(e){var t=e.containerNode,n=0;this.setStart(t,0),this.collapse(!0);for(var i,o,r,a,s=[t],l=!1,u=!1;!u&&(i=s.pop());)if(3==i.nodeType)o=n+i.length,!l&&e.start>=n&&e.start<=o&&(this.setStart(i,e.start-n),l=!0),l&&e.end>=n&&e.end<=o&&(this.setEnd(i,e.end-n),u=!0),n=o;else for(r=(a=i.childNodes).length;r--;)s.push(a[r])},getName:function(){return"DomRange"},equals:function(e){return me.rangesEqual(this,e)},isValid:function(){return Y(this)},inspect:function(){return k(this)},detach:function(){}}),pe(me,ve),i.extend(me,{rangeProperties:ne,RangeIterator:R,copyComparisonConstants:he,createPrototypeRange:pe,inspect:k,toHtml:te,getRangeDocument:b,rangesEqual:function(e,t){return e.startContainer===t.startContainer&&e.startOffset===t.startOffset&&e.endContainer===t.endContainer&&e.endOffset===t.endOffset}}),e.DomRange=me})),E.createCoreModule("WrappedRange",["DomRange"],(function(e,t){var n,i,o=e.dom,r=e.util,a=o.DomPosition,s=e.DomRange,l=o.getBody,u=o.getContentDocument,c=o.isCharacterDataNode;if(e.features.implementsDomRange&&function(){var i,a,c=s.rangeProperties;function d(e){for(var t,n=c.length;n--;)e[t=c[n]]=e.nativeRange[t];e.collapsed=e.startContainer===e.endContainer&&e.startOffset===e.endOffset}function h(e,t,n,i,o){var r=e.startContainer!==t||e.startOffset!=n,a=e.endContainer!==i||e.endOffset!=o,s=!e.equals(e.nativeRange);(r||a||s)&&(e.setEnd(i,o),e.setStart(t,n))}n=function(e){if(!e)throw t.createError("WrappedRange: Range must be specified");this.nativeRange=e,d(this)},s.createPrototypeRange(n,h),(i=n.prototype).selectNode=function(e){this.nativeRange.selectNode(e),d(this)},i.cloneContents=function(){return this.nativeRange.cloneContents()},i.surroundContents=function(e){this.nativeRange.surroundContents(e),d(this)},i.collapse=function(e){this.nativeRange.collapse(e),d(this)},i.cloneRange=function(){return new n(this.nativeRange.cloneRange())},i.refresh=function(){d(this)},i.toString=function(){return this.nativeRange.toString()};var f=document.createTextNode("test");l(document).appendChild(f);var p=document.createRange();p.setStart(f,0),p.setEnd(f,0);try{p.setStart(f,1),i.setStart=function(e,t){this.nativeRange.setStart(e,t),d(this)},i.setEnd=function(e,t){this.nativeRange.setEnd(e,t),d(this)},a=function(e){return function(t){this.nativeRange[e](t),d(this)}}}catch(e){i.setStart=function(e,t){try{this.nativeRange.setStart(e,t)}catch(n){this.nativeRange.setEnd(e,t),this.nativeRange.setStart(e,t)}d(this)},i.setEnd=function(e,t){try{this.nativeRange.setEnd(e,t)}catch(n){this.nativeRange.setStart(e,t),this.nativeRange.setEnd(e,t)}d(this)},a=function(e,t){return function(n){try{this.nativeRange[e](n)}catch(i){this.nativeRange[t](n),this.nativeRange[e](n)}d(this)}}}i.setStartBefore=a("setStartBefore","setEndBefore"),i.setStartAfter=a("setStartAfter","setEndAfter"),i.setEndBefore=a("setEndBefore","setStartBefore"),i.setEndAfter=a("setEndAfter","setStartAfter"),i.selectNodeContents=function(e){this.setStartAndEnd(e,0,o.getNodeLength(e))},p.selectNodeContents(f),p.setEnd(f,3);var g=document.createRange();g.selectNodeContents(f),g.setEnd(f,4),g.setStart(f,2),-1==p.compareBoundaryPoints(p.START_TO_END,g)&&1==p.compareBoundaryPoints(p.END_TO_START,g)?i.compareBoundaryPoints=function(e,t){return e==(t=t.nativeRange||t).START_TO_END?e=t.END_TO_START:e==t.END_TO_START&&(e=t.START_TO_END),this.nativeRange.compareBoundaryPoints(e,t)}:i.compareBoundaryPoints=function(e,t){return this.nativeRange.compareBoundaryPoints(e,t.nativeRange||t)};var v=document.createElement("div");v.innerHTML="123";var m=v.firstChild,y=l(document);y.appendChild(v),p.setStart(m,1),p.setEnd(m,2),p.deleteContents(),"13"==m.data&&(i.deleteContents=function(){this.nativeRange.deleteContents(),d(this)},i.extractContents=function(){var e=this.nativeRange.extractContents();return d(this),e}),y.removeChild(v),y=null,r.isHostMethod(p,"createContextualFragment")&&(i.createContextualFragment=function(e){return this.nativeRange.createContextualFragment(e)}),l(document).removeChild(f),i.getName=function(){return"WrappedRange"},e.WrappedRange=n,e.createNativeRange=function(e){return(e=u(e,t,"createNativeRange")).createRange()}}(),e.features.implementsTextRange){var d=function(e){var t=e.parentElement(),n=e.duplicate();n.collapse(!0);var i=n.parentElement();(n=e.duplicate()).collapse(!1);var r=n.parentElement(),a=i==r?i:o.getCommonAncestor(i,r);return a==t?a:o.getCommonAncestor(t,a)},h=function(e){return 0==e.compareEndPoints("StartToEnd",e)},f=function(e,t,n,i,r){var s=e.duplicate();s.collapse(n);var l=s.parentElement();if(o.isOrIsAncestorOf(t,l)||(l=t),!l.canHaveHTML){var u=new a(l.parentNode,o.getNodeIndex(l));return{boundaryPosition:u,nodeInfo:{nodeIndex:u.offset,containerElement:u.node}}}var d=o.getDocument(l).createElement("span");d.parentNode&&o.removeNode(d);for(var h,f,p,g,v,m=n?"StartToStart":"StartToEnd",y=r&&r.containerElement==l?r.nodeIndex:0,b=l.childNodes.length,x=b,w=x;w==b?l.appendChild(d):l.insertBefore(d,l.childNodes[w]),s.moveToElementText(d),0!=(h=s.compareEndPoints(m,e))&&y!=x;){if(-1==h){if(x==y+1)break;y=w}else x=x==y+1?y:w;w=Math.floor((y+x)/2),l.removeChild(d)}if(v=d.nextSibling,-1==h&&v&&c(v)){var E;if(s.setEndPoint(n?"EndToStart":"EndToEnd",e),/[\r\n]/.test(v.data)){var C=s.duplicate(),N=C.text.replace(/\r\n/g,"\r").length;for(E=C.moveStart("character",N);-1==(h=C.compareEndPoints("StartToEnd",C));)E++,C.moveStart("character",1)}else E=s.text.length;g=new a(v,E)}else f=(i||!n)&&d.previousSibling,g=(p=(i||n)&&d.nextSibling)&&c(p)?new a(p,0):f&&c(f)?new a(f,f.data.length):new a(l,o.getNodeIndex(d));return o.removeNode(d),{boundaryPosition:g,nodeInfo:{nodeIndex:w,containerElement:l}}},p=function(e,t){var n,i,r,a,s=e.offset,u=o.getDocument(e.node),d=l(u).createTextRange(),h=c(e.node);return h?i=(n=e.node).parentNode:(n=s<(a=e.node.childNodes).length?a[s]:null,i=e.node),(r=u.createElement("span")).innerHTML="&#feff;",n?i.insertBefore(r,n):i.appendChild(r),d.moveToElementText(r),d.collapse(!t),i.removeChild(r),h&&d[t?"moveStart":"moveEnd"]("character",s),d};(i=function(e){this.textRange=e,this.refresh()}).prototype=new s(document),i.prototype.refresh=function(){var e,t,n,i=d(this.textRange);h(this.textRange)?t=e=f(this.textRange,i,!0,!0).boundaryPosition:(e=(n=f(this.textRange,i,!0,!1)).boundaryPosition,t=f(this.textRange,i,!1,!1,n.nodeInfo).boundaryPosition),this.setStart(e.node,e.offset),this.setEnd(t.node,t.offset)},i.prototype.getName=function(){return"WrappedTextRange"},s.copyComparisonConstants(i);var g=function(e){if(e.collapsed)return p(new a(e.startContainer,e.startOffset),!0);var t=p(new a(e.startContainer,e.startOffset),!0),n=p(new a(e.endContainer,e.endOffset),!1),i=l(s.getRangeDocument(e)).createTextRange();return i.setEndPoint("StartToStart",t),i.setEndPoint("EndToEnd",n),i};if(i.rangeToTextRange=g,i.prototype.toTextRange=function(){return g(this)},e.WrappedTextRange=i,!e.features.implementsDomRange||e.config.preferTextRange){var v=Function("return this;")();void 0===v.Range&&(v.Range=i),e.createNativeRange=function(e){return e=u(e,t,"createNativeRange"),l(e).createTextRange()},e.WrappedRange=i}}e.createRange=function(n){return n=u(n,t,"createRange"),new e.WrappedRange(e.createNativeRange(n))},e.createRangyRange=function(e){return e=u(e,t,"createRangyRange"),new s(e)},r.createAliasForDeprecatedMethod(e,"createIframeRange","createRange"),r.createAliasForDeprecatedMethod(e,"createIframeRangyRange","createRangyRange"),e.addShimListener((function(t){var n=t.document;void 0===n.createRange&&(n.createRange=function(){return e.createRange(n)}),n=t=null}))})),E.createCoreModule("WrappedSelection",["DomRange","WrappedRange"],(function(e,t){e.config.checkSelectionRanges=!0;var n,i,o="boolean",r="number",a=e.dom,s=e.util,l=s.isHostMethod,u=e.DomRange,c=e.WrappedRange,d=e.DOMException,h=a.DomPosition,f=e.features,p="Control",g=a.getDocument,v=a.getBody,m=u.rangesEqual;function y(e){return"string"==typeof e?/^backward(s)?$/i.test(e):!!e}function b(e,n){if(e){if(a.isWindow(e))return e;if(e instanceof $)return e.win;var i=a.getContentDocument(e,t,n);return a.getWindow(i)}return window}function x(e){return b(e,"getWinSelection").getSelection()}function w(e){return b(e,"getDocSelection").document.selection}function E(e){var t=!1;return e.anchorNode&&(t=1==a.comparePoints(e.anchorNode,e.anchorOffset,e.focusNode,e.focusOffset)),t}var C=l(window,"getSelection"),N=s.isHostObject(document,"selection");f.implementsWinGetSelection=C,f.implementsDocSelection=N;var _=N&&(!C||e.config.preferTextRange);if(_)n=w,e.isSelectionValid=function(e){var t=b(e,"isSelectionValid").document,n=t.selection;return"None"!=n.type||g(n.createRange().parentElement())==t};else{if(!C)return t.fail("Neither document.selection or window.getSelection() detected."),!1;n=x,e.isSelectionValid=function(){return!0}}e.getNativeSelection=n;var S=n();if(!S)return t.fail("Native selection was null (possibly issue 138?)"),!1;var M=e.createNativeRange(document),T=v(document),A=s.areHostProperties(S,["anchorNode","focusNode","anchorOffset","focusOffset"]);f.selectionHasAnchorAndFocus=A;var k=l(S,"extend");f.selectionHasExtend=k;var R=l(S,"setBaseAndExtent");f.selectionHasSetBaseAndExtent=R;var O=typeof S.rangeCount==r;f.selectionHasRangeCount=O;var P=!1,D=!0,I=k?function(t,n){var i=u.getRangeDocument(n),o=e.createRange(i);o.collapseToPoint(n.endContainer,n.endOffset),t.addRange(G(o)),t.extend(n.startContainer,n.startOffset)}:null;s.areHostMethods(S,["addRange","getRangeAt","removeAllRanges"])&&typeof S.rangeCount==r&&f.implementsDomRange&&function(){var t=window.getSelection();if(t){for(var n=t.rangeCount,i=n>1,o=[],r=E(t),s=0;s<n;++s)o[s]=t.getRangeAt(s);var l=a.createTestElement(document,"",!1),u=l.appendChild(document.createTextNode("   ")),c=document.createRange();if(c.setStart(u,1),c.collapse(!0),t.removeAllRanges(),t.addRange(c),D=1==t.rangeCount,t.removeAllRanges(),!i){var d=window.navigator.appVersion.match(/Chrome\/(.*?) /);if(d&&parseInt(d[1])>=36)P=!1;else{var h=c.cloneRange();c.setStart(u,0),h.setEnd(u,3),h.setStart(u,2),t.addRange(c),t.addRange(h),P=2==t.rangeCount}}for(a.removeNode(l),t.removeAllRanges(),s=0;s<n;++s)0==s&&r?I?I(t,o[s]):(e.warn("Rangy initialization: original selection was backwards but selection has been restored forwards because the browser does not support Selection.extend"),t.addRange(o[s])):t.addRange(o[s])}}(),f.selectionSupportsMultipleRanges=P,f.collapsedNonEditableSelectionsSupported=D;var L,B,j=!1;function F(e,t,n){var i=n?"end":"start",o=n?"start":"end";e.anchorNode=t[i+"Container"],e.anchorOffset=t[i+"Offset"],e.focusNode=t[o+"Container"],e.focusOffset=t[o+"Offset"]}function H(e){var t=e.nativeSelection;e.anchorNode=t.anchorNode,e.anchorOffset=t.anchorOffset,e.focusNode=t.focusNode,e.focusOffset=t.focusOffset}function W(e){e.anchorNode=e.focusNode=null,e.anchorOffset=e.focusOffset=0,e.rangeCount=0,e.isCollapsed=!0,e._ranges.length=0,z(e)}function z(e){e.type=0==e.rangeCount?"None":i(e)?"Caret":"Range"}function G(t){var n;return t instanceof u?((n=e.createNativeRange(t.getDocument())).setEnd(t.endContainer,t.endOffset),n.setStart(t.startContainer,t.startOffset)):t instanceof c?n=t.nativeRange:f.implementsDomRange&&t instanceof a.getWindow(t.startContainer).Range&&(n=t),n}function U(e){if(!e.length||1!=e[0].nodeType)return!1;for(var t=1,n=e.length;t<n;++t)if(!a.isAncestorOf(e[0],e[t]))return!1;return!0}function q(e){var n=e.getNodes();if(!U(n))throw t.createError("getSingleElementFromRange: range "+e.inspect()+" did not consist of a single element");return n[0]}function X(e){return!!e&&void 0!==e.text}function V(e,t){var n=new c(t);e._ranges=[n],F(e,n,!1),e.rangeCount=1,e.isCollapsed=n.collapsed,z(e)}function K(t){if(t._ranges.length=0,"None"==t.docSelection.type)W(t);else{var n=t.docSelection.createRange();if(X(n))V(t,n);else{t.rangeCount=n.length;for(var i,o=g(n.item(0)),r=0;r<t.rangeCount;++r)(i=e.createRange(o)).selectNode(n.item(r)),t._ranges.push(i);t.isCollapsed=1==t.rangeCount&&t._ranges[0].collapsed,F(t,t._ranges[t.rangeCount-1],!1),z(t)}}}function Y(e,n){for(var i=e.docSelection.createRange(),o=q(n),r=g(i.item(0)),a=v(r).createControlRange(),s=0,l=i.length;s<l;++s)a.add(i.item(s));try{a.add(o)}catch(e){throw t.createError("addRange(): Element within the specified Range could not be added to control selection (does it have layout?)")}a.select(),K(e)}function $(e,t,n){this.nativeSelection=e,this.docSelection=t,this._ranges=[],this.win=n,this.refresh()}function Z(e){e.win=e.anchorNode=e.focusNode=e._ranges=null,e.rangeCount=e.anchorOffset=e.focusOffset=0,e.detached=!0,z(e)}T&&l(T,"createControlRange")&&(L=T.createControlRange(),s.areHostProperties(L,["item","add"])&&(j=!0)),f.implementsControlRange=j,i=A?function(e){return e.anchorNode===e.focusNode&&e.anchorOffset===e.focusOffset}:function(e){return!!e.rangeCount&&e.getRangeAt(e.rangeCount-1).collapsed},l(S,"getRangeAt")?B=function(e,t){try{return e.getRangeAt(t)}catch(e){return null}}:A&&(B=function(t){var n=g(t.anchorNode),i=e.createRange(n);return i.setStartAndEnd(t.anchorNode,t.anchorOffset,t.focusNode,t.focusOffset),i.collapsed!==this.isCollapsed&&i.setStartAndEnd(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset),i}),$.prototype=e.selectionPrototype;var J=[];function Q(e,t){for(var n,i,o=J.length;o--;)if(i=(n=J[o]).selection,"deleteAll"==t)Z(i);else if(n.win==e)return"delete"==t?(J.splice(o,1),!0):i;return"deleteAll"==t&&(J.length=0),null}var ee=function(e){if(e&&e instanceof $)return e.refresh(),e;var t=Q(e=b(e,"getNativeSelection")),i=n(e),o=N?w(e):null;return t?(t.nativeSelection=i,t.docSelection=o,t.refresh()):(t=new $(i,o,e),J.push({win:e,selection:t})),t};e.getSelection=ee,s.createAliasForDeprecatedMethod(e,"getIframeSelection","getSelection");var te,ne=$.prototype;function ie(e,n){for(var i,o=g(n[0].startContainer),r=v(o).createControlRange(),a=0,s=n.length;a<s;++a){i=q(n[a]);try{r.add(i)}catch(e){throw t.createError("setRanges(): Element within one of the specified Ranges could not be added to control selection (does it have layout?)")}}r.select(),K(e)}if(!_&&A&&s.areHostMethods(S,["removeAllRanges","addRange"])){ne.removeAllRanges=function(){this.nativeSelection.removeAllRanges(),W(this)};var oe=function(e,t){I(e.nativeSelection,t),e.refresh()};ne.addRange=O?function(t,n){if(j&&N&&this.docSelection.type==p)Y(this,t);else if(y(n)&&k)oe(this,t);else{var o;P?o=this.rangeCount:(this.removeAllRanges(),o=0);var r=G(t).cloneRange();try{this.nativeSelection.addRange(r)}catch(e){}if(this.rangeCount=this.nativeSelection.rangeCount,this.rangeCount==o+1){if(e.config.checkSelectionRanges){var a=B(this.nativeSelection,this.rangeCount-1);a&&!m(a,t)&&(t=new c(a))}this._ranges[this.rangeCount-1]=t,F(this,t,re(this.nativeSelection)),this.isCollapsed=i(this),z(this)}else this.refresh()}}:function(e,t){y(t)&&k?oe(this,e):(this.nativeSelection.addRange(G(e)),this.refresh())},ne.setRanges=function(e){if(j&&N&&e.length>1)ie(this,e);else{this.removeAllRanges();for(var t=0,n=e.length;t<n;++t)this.addRange(e[t])}}}else{if(!(l(S,"empty")&&l(M,"select")&&j&&_))return t.fail("No means of selecting a Range or TextRange was found"),!1;ne.removeAllRanges=function(){try{if(this.docSelection.empty(),"None"!=this.docSelection.type){var e;if(this.anchorNode)e=g(this.anchorNode);else if(this.docSelection.type==p){var t=this.docSelection.createRange();t.length&&(e=g(t.item(0)))}e&&(v(e).createTextRange().select(),this.docSelection.empty())}}catch(e){}W(this)},ne.addRange=function(t){this.docSelection.type==p?Y(this,t):(e.WrappedTextRange.rangeToTextRange(t).select(),this._ranges[0]=t,this.rangeCount=1,this.isCollapsed=this._ranges[0].collapsed,F(this,t,!1),z(this))},ne.setRanges=function(e){this.removeAllRanges();var t=e.length;t>1?ie(this,e):t&&this.addRange(e[0])}}if(ne.getRangeAt=function(e){if(e<0||e>=this.rangeCount)throw new d("INDEX_SIZE_ERR");return this._ranges[e].cloneRange()},_)te=function(t){var n;e.isSelectionValid(t.win)?n=t.docSelection.createRange():(n=v(t.win.document).createTextRange()).collapse(!0),t.docSelection.type==p?K(t):X(n)?V(t,n):W(t)};else if(l(S,"getRangeAt")&&typeof S.rangeCount==r)te=function(t){if(j&&N&&t.docSelection.type==p)K(t);else if(t._ranges.length=t.rangeCount=t.nativeSelection.rangeCount,t.rangeCount){for(var n=0,o=t.rangeCount;n<o;++n)t._ranges[n]=new e.WrappedRange(t.nativeSelection.getRangeAt(n));F(t,t._ranges[t.rangeCount-1],re(t.nativeSelection)),t.isCollapsed=i(t),z(t)}else W(t)};else{if(!A||typeof S.isCollapsed!=o||typeof M.collapsed!=o||!f.implementsDomRange)return t.fail("No means of obtaining a Range or TextRange from the user's selection was found"),!1;te=function(e){var t,n=e.nativeSelection;n.anchorNode?(t=B(n,0),e._ranges=[t],e.rangeCount=1,H(e),e.isCollapsed=i(e),z(e)):W(e)}}ne.refresh=function(e){var t=e?this._ranges.slice(0):null,n=this.anchorNode,i=this.anchorOffset;if(te(this),e){var o=t.length;if(o!=this._ranges.length)return!0;if(this.anchorNode!=n||this.anchorOffset!=i)return!0;for(;o--;)if(!m(t[o],this._ranges[o]))return!0;return!1}};var re,ae=function(e,t){var n=e.getAllRanges();e.removeAllRanges();for(var i=0,o=n.length;i<o;++i)m(t,n[i])||e.addRange(n[i]);e.rangeCount||W(e)};function se(e,t){if(e.win.document!=g(t))throw new d("WRONG_DOCUMENT_ERR")}function le(e,t){if(t<0||t>(a.isCharacterDataNode(e)?e.length:e.childNodes.length))throw new d("INDEX_SIZE_ERR")}function ue(t){return function(n,i){var o;this.rangeCount?(o=this.getRangeAt(0))["set"+(t?"Start":"End")](n,i):(o=e.createRange(this.win.document)).setStartAndEnd(n,i),this.setSingleRange(o,this.isBackward())}}function ce(e){var t=[],n=new h(e.anchorNode,e.anchorOffset),i=new h(e.focusNode,e.focusOffset),o="function"==typeof e.getName?e.getName():"Selection";if(void 0!==e.rangeCount)for(var r=0,a=e.rangeCount;r<a;++r)t[r]=u.inspect(e.getRangeAt(r));return"["+o+"(Ranges: "+t.join(", ")+")(anchor: "+n.inspect()+", focus: "+i.inspect()+"]"}ne.removeRange=j&&N?function(e){if(this.docSelection.type==p){for(var t=this.docSelection.createRange(),n=q(e),i=g(t.item(0)),o=v(i).createControlRange(),r=!1,a=0,s=t.length;a<s;++a)t.item(a)!==n||r?o.add(t.item(a)):r=!0;o.select(),K(this)}else ae(this,e)}:function(e){ae(this,e)},!_&&A&&f.implementsDomRange?(re=E,ne.isBackward=function(){return re(this)}):re=ne.isBackward=function(){return!1},ne.isBackwards=ne.isBackward,ne.toString=function(){for(var e=[],t=0,n=this.rangeCount;t<n;++t)e[t]=""+this._ranges[t];return e.join("")},ne.collapse=function(t,n){se(this,t);var i=e.createRange(t);i.collapseToPoint(t,n),this.setSingleRange(i),this.isCollapsed=!0},ne.collapseToStart=function(){if(!this.rangeCount)throw new d("INVALID_STATE_ERR");var e=this._ranges[0];this.collapse(e.startContainer,e.startOffset)},ne.collapseToEnd=function(){if(!this.rangeCount)throw new d("INVALID_STATE_ERR");var e=this._ranges[this.rangeCount-1];this.collapse(e.endContainer,e.endOffset)},ne.selectAllChildren=function(t){se(this,t);var n=e.createRange(t);n.selectNodeContents(t),this.setSingleRange(n)},R?ne.setBaseAndExtent=function(e,t,n,i){this.nativeSelection.setBaseAndExtent(e,t,n,i),this.refresh()}:k&&(ne.setBaseAndExtent=function(t,n,i,o){le(t,n),le(i,o),se(this,t),se(this,i);var r=e.createRange(node),s=-1==a.comparePoints(t,n,i,o);s?r.setStartAndEnd(i,o,t,n):r.setStartAndEnd(t,n,i,o),this.setSingleRange(r,s)}),ne.deleteFromDocument=function(){if(j&&N&&this.docSelection.type==p){for(var e,t=this.docSelection.createRange();t.length;)e=t.item(0),t.remove(e),a.removeNode(e);this.refresh()}else if(this.rangeCount){var n=this.getAllRanges();if(n.length){this.removeAllRanges();for(var i=0,o=n.length;i<o;++i)n[i].deleteContents();this.addRange(n[o-1])}}},ne.eachRange=function(e,t){for(var n=0,i=this._ranges.length;n<i;++n)if(e(this.getRangeAt(n)))return t},ne.getAllRanges=function(){var e=[];return this.eachRange((function(t){e.push(t)})),e},ne.setSingleRange=function(e,t){this.removeAllRanges(),this.addRange(e,t)},ne.callMethodOnEachRange=function(e,t){var n=[];return this.eachRange((function(i){n.push(i[e].apply(i,t||[]))})),n},ne.setStart=ue(!0),ne.setEnd=ue(!1),e.rangePrototype.select=function(e){ee(this.getDocument()).setSingleRange(this,e)},ne.changeEachRange=function(e){var t=[],n=this.isBackward();this.eachRange((function(n){e(n),t.push(n)})),this.removeAllRanges(),n&&1==t.length?this.addRange(t[0],"backward"):this.setRanges(t)},ne.containsNode=function(e,t){return this.eachRange((function(n){return n.containsNode(e,t)}),!0)||!1},ne.getBookmark=function(e){return{backward:this.isBackward(),rangeBookmarks:this.callMethodOnEachRange("getBookmark",[e])}},ne.moveToBookmark=function(t){for(var n,i,o=[],r=0;n=t.rangeBookmarks[r++];)(i=e.createRange(this.win)).moveToBookmark(n),o.push(i);t.backward?this.setSingleRange(o[0],"backward"):this.setRanges(o)},ne.saveRanges=function(){return{backward:this.isBackward(),ranges:this.callMethodOnEachRange("cloneRange")}},ne.restoreRanges=function(e){this.removeAllRanges();for(var t,n=0;t=e.ranges[n];++n)this.addRange(t,e.backward&&0==n)},ne.toHtml=function(){var e=[];return this.eachRange((function(t){e.push(u.toHtml(t))})),e.join("")},f.implementsTextRange&&(ne.getNativeTextRange=function(){var n;if(n=this.docSelection){var i=n.createRange();if(X(i))return i;throw t.createError("getNativeTextRange: selection is a control selection")}if(this.rangeCount>0)return e.WrappedTextRange.rangeToTextRange(this.getRangeAt(0));throw t.createError("getNativeTextRange: selection contains no range")}),ne.getName=function(){return"WrappedSelection"},ne.inspect=function(){return ce(this)},ne.detach=function(){Q(this.win,"delete"),Z(this)},$.detachAll=function(){Q(null,"deleteAll")},$.inspect=ce,$.isDirectionBackward=y,e.Selection=$,e.selectionPrototype=ne,e.addShimListener((function(e){void 0===e.getSelection&&(e.getSelection=function(){return ee(e)}),e=null}))}));var j=!1,F=function(e){j||(j=!0,!E.initialized&&E.config.autoInitialize&&A())};return x&&("complete"==document.readyState?F():(s(document,"addEventListener")&&document.addEventListener("DOMContentLoaded",F,!1),m(window,"load",F))),E}()}({get exports(){return Ov},set exports(e){Ov=e}});var Pv={};!function(e){var t;e.exports=((t=Ov).createModule("ClassApplier",["WrappedSelection"],(function(e,t){var n=e.dom,i=n.DomPosition,o=n.arrayContains,r=e.util,a=r.forEach,s="span",l=r.isHostMethod(document,"createElementNS");function u(e,t){for(var n in e)if(e.hasOwnProperty(n)&&!1===t(n,e[n]))return!1;return!0}function c(e){return e.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function d(e,t){return!!e&&new RegExp("(?:^|\\s)"+t+"(?:\\s|$)").test(e)}function h(e,t){return"object"==typeof e.classList?e.classList.contains(t):d("string"==typeof e.className?e.className:e.getAttribute("class"),t)}function f(e,t){if("object"==typeof e.classList)e.classList.add(t);else{var n="string"==typeof e.className,i=n?e.className:e.getAttribute("class");i?d(i,t)||(i+=" "+t):i=t,n?e.className=i:e.setAttribute("class",i)}}var p=function(){function e(e,t,n){return t&&n?" ":""}return function(t,n){if("object"==typeof t.classList)t.classList.remove(n);else{var i="string"==typeof t.className,o=i?t.className:t.getAttribute("class");o=o.replace(new RegExp("(^|\\s)"+n+"(\\s|$)"),e),i?t.className=o:t.setAttribute("class",o)}}}();function g(e){return"string"==typeof e.className?e.className:e.getAttribute("class")}function v(e){return e&&e.split(/\s+/).sort().join(" ")}function m(e){return v(g(e))}function y(e,t){return m(e)==m(t)}function b(e,t){for(var n=t.split(/\s+/),i=0,o=n.length;i<o;++i)if(!h(e,c(n[i])))return!1;return!0}function x(e){var t=e.parentNode;return t&&1==t.nodeType&&!/^(textarea|style|script|select|iframe)$/i.test(t.nodeName)}function w(e,t,n,i,o){var r=e.node,a=e.offset,s=r,l=a;r==i&&a>o&&++l,r!=t||a!=n&&a!=n+1||(s=i,l+=o-n),r==t&&a>n+1&&--l,e.node=s,e.offset=l}function E(e,t,n){e.node==t&&e.offset>n&&--e.offset}function C(e,t,i,o){-1==i&&(i=t.childNodes.length);var r=e.parentNode,s=n.getNodeIndex(e);a(o,(function(e){w(e,r,s,t,i)})),t.childNodes.length==i?t.appendChild(e):t.insertBefore(e,t.childNodes[i])}function N(e,t){var i=e.parentNode,o=n.getNodeIndex(e);a(t,(function(e){E(e,i,o)})),n.removeNode(e)}function _(e,t,n,i,o){for(var r,a=[];r=e.firstChild;)C(r,t,n++,o),a.push(r);return N(e,o),a}function S(e,t){return _(e,e.parentNode,n.getNodeIndex(e),!0,t)}function M(e,t){var n=e.cloneRange();n.selectNodeContents(t);var i=n.intersection(e);return""!=(i?i.toString():"")}function T(e){for(var t,n=e.getNodes([3]),i=0;(t=n[i])&&!M(e,t);)++i;for(var o=n.length-1;(t=n[o])&&!M(e,t);)--o;return n.slice(i,o+1)}function A(e,t){if(e.attributes.length!=t.attributes.length)return!1;for(var n,i,o,r=0,a=e.attributes.length;r<a;++r)if("class"!=(o=(n=e.attributes[r]).name)){if(null===n!=(null===(i=t.attributes.getNamedItem(o))))return!1;if(n.specified!=i.specified)return!1;if(n.specified&&n.nodeValue!==i.nodeValue)return!1}return!0}function k(e,t){for(var n,i=0,r=e.attributes.length;i<r;++i)if(n=e.attributes[i].name,(!t||!o(t,n))&&e.attributes[i].specified&&"class"!=n)return!0;return!1}var R=n.getComputedStyleProperty,O="boolean"==typeof document.createElement("div").isContentEditable?function(e){return e&&1==e.nodeType&&e.isContentEditable}:function(e){return!(!e||1!=e.nodeType||"false"==e.contentEditable)&&("true"==e.contentEditable||O(e.parentNode))};function P(e){var t;return e&&1==e.nodeType&&((t=e.parentNode)&&9==t.nodeType&&"on"==t.designMode||O(e)&&!O(e.parentNode))}function D(e){return(O(e)||1!=e.nodeType&&O(e.parentNode))&&!P(e)}var I=/^inline(-block|-table)?$/i;function L(e){return e&&1==e.nodeType&&!I.test(R(e,"display"))}var B=/[^\r\n\t\f \u200B]/;function j(e){if(0==e.data.length)return!0;if(B.test(e.data))return!1;switch(R(e.parentNode,"whiteSpace")){case"pre":case"pre-wrap":case"-moz-pre-wrap":return!1;case"pre-line":if(/[\r\n]/.test(e.data))return!1}return L(e.previousSibling)||L(e.nextSibling)}function F(e){var t,n,o=[];for(t=0;n=e[t++];)o.push(new i(n.startContainer,n.startOffset),new i(n.endContainer,n.endOffset));return o}function H(e,t){for(var n,i,o,r=0,a=e.length;r<a;++r)n=e[r],i=t[2*r],o=t[2*r+1],n.setStartAndEnd(i.node,i.offset,o.node,o.offset)}function W(e,t){return n.isCharacterDataNode(e)?0==t?!!e.previousSibling:t!=e.length||!!e.nextSibling:t>0&&t<e.childNodes.length}function z(e,i,o,r){var a,s,l=0==o;if(n.isAncestorOf(i,e))return e;if(n.isCharacterDataNode(i)){var u=n.getNodeIndex(i);if(0==o)o=u;else{if(o!=i.length)throw t.createError("splitNodeAt() should not be called with offset in the middle of a data node ("+o+" in "+i.data);o=u+1}i=i.parentNode}if(W(i,o)){a=i.cloneNode(!1),s=i.parentNode,a.id&&a.removeAttribute("id");for(var c,d=0;c=i.childNodes[o];)C(c,a,d++,r);return C(a,s,n.getNodeIndex(i)+1,r),i==e?a:z(e,s,n.getNodeIndex(a),r)}if(e!=i){a=i.parentNode;var h=n.getNodeIndex(i);return l||h++,z(e,a,h,r)}return e}function G(e,t){return e.namespaceURI==t.namespaceURI&&e.tagName.toLowerCase()==t.tagName.toLowerCase()&&y(e,t)&&A(e,t)&&"inline"==R(e,"display")&&"inline"==R(t,"display")}function U(e){var t=e?"nextSibling":"previousSibling";return function(n,i){var o=n.parentNode,r=n[t];if(r){if(r&&3==r.nodeType)return r}else if(i&&(r=o[t])&&1==r.nodeType&&G(o,r)){var a=r[e?"firstChild":"lastChild"];if(a&&3==a.nodeType)return a}return null}}var q=U(!1),X=U(!0);function V(e){this.isElementMerge=1==e.nodeType,this.textNodes=[];var t=this.isElementMerge?e.lastChild:e;t&&(this.textNodes[0]=t)}V.prototype={doMerge:function(e){var t=this.textNodes,i=t[0];if(t.length>1){var o,r=n.getNodeIndex(i),s=[],l=0;a(t,(function(u,c){o=u.parentNode,c>0&&(o.removeChild(u),o.hasChildNodes()||n.removeNode(o),e&&a(e,(function(e){e.node==u&&(e.node=i,e.offset+=l),e.node==o&&e.offset>r&&(--e.offset,e.offset==r+1&&c<t.length-1&&(e.node=i,e.offset=l))}))),s[c]=u.data,l+=u.data.length})),i.data=s.join("")}return i.data},getLength:function(){for(var e=this.textNodes.length,t=0;e--;)t+=this.textNodes[e].length;return t},toString:function(){var e=[];return a(this.textNodes,(function(t,n){e[n]="'"+t.data+"'"})),"[Merge("+e.join(",")+")]"}};var K=["elementTagName","ignoreWhiteSpace","applyToEditableOnly","useExistingElements","removeEmptyElements","onElementCreate"],Y={};function $(e,t,n){var i,o,r,a,s=this;s.cssClass=s.className=e;var l=null,d={};if("object"==typeof t&&null!==t){for(void 0!==t.elementTagName&&(t.elementTagName=t.elementTagName.toLowerCase()),n=t.tagNames,l=t.elementProperties,d=t.elementAttributes,o=0;a=K[o++];)t.hasOwnProperty(a)&&(s[a]=t[a]);i=t.normalize}else i=t;s.normalize=void 0===i||i,s.attrExceptions=[];var h=document.createElement(s.elementTagName);s.elementProperties=s.copyPropertiesToElement(l,h,!0),u(d,(function(e,t){s.attrExceptions.push(e),d[e]=""+t})),s.elementAttributes=d,s.elementSortedClassName=s.elementProperties.hasOwnProperty("className")?v(s.elementProperties.className+" "+e):e,s.applyToAnyTagName=!1;var f=typeof n;if("string"==f)"*"==n?s.applyToAnyTagName=!0:s.tagNames=c(n.toLowerCase()).split(/\s*,\s*/);else if("object"==f&&"number"==typeof n.length)for(s.tagNames=[],o=0,r=n.length;o<r;++o)"*"==n[o]?s.applyToAnyTagName=!0:s.tagNames.push(n[o].toLowerCase());else s.tagNames=[s.elementTagName]}function Z(e,t,n){return new $(e,t,n)}$.prototype={elementTagName:s,elementProperties:{},elementAttributes:{},ignoreWhiteSpace:!0,applyToEditableOnly:!1,useExistingElements:!0,removeEmptyElements:!0,onElementCreate:null,copyPropertiesToElement:function(e,t,n){var i,o,r,a,s,l,u={};for(var c in e)if(e.hasOwnProperty(c))if(a=e[c],s=t[c],"className"==c)f(t,a),f(t,this.className),t[c]=v(t[c]),n&&(u[c]=a);else if("style"==c){for(i in o=s,n&&(u[c]=r={}),e[c])e[c].hasOwnProperty(i)&&(o[i]=a[i],n&&(r[i]=o[i]));this.attrExceptions.push(c)}else t[c]=a,n&&(u[c]=t[c],l=Y.hasOwnProperty(c)?Y[c]:c,this.attrExceptions.push(l));return n?u:""},copyAttributesToElement:function(e,t){for(var n in e)e.hasOwnProperty(n)&&!/^class(?:Name)?$/i.test(n)&&t.setAttribute(n,e[n])},appliesToElement:function(e){return o(this.tagNames,e.tagName.toLowerCase())},getEmptyElements:function(e){var t=this;return e.getNodes([1],(function(e){return t.appliesToElement(e)&&!e.hasChildNodes()}))},hasClass:function(e){return 1==e.nodeType&&(this.applyToAnyTagName||this.appliesToElement(e))&&h(e,this.className)},getSelfOrAncestorWithClass:function(e){for(;e;){if(this.hasClass(e))return e;e=e.parentNode}return null},isModifiable:function(e){return!this.applyToEditableOnly||D(e)},isIgnorableWhiteSpaceNode:function(e){return this.ignoreWhiteSpace&&e&&3==e.nodeType&&j(e)},postApply:function(e,t,n,i){var o,r,s=e[0],l=e[e.length-1],u=[],c=s,d=l,h=0,f=l.length;a(e,(function(e){(r=q(e,!i))?(o||(o=new V(r),u.push(o)),o.textNodes.push(e),e===s&&(c=o.textNodes[0],h=c.length),e===l&&(d=o.textNodes[0],f=o.getLength())):o=null}));var p=X(l,!i);if(p&&(o||(o=new V(l),u.push(o)),o.textNodes.push(p)),u.length){for(var g=0,v=u.length;g<v;++g)u[g].doMerge(n);t.setStartAndEnd(c,h,d,f)}},createContainer:function(e){var t=n.getDocument(e),i=l&&!n.isHtmlNamespace(e)&&e.namespaceURI?t.createElementNS(e.namespaceURI,this.elementTagName):t.createElement(this.elementTagName);return this.copyPropertiesToElement(this.elementProperties,i,!1),this.copyAttributesToElement(this.elementAttributes,i),f(i,this.className),this.onElementCreate&&this.onElementCreate(i,this),i},elementHasProperties:function(e,t){var n=this;return u(t,(function(t,i){if("className"==t)return b(e,i);if("object"==typeof i){if(!n.elementHasProperties(e[t],i))return!1}else if(e[t]!==i)return!1}))},elementHasAttributes:function(e,t){return u(t,(function(t,n){if(e.getAttribute(t)!==n)return!1}))},applyToTextNode:function(e,t){if(x(e)){var n=e.parentNode;if(1==n.childNodes.length&&this.useExistingElements&&this.appliesToElement(n)&&this.elementHasProperties(n,this.elementProperties)&&this.elementHasAttributes(n,this.elementAttributes))f(n,this.className);else{var i=e.parentNode,o=this.createContainer(i);i.insertBefore(o,e),o.appendChild(e)}}},isRemovable:function(e){return e.tagName.toLowerCase()==this.elementTagName&&m(e)==this.elementSortedClassName&&this.elementHasProperties(e,this.elementProperties)&&!k(e,this.attrExceptions)&&this.elementHasAttributes(e,this.elementAttributes)&&this.isModifiable(e)},isEmptyContainer:function(e){var t=e.childNodes.length;return 1==e.nodeType&&this.isRemovable(e)&&(0==t||1==t&&this.isEmptyContainer(e.firstChild))},removeEmptyContainers:function(e){var t=this,n=e.getNodes([1],(function(e){return t.isEmptyContainer(e)})),i=[e],o=F(i);a(n,(function(e){N(e,o)})),H(i,o)},undoToTextNode:function(e,t,n,i){if(!t.containsNode(n)){var o=t.cloneRange();o.selectNode(n),o.isPointInRange(t.endContainer,t.endOffset)&&(z(n,t.endContainer,t.endOffset,i),t.setEndAfter(n)),o.isPointInRange(t.startContainer,t.startOffset)&&(n=z(n,t.startContainer,t.startOffset,i))}this.isRemovable(n)?S(n,i):p(n,this.className)},splitAncestorWithClass:function(e,t,n){var i=this.getSelfOrAncestorWithClass(e);i&&z(i,e,t,n)},undoToAncestor:function(e,t){this.isRemovable(e)?S(e,t):p(e,this.className)},applyToRange:function(e,t){var n=this,i=F((t=t||[])||[]);e.splitBoundariesPreservingPositions(i),n.removeEmptyElements&&n.removeEmptyContainers(e);var o=T(e);if(o.length){a(o,(function(e){n.isIgnorableWhiteSpaceNode(e)||n.getSelfOrAncestorWithClass(e)||!n.isModifiable(e)||n.applyToTextNode(e,i)}));var r=o[o.length-1];e.setStartAndEnd(o[0],0,r,r.length),n.normalize&&n.postApply(o,e,i,!1),H(t,i)}var s=n.getEmptyElements(e);a(s,(function(e){f(e,n.className)}))},applyToRanges:function(e){for(var t=e.length;t--;)this.applyToRange(e[t],e);return e},applyToSelection:function(t){var n=e.getSelection(t);n.setRanges(this.applyToRanges(n.getAllRanges()))},undoToRange:function(e,t){var n=this,i=F(t=t||[]);e.splitBoundariesPreservingPositions(i),n.removeEmptyElements&&n.removeEmptyContainers(e,i);var o,r,s=T(e),l=s[s.length-1];if(s.length){n.splitAncestorWithClass(e.endContainer,e.endOffset,i),n.splitAncestorWithClass(e.startContainer,e.startOffset,i);for(var u=0,c=s.length;u<c;++u)o=s[u],(r=n.getSelfOrAncestorWithClass(o))&&n.isModifiable(o)&&n.undoToAncestor(r,i);e.setStartAndEnd(s[0],0,l,l.length),n.normalize&&n.postApply(s,e,i,!0),H(t,i)}var d=n.getEmptyElements(e);a(d,(function(e){p(e,n.className)}))},undoToRanges:function(e){for(var t=e.length;t--;)this.undoToRange(e[t],e);return e},undoToSelection:function(t){var n=e.getSelection(t),i=e.getSelection(t).getAllRanges();this.undoToRanges(i),n.setRanges(i)},isAppliedToRange:function(e){if(e.collapsed||""==e.toString())return!!this.getSelfOrAncestorWithClass(e.commonAncestorContainer);var t=e.getNodes([3]);if(t.length)for(var n,i=0;n=t[i++];)if(!this.isIgnorableWhiteSpaceNode(n)&&M(e,n)&&this.isModifiable(n)&&!this.getSelfOrAncestorWithClass(n))return!1;return!0},isAppliedToRanges:function(e){var t=e.length;if(0==t)return!1;for(;t--;)if(!this.isAppliedToRange(e[t]))return!1;return!0},isAppliedToSelection:function(t){var n=e.getSelection(t);return this.isAppliedToRanges(n.getAllRanges())},toggleRange:function(e){this.isAppliedToRange(e)?this.undoToRange(e):this.applyToRange(e)},toggleSelection:function(e){this.isAppliedToSelection(e)?this.undoToSelection(e):this.applyToSelection(e)},getElementsWithClassIntersectingRange:function(e){var t=[],n=this;return e.getNodes([3],(function(e){var i=n.getSelfOrAncestorWithClass(e);i&&!o(t,i)&&t.push(i)})),t},detach:function(){}},$.util={hasClass:h,addClass:f,removeClass:p,getClass:g,hasSameClasses:y,hasAllClasses:b,replaceWithOwnChildren:S,elementsHaveSameNonClassAttributes:A,elementHasNonClassAttributes:k,splitNodeAt:z,isEditableElement:O,isEditingHost:P,isEditable:D},e.CssClassApplier=e.ClassApplier=$,e.createClassApplier=Z,r.createAliasForDeprecatedMethod(e,"createCssClassApplier","createClassApplier",t)})),t)}({get exports(){return Pv},set exports(e){Pv=e}});var Dv={toolbar:{allowMultiParagraphSelection:!0,buttons:["bold","colorpicker","italic","underline","strikethrough","quote","justifyLeft","justifyCenter","justifyRight","justifyFull","superscript","subscript","orderedlist","unorderedlist","pre","removeFormat","outdent","indent","h2","h3"],standardizeSelectionStart:!1,updateOnEmptySelection:!1},placeholder:{text:"请输入内容",hideOnClick:!0},disableEditing:!0},Iv=vv.extensions.button.extend({name:"colorpicker",tagNames:["mark"],contentDefault:"<b>Color</b>",aria:"Color Picker",action:"colorPicker",init:function(){var e=this;Ov.init(),vv.extensions.button.prototype.init.call(this),this.colorPicker=new kv({parent:this.button,color:"#000",onDone:function(t){e.coloredText&&e.coloredText.isAppliedToSelection()&&e.coloredText.undoToSelection(),e.coloredText=Ov.createClassApplier("colored",{elementTagName:"span",elementProperties:{style:{color:t.hex}},normalize:!0}),e.coloredText.toggleSelection(),e.base.checkContentChanged(),e.setInactive()}})},getButton:function(){return this.button},handleClick:function(){this.setActive(),this.colorPicker.show()},isAlreadyApplied:function(e){return"mark"===e.nodeName.toLowerCase()},isActive:function(){return this.button.classList.contains("medium-editor-button-active")},setInactive:function(){this.button.classList.remove("medium-editor-button-active")},setActive:function(){this.button.classList.add("medium-editor-button-active")}}),Lv=function(e){function n(t){var n=e.call(this,t)||this;n.labelMap=new Map;var i=t.lf,o=t.graphModel;return n.lf=i,n.graphModel=o,n.state={tick:0},n}return p(n,e),n.prototype.componentDidMount=function(){var e=this,t=this.props.graphModel;this.editor=new vv(".lf-label-editor",md(Dv,{autoLink:!0,extensions:{colorPicker:new Iv}})),t.eventCenter.on("text:update,node:mousemove,node:resize,node:rotate,node:drag,label:drop,node:drop",(function(){})),t.eventCenter.on("node:properties-change,node:properties-delete",(function(){e.setState({tick:e.state.tick+1})}))},n.prototype.componentDidUpdate=function(){var e;this.editor&&this.editor.elements.length>0?this.editor.addElements(".lf-label-editor"):(null===(e=this.editor)||void 0===e||e.destroy(),this.editor=new vv(".lf-label-editor",md(Dv,{autoLink:!0,extensions:{colorPicker:new Iv}})))},n.prototype.componentWillUnmount=function(){var e;null===(e=this.editor)||void 0===e||e.destroy()},n.prototype.getLabels=function(){var e=this,t=this.props,n=t.lf.extension,i=t.graphModel,o=E(E([],w(i.nodes),!1),w(i.edges),!1);if(n.label){var r=[];return xu(o,(function(t){var n,o;xu(null!==(o=null===(n=t.getData().properties)||void 0===n?void 0:n._label)&&void 0!==o?o:[],(function(n){var o=e.labelMap,a=new gv(n,t,i);o.set(a.id,a),r.push(Rp(fv,{label:a,element:t,graphModel:i},a.id))}))})),r}return null},n.prototype.render=function(){return Rp("foreignObject",{id:"lf-label-overlay",class:"lf-label-overlay",children:this.getLabels()})},n.toolName="label-edit-tool",n=m([t.observer],n)}(t.Component),Bv=function(){function e(e){var n,i,o,r=e.lf,a=e.options;this.labelInitPositionMap=new Map,this.lf=r,this.options=null!=a?a:{},this.textOverflowMode=null!==(n=a.textOverflowMode)&&void 0!==n?n:"default",this.isMultiple=null===(i=a.isMultiple)||void 0===i||i,this.labelWidth=a.labelWidth,this.maxCount=null!==(o=a.maxCount)&&void 0!==o?o:1/0,r.graphModel.editConfigModel.updateTextMode(t.TextMode.LABEL),this.addEventListeners(),this.rewriteShortcut(),r.tool.registerTool(Lv.toolName,Lv),r.tool.disableTool("text-edit-tool")}return e.prototype.formatConfig=function(e,n){var i=e.editConfigModel,o=i.nodeTextEdit,r=i.edgeTextEdit,a=i.nodeTextDraggable,s=i.edgeTextDraggable,l=this,u=l.textOverflowMode,c=l.isMultiple,d=l.maxCount,h=l.labelWidth,f=n.text,p=n.zIndex,v=n.properties,m=v._label,y=v._labelOption,b=m,x=void 0===y?{}:y,w=x.isMultiple,E=x.maxCount,C=[];if(tt(b)){var N=null!=E?E:d;C=c&&w?b.length>N?b.slice(0,N):b:[b[0]]}else if(ht(b))C=[b];else if("string"==typeof b||!b){var _=g(g({},f),{content:b||(null==f?void 0:f.value),draggable:"edge"===n.BaseType?s:a});C=_.value?[_]:[]}return"edge"===n.BaseType&&(C=Ju(C,(function(e){return e}))),Ju(C,(function(e){e.id||(e.id=t.createUuid());var i=e.value,l=e.content,c=e.vertical,d=e.editable,f=e.draggable,v=e.textOverflowMode,m="node"===n.BaseType?o:r,y="node"===n.BaseType?a:s;return g(g({},e),{zIndex:p,labelWidth:h,content:null!=l?l:i,vertical:null!=c&&c,editable:m&&d,draggable:y&&f,textOverflowMode:null!=v?v:u})}))},e.prototype.setupLabels=function(e){var t=this;xu(e.sortElements,(function(n){t.rewriteInnerMethods(n);var i=t.formatConfig(e,n);n.setProperty("_label",i)}))},e.prototype.addLabel=function(e,n){var i,o,r,a=this.isMultiple,s=this.maxCount,l=e.properties,u=null!==(i=l._label)&&void 0!==i?i:[],c=null!==(o=l._labelOption)&&void 0!==o?o:{},d=u.length,h={id:t.createUuid(),x:n.x,y:n.y,content:"Label".concat(d+1),value:"Label".concat(d+1),style:{},draggable:!0,editable:!0,vertical:!1};!a||a&&!1===c.isMultiple||d>=(null!==(r=null==c?void 0:c.maxCount)&&void 0!==r?r:s)||(u.push(h),e.setProperty("_label",u))},e.prototype.addEventListeners=function(){var e=this,n=this.lf.graphModel,i=n.eventCenter,o=n.editConfigModel;i.on("graph:rendered",(function(t){var n=t.graphModel;e.setupLabels(n)})),i.on("node:dbclick,edge:dbclick",(function(i){var r=i.e,a=i.data,s=n.getElement(a.id),l=n.getPointByClient({x:r.clientX,y:r.clientY}).canvasOverlayPosition,u={x:l.x,y:l.y};s&&o.textMode===t.TextMode.LABEL&&e.addLabel(s,u)})),i.on("node:resize",(function(e){var t,n,i=e.preData,o=e.data,r=e.model,a=null!==(t=i.properties)&&void 0!==t?t:{},s=a.width,l=a.height,u=a._label,c=void 0===u?[]:u,d=null!==(n=o.properties)&&void 0!==n?n:{},h=d.width,f=d.height;if(s&&l&&h&&f){var p={x:i.x,y:i.y,width:s,height:l},v={x:o.x,y:o.y,width:h,height:f},m=Ju(c,(function(e){var t,n,i,o,r,a,s,l,u,c,d,h=e.x,f=e.y,m=(n=v,i={x:h,y:f},o=(t=p).x,r=t.y,a=t.width,s=t.height,l=n.x,u=n.y,c=n.width,d=n.height,{x:l+(i.x-o)/a*c,y:u+(i.y-r)/s*d});return g(g({},e),m)}));r.setProperty("_label",m)}})),i.on("node:rotate",(function(t){var n=t.model,i=n.x,o=n.y,r=n.rotate,a=n.properties._label,s={x:i,y:o},l=Ju(void 0===a?[]:a,(function(t){if(!t.id)return t;var n={x:t.x,y:t.y};e.labelInitPositionMap.has(t.id)?n=e.labelInitPositionMap.get(t.id):e.labelInitPositionMap.set(t.id,n);var i=r*(180/Math.PI);i<0&&(i+=360);var o=i*(Math.PI/180),a=$g(n,s,o);return g(g(g({},t),a),{rotate:i})}));n.setProperty("_label",l)})),i.on("node:dnd-add,node:add,edge:add",(function(t){var i=t.data,o=n.getElement(i.id);if(o){e.rewriteInnerMethods(o);var r=e.formatConfig(n,i);o.setProperty("_label",r)}}))},e.prototype.rewriteInnerMethods=function(e){e.moveText=function(t,n){if(e.text){var i=e.text,o=i.x,r=i.y,a=i.value,s=i.draggable,l=i.editable;e.text={value:a,editable:l,draggable:s,x:o+t,y:r+n};var u=Ls(e.getProperties());if(tt(u._label)){var c=Ju(u._label,(function(e){return g(g({},e),{x:e.x+t,y:e.y+n})}));null==e||e.setProperty("_label",c)}}}},e.prototype.rewriteShortcut=function(){var e=this,n=this.lf,i=n.keyboard,o=n.graphModel,r=i.options.keyboard;i.off(["backspace"]),i.on(["backspace"],(function(){if(!(null==r?void 0:r.enabled))return!0;if(o.textEditElement)return!0;var n=o.getSelectElements(!0);e.lf.clearSelectElements();var i=e.lf.graphModel.editConfigModel;return n.edges.forEach((function(n){var r=n.properties;if(r&&!qc(r._label)&&i.textMode===t.TextMode.LABEL){var a=r._label.filter((function(e){return!e.isSelected}));if(!Xc(a.length,r._label.length)){var s=o.getEdgeModelById(n.id);return void(null==s||s.setProperty("_label",a))}}n.id&&e.lf.deleteEdge(n.id)})),n.nodes.forEach((function(n){var r=n.properties;if(r&&!qc(r._label)&&i.textMode===t.TextMode.LABEL){var a=r._label.filter((function(e){return!e.isSelected}));if(!Xc(a.length,r._label.length)){var s=o.getNodeModelById(n.id);return void(null==s||s.setProperty("_label",a))}}n.id&&e.lf.deleteNode(n.id)})),!1}))},e.prototype.updateTextMode=function(e){var n=this.lf.graphModel.editConfigModel;e!==n.textMode&&(n.updateTextMode(e),e===t.TextMode.LABEL?(this.lf.tool.enableTool(Lv.toolName),this.lf.tool.disableTool("text-edit-tool")):e===t.TextMode.TEXT&&(this.lf.tool.enableTool("text-edit-tool"),this.lf.tool.disableTool(Lv.toolName)))},e.prototype.render=function(){},e.prototype.destroy=function(){},e.pluginName="label",e}(),jv={};function Fv(e){return e.startsWith("data:text/plain")}function Hv(e){return y(this,void 0,void 0,(function(){return b(this,(function(t){return jv[e]?[2,jv[e]]:[2,new Promise((function(t,n){try{fetch(e).then((function(e){return e.blob()})).then((function(i){var o=new FileReader;o.onloadend=function(){t(jv[e]=o.result)},o.onerror=n,o.readAsDataURL(i)})).catch((function(){t(jv[e]=e)}))}catch(t){return jv[e]=e}}))]}))}))}function Wv(e,t){return y(this,void 0,void 0,(function(){var n,i;return b(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),(n=e.getAttribute(t)||"").startsWith("data:")?[2]:[4,Hv(n)];case 1:return Fv(i=o.sent())?[2]:(e.setAttribute(t,i),[3,3]);case 2:return o.sent(),[3,3];case 3:return[2]}}))}))}function zv(e,t){return y(this,void 0,void 0,(function(){var n;return b(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),t.startsWith("data:")?[2]:[4,Hv(t)];case 1:return Fv(n=i.sent())?[2]:(e.style.backgroundImage="url(".concat(n,")"),[3,3]);case 2:return i.sent(),[3,3];case 3:return[2]}}))}))}function Gv(e){return y(this,void 0,void 0,(function(){var t,n,i,o,r,a,s,l,u;return b(this,(function(c){switch(c.label){case 0:for(t=[e],i=[];t.length;)(n=t.shift()).children.length&&t.push.apply(t,E([],w(n.children),!1)),n instanceof HTMLElement&&(o=n.style,r=o.background,a=o.backgroundImage,(s=r.match(/url\(["']?(.*?)["']?\)/))&&s[1]&&(u=s[1],i.push(zv(n,u))),(l=a.match(/url\(["']?(.*?)["']?\)/))&&l[1]&&(u=l[1],i.push(zv(n,u)))),n instanceof HTMLImageElement?i.push(Wv(n,"src")):n instanceof SVGImageElement&&i.push(Wv(n,"href"));return[4,Promise.all(i)];case 1:return c.sent(),[2]}}))}))}function Uv(e,t,n){var i=document.createElement("canvas");i.width=t,i.height=n;var o=i.getContext("2d");return o&&o.drawImage(e,0,0,e.width,e.height,0,0,t,n),i}var qv=function(){function e(e){var t=e.lf,n=this;this.lf=t,this.customCssRules="",this.useGlobalRules=!0,t.getSnapshot=function(e,t){return y(n,void 0,void 0,(function(){return b(this,(function(n){switch(n.label){case 0:return[4,this.getSnapshot(e,t)];case 1:return[2,n.sent()]}}))}))},t.getSnapshotBlob=function(e,t){return y(n,void 0,void 0,(function(){return b(this,(function(n){switch(n.label){case 0:return[4,this.getSnapshotBlob(e,t)];case 1:return[2,n.sent()]}}))}))},t.getSnapshotBase64=function(e,t){return y(n,void 0,void 0,(function(){return b(this,(function(n){switch(n.label){case 0:return[4,this.getSnapshotBase64(e,t)];case 1:return[2,n.sent()]}}))}))}}return e.prototype.getSvgRootElement=function(e){return e.container.querySelector(".lf-canvas-overlay")},e.prototype.triggerDownload=function(e){var t=new MouseEvent("click",{view:document.defaultView,bubbles:!1,cancelable:!0}),n=document.createElement("a");n.setAttribute("download",this.fileName),n.setAttribute("href",e),n.setAttribute("target","_blank"),n.dispatchEvent(t)},e.prototype.removeAnchor=function(e){for(var t=e.childNodes,n=e.childNodes&&e.childNodes.length,i=0;i<n;i++){var o=t[i];(o.classList&&Array.from(o.classList)||[]).indexOf("lf-anchor")>-1&&(e.removeChild(e.childNodes[i]),n--,i--)}},e.prototype.removeRotateControl=function(e){for(var t=e.childNodes,n=e.childNodes&&e.childNodes.length,i=0;i<n;i++){var o=t[i];(o.classList&&Array.from(o.classList)||[]).indexOf("lf-rotate-control")>-1&&(e.removeChild(e.childNodes[i]),n--,i--)}},e.prototype.getSnapshot=function(e,t){return y(this,void 0,void 0,(function(){var n,i,o,r,a=this;return b(this,(function(s){switch(s.label){case 0:return n=this.lf.graphModel.getPartial(),i=(null!=t?t:{}).partial,o=void 0===i?n:i,r=this.lf.getEditConfig(),this.lf.updateEditConfig({isSilentMode:!0,stopScrollGraph:!0,stopMoveGraph:!0}),n===o?[3,1]:(this.lf.graphModel.setPartial(o),this.lf.graphModel.eventCenter.once("graph:updated",(function(){return y(a,void 0,void 0,(function(){return b(this,(function(i){switch(i.label){case 0:return[4,this.snapshot(e,t)];case 1:return i.sent(),this.lf.graphModel.setPartial(n),[2]}}))}))})),[3,3]);case 1:return[4,this.snapshot(e,t)];case 2:s.sent(),s.label=3;case 3:return this.lf.updateEditConfig(r),[2]}}))}))},e.prototype.snapshot=function(e,t){return y(this,void 0,void 0,(function(){var n,i,o,r,a,s,l,u,c,d=this;return b(this,(function(h){switch(h.label){case 0:return i=(n=null!=t?t:{}).fileType,o=void 0===i?"png":i,r=n.quality,this.fileName="".concat(null!=e?e:"logic-flow.".concat(Date.now()),".").concat(o),[4,Gv(a=this.getSvgRootElement(this.lf))];case 1:return h.sent(),"svg"===o?(s=this.cloneSvg(a),l=(new XMLSerializer).serializeToString(s),u=new Blob([l],{type:"image/svg+xml;charset=utf-8"}),c=URL.createObjectURL(u),this.triggerDownload(c)):this.getCanvasData(a,null!=t?t:{}).then((function(e){var t=e.toDataURL("image/".concat(o),r).replace("image/".concat(o),"image/octet-stream");d.triggerDownload(t)})),[2]}}))}))},e.prototype.getSnapshotBase64=function(e,t){return y(this,void 0,void 0,(function(){var n,i=this;return b(this,(function(o){switch(o.label){case 0:return[4,Gv(n=this.getSvgRootElement(this.lf))];case 1:return o.sent(),[2,new Promise((function(o){i.getCanvasData(n,{backgroundColor:e}).then((function(e){var n=e.toDataURL("image/".concat(null!=t?t:"png"));o({data:n,width:e.width,height:e.height})}))}))]}}))}))},e.prototype.getSnapshotBlob=function(e,t){return y(this,void 0,void 0,(function(){var n,i=this;return b(this,(function(o){switch(o.label){case 0:return[4,Gv(n=this.getSvgRootElement(this.lf))];case 1:return o.sent(),[2,new Promise((function(o){i.getCanvasData(n,{backgroundColor:e}).then((function(e){e.toBlob((function(t){o({data:t,width:e.width,height:e.height})}),"image/".concat(null!=t?t:"png"))}))}))]}}))}))},e.prototype.getClassRules=function(){var e="";if(this.useGlobalRules)for(var t=document.styleSheets,n=0;n<t.length;n++){var i=t[n];try{for(var o=0;o<i.cssRules.length;o++)e+=i.cssRules[o].cssText}catch(e){}}return this.customCssRules&&(e+=this.customCssRules),e},e.prototype.getCanvasData=function(e,t){return y(this,void 0,void 0,(function(){var n,i,o,r,a,s,l,u,c,d,h,f,p,g,v,m,y,x,w,E,C,N,_,S,M,T;return b(this,(function(b){return n=t.width,i=t.height,o=t.backgroundColor,r=t.padding,a=void 0===r?40:r,s=this.cloneSvg(e,!1),(l=window.devicePixelRatio||1)<1&&(l=1),u=this.lf.graphModel.rootEl.querySelector(".lf-base"),c=u.getBoundingClientRect(),d=this.lf.container.querySelector(".lf-canvas-overlay"),h=d.getBoundingClientRect(),f=c.x-h.x,p=c.y-h.y,g=this.lf.graphModel,v=g.transformModel,m=v.SCALE_X,y=v.SCALE_Y,x=v.TRANSLATE_X,w=v.TRANSLATE_Y,s.lastChild.style.transform="matrix(1, 0, 0, 1, ".concat((-f+x)*(1/m),", ").concat((-p+w)*(1/y),")"),E=Math.ceil(c.width/m),C=Math.ceil(c.height/y),(N=document.createElement("canvas")).style.width="".concat(E,"px"),N.style.height="".concat(C,"px"),N.width=E*l+2*a,N.height=C*l+2*a,(_=N.getContext("2d"))&&(_.clearRect(0,0,N.width,N.height),_.scale(l,l),o?(_.fillStyle=o,_.fillRect(0,0,N.width,N.height)):_.clearRect(0,0,N.width,N.height)),S=new Image,(M=document.createElement("style")).innerHTML=this.getClassRules(),(T=document.createElement("foreignObject")).appendChild(M),s.appendChild(T),[2,new Promise((function(e){S.onload=function(){var t=navigator.userAgent.indexOf("Firefox")>-1;try{t?createImageBitmap(S,{resizeWidth:n&&i?Uv(N,n,i).width:N.width,resizeHeight:n&&i?Uv(N,n,i).height:N.height}).then((function(t){null==_||_.drawImage(t,a/l,a/l),e(n&&i?Uv(N,n,i):N)})):(null==_||_.drawImage(S,a/l,a/l),e(n&&i?Uv(N,n,i):N))}catch(t){null==_||_.drawImage(S,a/l,a/l),e(n&&i?Uv(N,n,i):N)}};var t="data:image/svg+xml;charset=utf-8,".concat((new XMLSerializer).serializeToString(s)).replace(/\n/g,"").replace(/\t/g,"").replace(/#/g,"%23");S.src=t}))]}))}))},e.prototype.cloneSvg=function(e,t){var n,i=this;void 0===t&&(t=!0);var o=e.cloneNode(!0),r=o.lastChild,a=null===(n=null==r?void 0:r.childNodes)||void 0===n?void 0:n.length;if(a)for(var s=0;s<a;s++){var l=null==r?void 0:r.childNodes[s],u=l.classList&&Array.from(l.classList);if(u&&u.indexOf("lf-base")<0)null==r||r.removeChild(r.childNodes[s]),a--,s--;else{var c=null==r?void 0:r.childNodes[s];c&&c.childNodes.forEach((function(e){var t=e;i.removeAnchor(t.firstChild),i.removeRotateControl(t.firstChild)}))}}if(t){var d=document.createElement("style");d.innerHTML=this.getClassRules();var h=document.createElement("foreignObject");h.appendChild(d),o.appendChild(h)}return o},e.pluginName="snapshot",e}(),Xv=function(){function e(e){var t=e.lf,n=this;this.lf=t,this.paths=[],t.getPathes=function(){if(!n.startNodeType)throw new Error("需要预先指定开始节点类型");return n.getPathes()},t.setRawPaths=function(e){n.setPathes(e)},t.getRawPathes=function(){return n.paths},t.setStartNodeType=function(e){n.startNodeType=e}}return e.prototype.setPathes=function(e){this.paths=e.map((function(e){return{routeId:e.routeId,name:e.name,elements:e.elements,type:e.type,similarElement:null,weight:0}}))},e.prototype.getPathes=function(){var e=this,t=this.lf.getGraphRawData(),n=new Map,i=[];t.nodes.forEach((function(t){n.set(t.id,{id:t.id,data:t,nextNodes:[]}),t.type===e.startNodeType&&i.push(t.id)})),t.edges.forEach((function(e){var t=n.get(e.sourceNodeId);null==t||t.nextNodes.push(e.targetNodeId)}));var o=[];return i.forEach((function(t){var i=n.get(t);i&&(o=o.concat(e.findPathElements(i,n,[])))})),this.getNewPathes(o)},e.prototype.findPathElements=function(e,t,n){void 0===n&&(n=[]);var i=E([],w(n),!1);if(i.push(e.id),0===e.nextNodes.length)return[i];for(var o=[],r=0;r<e.nextNodes.length;r++){var a=t.get(e.nextNodes[r]),s=void 0;if(a){var l=i.indexOf(a.id);s=-1!==l?[E(E([],w(i.slice(l)),!1),[a.id],!1)]:this.findPathElements(a,t,E([],w(i),!1)),o=o.concat(s)}}return o},e.prototype.getNewPathes=function(e){var t=this,n=[],i=new Set;e.forEach((function(e){var o=t.getNewId("path"),r=t.getNewId("路径"),a=t.isLoopPath(e),s=e.join(",");i.has(s)||(i.add(s),n.push({routeId:o,name:r,elements:e,type:a,weight:0,similarElement:""}))}));var o=JSON.parse(JSON.stringify(this.paths));return n.forEach((function(e){for(var n=0;n<o.length;n++){var i=o[n],r=t.similar2Path(E([],w(e.elements),!1),E([],w(i.elements),!1));r>e.weight&&i.weight<=r&&(e.weight=r,e.similarElement=i,r===i.weight&&i.similarElement?(i.similarElement.similarElement=null,i.similarElement.weight=0,i.similarElement=null,i.weight=0):(i.similarElement=e,i.weight=r))}})),n.forEach((function(e){e.similarElement&&e.similarElement.similarElement===e&&(e.routeId=e.similarElement.routeId,e.name=e.similarElement.name),delete e.similarElement,delete e.weight})),this.setPathes(n),n},e.prototype.similar2Path=function(e,t){var n=0,i=e.length+t.length;e.sort(),t.sort();for(var o=e.shift(),r=t.shift();void 0!==o&&void 0!==r;)o===r?(n++,o=e.shift(),r=t.shift()):o<r?o=e.shift():o>r&&(r=t.shift());return n/i*200},e.prototype.getNewId=function(e){return"".concat(e,"_").concat(_())},e.prototype.isLoopPath=function(e){var t=e.length;return e.indexOf(e[t-1])!==t-1?1:0},e.pluginName="flowPath",e}(),Vv=-1,Kv=0,Yv=1,$v=function(){function e(e){var t=e.lf,n=this;this.levelHeight=[],this.newNodeMap=new Map,this.lf=t,this.trunk=[],t.layout=function(e){var t=n.lf.getGraphRawData();n.lf.setStartNodeType(e);var i=n.lf.getPathes();return n.levelHeight=[],n.newNodeMap=new Map,n.layout(t,i)}}return e.prototype.layout=function(e,t){var n=this,i=[];t.forEach((function(e){var t=e.elements;t.length>i.length?i=t:t.length===i.length&&JSON.stringify(t)===JSON.stringify(n.trunk)&&(i=n.trunk)})),this.trunk=i;for(var o=this.formatData(e),r={nodes:[],edges:[]},a=i.length-1;a>=0;a--)this.setNodePosition(i[a],o,r,a,1);this.lf.graphModel.graphDataToModel(r)},e.prototype.setNodePosition=function(e,t,n,i,o){var r=this,a=t[e],s=a.text,l=a.type,u=a.next,c=a.properties,d=160*i+40,h=120*o,f={id:e,x:d,text:s,y:h,type:l,properties:c};return s&&"object"==typeof s&&(f.text=g(g({},s),{x:d+s.x,y:h+s.y})),this.newNodeMap.set(f.id,{x:f.x,y:f.y,type:l}),n.nodes.push(f),a.isFixed=!0,this.addLevelHeight(i,1),u&&u.length>0&&u.forEach((function(o){if(!t[o.nodeId].isFixed){var a=r.getLevelHeight(i+1);r.addLevelHeight(i,1),r.setNodePosition(o.nodeId,t,n,i+1,a+1)}n.edges.push(g({id:o.edgeId,type:o.edgeType,sourceNodeId:e,targetNodeId:o.nodeId,properties:o.properties,text:o.text},r.getEdgeDataPoints(e,o.nodeId)))})),f},e.prototype.getEdgeDataPoints=function(e,t){var n=this.newNodeMap.get(e),i=this.newNodeMap.get(t),o=this.getShape(e),r=o.width,a=o.height,s=this.getShape(t),l=s.width,u=s.height,c=this.getRelativePosition(n,i),d={x:n.x,y:n.y},h={x:i.x,y:i.y};switch(c){case Kv:d.x=n.x+r/2,h.x=i.x-l/2;break;case Vv:d.y=n.y+a/2,h.x=i.x-l/2;break;case Yv:d.x=n.x+r/2,h.y=i.y+u/2}return{startPoint:d,endPoint:h}},e.prototype.getRelativePosition=function(e,t){var n=e.y,i=t.y;return n<i?-1:n===i?0:1},e.prototype.getShape=function(e){var t,n,i=this.lf.getNodeModelById(e);return{height:null!==(t=null==i?void 0:i.height)&&void 0!==t?t:0,width:null!==(n=null==i?void 0:i.width)&&void 0!==n?n:0}},e.prototype.formatData=function(e){var t=e.nodes.reduce((function(e,t){var n=t.type,i=t.properties,o=t.text,r=t.x,a=t.y;return o&&"object"==typeof o&&(o.x=o.x-r,o.y=o.y-a),e[t.id]={type:n,properties:i,text:o,prev:[],next:[]},e}),{});return e.edges.forEach((function(e){var n=e.sourceNodeId,i=e.targetNodeId,o=e.id,r=e.properties,a=e.text,s=a;"object"==typeof a&&(s=a.value),t[n].next.push({edgeId:o,nodeId:i,edgeType:e.type,properties:r,text:s}),t[i].prev.push({edgeId:o,nodeId:n,properties:r,text:s})})),t},e.prototype.addLevelHeight=function(e,t,n){void 0===t&&(t=1),void 0===n&&(n=!1);var i=this.levelHeight[e];i||(i={positiveHeight:0,negativeHeight:0},this.levelHeight[e]=i),n?i.negativeHeight-=t:i.positiveHeight+=t},e.prototype.getLevelHeight=function(e,t){void 0===t&&(t=!1);var n=this.levelHeight[e];return n?t?n.negativeHeight:n.positiveHeight:0},e.pluginName="AutoLayout",e}(),Zv=function(){function e(e){var t=e.lf,n=e.options;this.enable=!0,this.currentDistance=1/0,this.thresholdDistance=100,this.reverseDirection=!1,this.virtualEdgeStyle={strokeDasharray:"10,10",stroke:"#acacac"},this.lf=t,so(this,n)}return e.prototype.render=function(){this.addEventListeners()},e.prototype.addEventListeners=function(){var e=this;this.lf.graphModel.eventCenter.on("node:dragstart",(function(t){var n=t.data;if(e.enable){var i=e.lf.graphModel,o=n.id;e.currentNode=i.getNodeModelById(o)}})),this.lf.graphModel.eventCenter.on("node:drag",(function(){e.handleNodeDrag()})),this.lf.graphModel.eventCenter.on("anchor:dragstart",(function(t){var n=t.data,i=t.nodeModel;e.enable&&(e.currentNode=i,e.currentAnchor=n)})),this.lf.graphModel.eventCenter.on("anchor:drag",(function(t){var n=t.e,i=n.clientX,o=n.clientY;e.enable&&e.handleAnchorDrag(i,o)})),this.lf.graphModel.eventCenter.on("node:drop,anchor:dragend",(function(){e.enable&&e.handleDrop()}))},e.prototype.handleNodeDrag=function(){var e=this.lf.graphModel.nodes;if(!Qc(this.virtualEdge)){var n=this.virtualEdge,i=n.startPoint,o=n.endPoint,r=n.id;t.twoPointDistance(i,o)>this.thresholdDistance&&(this.lf.deleteEdge(r),this.virtualEdge=void 0)}this.currentNode&&this.findClosestAnchorOfNode(this.currentNode,e),this.currentDistance<this.thresholdDistance&&this.addVirtualEdge()},e.prototype.handleDrop=function(){this.addActualEdge(),this.resetData()},e.prototype.handleAnchorDrag=function(e,n){var i=this.lf.graphModel,o=i.getPointByClient({x:e,y:n}).canvasOverlayPosition,r=o.x,a=o.y;if(!Qc(r)&&!Qc(a)){var s={x:r,y:a},l=i.nodes;if(!Qc(this.virtualEdge)){var u=this.virtualEdge,c=u.endPoint,d=u.id;t.twoPointDistance(s,c)>this.thresholdDistance&&(this.lf.deleteEdge(d),this.virtualEdge=void 0)}this.findClosestAnchorOfAnchor(s,l),this.currentDistance<this.thresholdDistance&&this.addVirtualEdge()}},e.prototype.findClosestAnchorOfNode=function(e,n){var i=this;if(!Qc(e)&&!qc(e)){var o,r,a,s,l=e.anchors,u=void 0===l?[]:l,c=e.id;n.forEach((function(e){if(!Xc(e.id,c)){var n=e.anchors;(void 0===n?[]:n).forEach((function(n){u.forEach((function(l){if(i.anchorAllowConnect(e,n,l)){var u=t.twoPointDistance(l,n);(!o||u<o)&&(o=u,r=l,a=n,s=e)}}))}))}})),this.currentDistance=o,this.currentAnchor=r,this.closestAnchor=a,this.closestNode=s}},e.prototype.findClosestAnchorOfAnchor=function(e,n){var i=this;if(!Qc(e)){var o,r,a,s=this.currentNode,l=this.currentAnchor;n.forEach((function(n){if(s){var u=n.anchors;(void 0===u?[]:u).forEach((function(s){var u;if(!Xc(null===(u=i.currentAnchor)||void 0===u?void 0:u.id,s.id)&&i.anchorAllowConnect(n,s,l)){var c=t.twoPointDistance(e,s);(!o||c<o)&&(o=c,r=s,a=n)}}))}})),this.currentDistance=o,this.closestAnchor=r,this.closestNode=a}},e.prototype.anchorAllowConnect=function(e,t,n){var i=this.currentNode;if(i){var o=(this.reverseDirection?e.isAllowConnectedAsSource(i,t,n):i.isAllowConnectedAsSource(e,n,t)).isAllPass,r=(this.reverseDirection?i.isAllowConnectedAsTarget(e,t,n):e.isAllowConnectedAsTarget(i,n,t)).isAllPass;return o&&r}},e.prototype.sameEdgeIsExist=function(e){if(Qc(this.closestNode)||Qc(this.currentNode)||Qc(this.closestAnchor)||Qc(this.currentAnchor))return!1;if(Qc(e))return!1;var t=this,n=t.closestNode.id,i=t.currentNode.id,o=t.closestAnchor.id,r=t.currentAnchor.id,a=t.reverseDirection,s=e.sourceNodeId,l=e.targetNodeId,u=e.sourceAnchorId,c=e.targetAnchorId;return a?Xc(n,s)&&Xc(i,l)&&Xc(o,u)&&Xc(r,c):Xc(i,s)&&Xc(n,l)&&Xc(r,u)&&Xc(o,c)},e.prototype.addVirtualEdge=function(){var e=this,t=jh(this.lf.graphModel.edges,(function(t,n){return n.virtual?t:t||e.sameEdgeIsExist(n)}),!1);if(!t){if(!Qc(this.virtualEdge)){var n=this.virtualEdge.id;if(this.sameEdgeIsExist(this.virtualEdge))return;this.lf.deleteEdge(n)}var i=this,o=i.reverseDirection,r=i.currentNode,a=i.closestNode,s=i.currentAnchor,l=i.closestAnchor;if(!qc(r)&&!qc(a)){var u={style:this.virtualEdgeStyle};this.virtualEdge=this.lf.addEdge(o?{sourceNodeId:null==a?void 0:a.id,targetNodeId:null==r?void 0:r.id,sourceAnchorId:null==l?void 0:l.id,targetAnchorId:null==s?void 0:s.id,properties:u}:{sourceNodeId:null==r?void 0:r.id,targetNodeId:null==a?void 0:a.id,sourceAnchorId:null==s?void 0:s.id,targetAnchorId:null==l?void 0:l.id,properties:u}),this.virtualEdge.virtual=!0}}},e.prototype.addActualEdge=function(){if(!Qc(this.virtualEdge)){var e=this.virtualEdge,t=e.type,n=e.sourceNodeId,i=e.targetNodeId,o=e.sourceAnchorId,r=e.targetAnchorId,a=e.startPoint,s=e.endPoint,l=e.pointsList;this.lf.addEdge({type:t,sourceNodeId:n,targetNodeId:i,sourceAnchorId:o,targetAnchorId:r,startPoint:a,endPoint:s,pointsList:l}),this.lf.deleteEdge(this.virtualEdge.id)}},e.prototype.setVirtualEdgeStyle=function(e){this.virtualEdgeStyle=g(g({},this.virtualEdgeStyle),e)},e.prototype.setThresholdDistance=function(e){Kc(e)&&(this.thresholdDistance=e)},e.prototype.setReverseDirection=function(e){this.reverseDirection=e},e.prototype.setEnable=function(e){this.enable=e,e||this.resetData()},e.prototype.resetData=function(){this.closestNode=void 0,this.currentDistance=1/0,this.currentNode=void 0,this.currentAnchor=void 0,this.closestAnchor=void 0,this.virtualEdge=void 0},e.pluginName="proximityConnect",e}(),Jv=function(){function e(e){var t=e.lf,n=this;this.controlItems=[{key:"zoom-out",iconClass:"lf-control-zoomOut",title:"缩小流程图",text:"缩小",onClick:function(){n.lf.zoom(!1)}},{key:"zoom-in",iconClass:"lf-control-zoomIn",title:"放大流程图",text:"放大",onClick:function(){n.lf.zoom(!0)}},{key:"reset",iconClass:"lf-control-fit",title:"恢复流程原有尺寸",text:"适应",onClick:function(){n.lf.resetZoom()}},{key:"undo",iconClass:"lf-control-undo",title:"回到上一步",text:"上一步",onClick:function(){n.lf.undo()}},{key:"redo",iconClass:"lf-control-redo",title:"移到下一步",text:"下一步",onClick:function(){n.lf.redo()}}],this.lf=t}return e.prototype.render=function(e,t){this.destroy();var n=this.getControlTool();this.toolEl=n,t.appendChild(n),this.domContainer=t},e.prototype.destroy=function(){this.domContainer&&this.toolEl&&this.domContainer.contains(this.toolEl)&&this.domContainer.removeChild(this.toolEl)},e.prototype.addItem=function(e){this.controlItems.push(e)},e.prototype.removeItem=function(e){var t=this.controlItems.findIndex((function(t){return t.key===e}));return-1==t?null:this.controlItems.splice(t,1)[0]},e.prototype.getControlTool=function(){var e=this,t="lf-control-item",n="lf-control-item disabled",i=document.createElement("div"),o=[];return i.className="lf-control",this.controlItems.forEach((function(i){var r=document.createElement("div"),a=document.createElement("i"),s=document.createElement("span");switch(r.className=n,i.onClick&&(r.onclick=i.onClick.bind(null,e.lf)),i.onMouseEnter&&(r.onmouseenter=i.onMouseEnter.bind(null,e.lf)),i.onMouseLeave&&(r.onmouseleave=i.onMouseLeave.bind(null,e.lf)),a.className=i.iconClass,s.className="lf-control-text",s.title=i.title,s.innerText=i.text,r.append(a,s),i.text){case"上一步":e.lf.on("history:change",(function(e){var i=e.data.undoAble;r.className=i?t:n}));break;case"下一步":e.lf.on("history:change",(function(e){var i=e.data.redoAble;r.className=i?t:n}));break;default:r.className=t}o.push(r)})),i.append.apply(i,E([],w(o),!1)),i},e.pluginName="control",e}(),Qv="lf:defaultNodeMenu",em="lf:defaultEdgeMenu",tm="lf:defaultGraphMenu",nm="lf:defaultSelectionMenu",im=function(){function e(e){var t=e.lf,n=this;this.__currentData=null,this.lf=t,t.options.isSilentMode||(this.__menuDOM=document.createElement("ul"),this.menuTypeMap=new Map,this.init(),this.lf.setMenuConfig=function(e){n.setMenuConfig(e)},this.lf.addMenuConfig=function(e){n.addMenuConfig(e)},this.lf.setMenuByType=function(e){n.setMenuByType(e)})}return e.prototype.init=function(){var e,t,n,i,o=this,r=[{text:"删除",callback:function(e){o.lf.deleteNode(e.id)}},{text:"编辑文本",callback:function(e){o.lf.graphModel.editText(e.id)}},{text:"复制",callback:function(e){o.lf.cloneNode(e.id)}}];null===(e=this.menuTypeMap)||void 0===e||e.set(Qv,r);var a=[{text:"删除",callback:function(e){o.lf.deleteEdge(e.id)}},{text:"编辑文本",callback:function(e){o.lf.graphModel.editText(e.id)}}];null===(t=this.menuTypeMap)||void 0===t||t.set(em,a),null===(n=this.menuTypeMap)||void 0===n||n.set(tm,[]);var s=[{text:"删除",callback:function(e){o.lf.clearSelectElements(),e.edges.forEach((function(e){return o.lf.deleteEdge(e.id)})),e.nodes.forEach((function(e){return o.lf.deleteNode(e.id)}))}}];null===(i=this.menuTypeMap)||void 0===i||i.set(nm,s)},e.prototype.render=function(e,t){var n=this;e.options.isSilentMode||(this.__container=t,this.__currentData=null,this.__menuDOM&&(this.__menuDOM.className="lf-menu",t.appendChild(this.__menuDOM),this.__menuDOM.addEventListener("click",(function(e){e.stopPropagation();for(var t=e.target;-1===Array.from(t.classList).indexOf("lf-menu-item")&&-1===Array.from(t.classList).indexOf("lf-menu");)t=null==t?void 0:t.parentElement;Array.from(t.classList).indexOf("lf-menu-item")>-1&&(t.onclickCallback(n.__currentData),n.__menuDOM&&(n.__menuDOM.style.display="none"),n.__currentData=null)}),!0)),this.lf.on("node:contextmenu",(function(e){var t,i,o=e.data,r=e.position,a=e.e,s=r.domOverlayPosition,l=s.x,u=s.y,c=o.id,d=n.lf.graphModel.getNodeModelById(c);if(d){var h=[],f=null===(t=n.menuTypeMap)||void 0===t?void 0:t.get(d.type);h=d&&d.menu&&Array.isArray(d.menu)?d.menu:f||(null===(i=n.menuTypeMap)||void 0===i?void 0:i.get(Qv)),n.__currentData=o,n.showMenu(l,u,h,{width:d.width,height:d.height,clientX:a.clientX,clientY:a.clientY})}})),this.lf.on("edge:contextmenu",(function(e){var t,i,o,r=e.data,a=e.position,s=e.e,l=a.domOverlayPosition,u=l.x,c=l.y,d=r.id,h=n.lf.graphModel.getEdgeModelById(d);if(h){var f=[],p=null===(t=n.menuTypeMap)||void 0===t?void 0:t.get(h.type);f=h&&h.menu&&Array.isArray(h.menu)?h.menu:p||(null!==(o=null===(i=n.menuTypeMap)||void 0===i?void 0:i.get(em))&&void 0!==o?o:[]),n.__currentData=r,n.showMenu(u,c,f,{width:h.width,height:h.height,clientX:s.clientX,clientY:s.clientY})}})),this.lf.on("blank:contextmenu",(function(e){var t,i,o=e.position,r=null!==(i=null===(t=n.menuTypeMap)||void 0===t?void 0:t.get(tm))&&void 0!==i?i:[],a=o.domOverlayPosition,s=a.x,l=a.y;n.showMenu(s,l,r)})),this.lf.on("selection:contextmenu",(function(e){var t,i=e.data,o=e.position,r=null===(t=n.menuTypeMap)||void 0===t?void 0:t.get(nm),a=o.domOverlayPosition,s=a.x,l=a.y;n.__currentData=i,n.showMenu(s,l,r)})),this.lf.on("node:mousedown",(function(){n.__menuDOM.style.display="none"})),this.lf.on("edge:click",(function(){n.__menuDOM.style.display="none"})),this.lf.on("blank:click",(function(){n.__menuDOM.style.display="none"})))},e.prototype.destroy=function(){var e;this.__menuDOM&&(null===(e=null==this?void 0:this.__container)||void 0===e||e.removeChild(this.__menuDOM),this.__menuDOM=void 0)},e.prototype.showMenu=function(e,t,n,i){if(n&&n.length){var o=this.__menuDOM;if(o){if(o.innerHTML="",o.append.apply(o,E([],w(this.__getMenuDom(n)),!1)),!o.children.length)return;if(o.style.display="block",!i)return o.style.top="".concat(t,"px"),void(o.style.left="".concat(e,"px"));var r=i.width,a=i.height,s=i.clientX,l=i.clientY,u=this.lf.graphModel,c=o.offsetWidth,d=!0,h=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,f=h-s,p=u.rootEl.getBoundingClientRect(),g=p.left+p.width;g<h&&(f=g-s),f<c&&(d=!1),o.style.left="".concat(d?e:e-r,"px");var v=o.offsetHeight,m=!0,y=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,b=y-l,x=p.top+p.height;x<y&&(b=x-l),b<v&&(m=!1),o.style.top="".concat(m?t:t-a,"px")}}},e.prototype.setMenuByType=function(e){var t,n=e.type,i=e.menu;n&&i&&(null===(t=this.menuTypeMap)||void 0===t||t.set(n,i))},e.prototype.__getMenuDom=function(e){var t=[];return e&&e.length>0&&e.forEach((function(e){var n=document.createElement("li");if(e.className?n.className="lf-menu-item ".concat(e.className):n.className="lf-menu-item",!0===e.icon){var i=document.createElement("span");i.className="lf-menu-item-icon",n.appendChild(i)}var o=document.createElement("span");o.className="lf-menu-item-text",e.text&&(o.innerText=e.text),n.appendChild(o),n.onclickCallback=e.callback,t.push(n)})),t},e.prototype.setMenuConfig=function(e){var t,n,i;e&&(void 0!==e.nodeMenu&&(null===(t=this.menuTypeMap)||void 0===t||t.set(Qv,e.nodeMenu?e.nodeMenu:[])),void 0!==e.edgeMenu&&(null===(n=this.menuTypeMap)||void 0===n||n.set(em,e.edgeMenu?e.edgeMenu:[])),void 0!==e.graphMenu&&(null===(i=this.menuTypeMap)||void 0===i||i.set(tm,e.graphMenu?e.graphMenu:[])))},e.prototype.addMenuConfig=function(e){var t,n,i,o,r,a,s,l,u;if(e){if(Array.isArray(e.nodeMenu)){var c=null!==(n=null===(t=this.menuTypeMap)||void 0===t?void 0:t.get(Qv))&&void 0!==n?n:[];null===(i=this.menuTypeMap)||void 0===i||i.set(Qv,c.concat(e.nodeMenu))}if(Array.isArray(e.edgeMenu)){c=null!==(r=null===(o=this.menuTypeMap)||void 0===o?void 0:o.get(em))&&void 0!==r?r:[];null===(a=this.menuTypeMap)||void 0===a||a.set(em,c.concat(e.edgeMenu))}if(Array.isArray(e.graphMenu)){c=null!==(l=null===(s=this.menuTypeMap)||void 0===s?void 0:s.get(tm))&&void 0!==l?l:[];null===(u=this.menuTypeMap)||void 0===u||u.set(tm,c.concat(e.graphMenu))}}},e.prototype.changeMenuItem=function(e,t){if("add"===e)this.addMenuConfig(t);else{if("reset"!==e)throw new Error("The first parameter of changeMenuConfig should be 'add' or 'reset'");this.setMenuConfig(t)}},e.pluginName="menu",e}(),om="menu-common",rm=function(){function e(e){var t=e.lf,n=this;this.menuTypeMap=new Map,this.listenDelete=function(){n.hideContextMenu()},this.lf=t,this.__menuDOM=document.createElement("div"),this.__menuDOM.className="lf-inner-context",this.menuTypeMap.set(om,[]),this.lf.setContextMenuByType=function(e,t){n.setContextMenuByType(e,t)},this.lf.setContextMenuItems=function(e){n.setContextMenuItems(e)},this.lf.showContextMenu=function(e){n.showContextMenu(e)},this.lf.hideContextMenu=function(){n.hideContextMenu()}}return e.prototype.render=function(e,t){var n=this;this.container=t,e.on("node:click",(function(e){var t=e.data;n._activeData=t,n.createContextMenu()})),e.on("edge:click",(function(e){var t=e.data;n._activeData=t,n.createContextMenu()})),e.on("blank:click",(function(){n.hideContextMenu()}))},e.prototype.setContextMenuByType=function(e,t){this.menuTypeMap.set(e,t)},e.prototype.hideContextMenu=function(){this.__menuDOM.innerHTML="",this.__menuDOM.style.display="none",this.isShow&&this.container.removeChild(this.__menuDOM),this.lf.off("node:delete,edge:delete,node:drag,graph:transform",this.listenDelete),this.isShow=!1},e.prototype.showContextMenu=function(e){e&&e.id&&(this._activeData=e,this.createContextMenu())},e.prototype.setContextMenuItems=function(e){this.menuTypeMap.set(om,e)},e.prototype.getContextMenuPosition=function(){var e=this._activeData,t=this.lf.graphModel.getElement(e.id);if(t){var n,i;if("edge"===t.BaseType){n=Number.MIN_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER;var o=t.getData();n=Math.max(o.startPoint.x,n),i=Math.min(o.startPoint.y,i),n=Math.max(o.endPoint.x,n),i=Math.min(o.endPoint.y,i),o.pointsList&&o.pointsList.forEach((function(e){n=Math.max(e.x,n),i=Math.min(e.y,i)}))}return"node"===t.BaseType&&(n=e.x+t.width/2,i=e.y-t.height/2),this.lf.graphModel.transformModel.CanvasPointToHtmlPoint([n,i])}},e.prototype.createContextMenu=function(){var e=this;if(!this.lf.options.isSilentMode){var t=E(E([],w(this.menuTypeMap.get(this._activeData.type)||[]),!1),w(this.menuTypeMap.get(om)||[]),!1),n=document.createDocumentFragment();t.forEach((function(t){var i=document.createElement("div");i.className="lf-context-item";var o=document.createElement("img");o.src=t.icon,o.className="lf-context-img",t.className&&(i.className="".concat(i.className," ").concat(t.className)),o.addEventListener("click",(function(){e.hideContextMenu(),t.callback?t.callback(e._activeData):e.addNode({sourceId:e._activeData.id,x:e._activeData.x,y:e._activeData.y,properties:t.properties,type:t.type})})),i.appendChild(o),n.appendChild(i)})),this.__menuDOM.innerHTML="",this.__menuDOM.appendChild(n),this.showMenu()}},e.prototype.addNode=function(e,t){var n=void 0!==t;void 0===t&&(t=e.y);var i=this.lf.getNodeModelById(e.sourceId);if(i){var o=e.x-i.width+200,r=t-e.y/2-20,a=e.x+i.width+200,s=t+e.y/2+20;if(this.lf.getAreaElement([o,r],[a,s]).length)return t+=100,void this.addNode(e,t);if(e.type){var l=this.lf.addNode({type:e.type,x:e.x+200,y:t,properties:e.properties}),u=void 0,c=void 0;n&&(u={x:e.x,y:e.y+i.height/2},c={x:l.x-l.width/2,y:l.y}),this.lf.addEdge({sourceNodeId:e.sourceId,targetNodeId:l.id,startPoint:u,endPoint:c})}}},e.prototype.showMenu=function(){var e=this.getContextMenuPosition();if(e){var t=w(e,2),n=t[0],i=t[1];this.__menuDOM.style.display="flex",this.__menuDOM.style.top="".concat(i,"px"),this.__menuDOM.style.left="".concat(n+10,"px"),this.container.appendChild(this.__menuDOM),!this.isShow&&this.lf.on("node:delete,edge:delete,node:drag,graph:transform",this.listenDelete),this.isShow=!0}},e.pluginName="contextMenu",e}(),am=function(){function e(e){var t=e.lf,n=this;this.lf=t,this.lf.setPatternItems=function(e){n.setPatternItems(e)}}return e.prototype.render=function(e,t){var n=this;this.destroy(),this.shapeList&&0!==this.shapeList.length?(this.panelEl=document.createElement("div"),this.panelEl.className="lf-dndpanel",this.shapeList.forEach((function(e){var t;null===(t=n.panelEl)||void 0===t||t.appendChild(n.createDndItem(e))})),t.appendChild(this.panelEl),this.domContainer=t):this.domContainer=t},e.prototype.destroy=function(){this.domContainer&&this.panelEl&&this.domContainer.contains(this.panelEl)&&this.domContainer.removeChild(this.panelEl)},e.prototype.setPatternItems=function(e){this.shapeList=e,this.domContainer&&this.render(this.lf,this.domContainer)},e.prototype.createDndItem=function(e){var t=this,n=document.createElement("div");n.className=e.className?"lf-dnd-item ".concat(e.className):"lf-dnd-item";var i=document.createElement("div");if(i.className="lf-dnd-shape",e.icon&&(i.style.backgroundImage="url(".concat(e.icon,")")),n.appendChild(i),e.label){var o=document.createElement("div");o.innerText=e.label,o.className="lf-dnd-text",n.appendChild(o)}return e.disabled?(n.classList.add("disabled"),n.onmousedown=function(){e.callback&&e.callback(t.lf,t.domContainer)},n):(n.onmousedown=function(){e.type&&t.lf.dnd.startDrag({type:e.type,properties:e.properties,text:e.text}),e.callback&&e.callback(t.lf,t.domContainer)},n.ondblclick=function(n){t.lf.graphModel.eventCenter.emit("dnd:panel-dbclick",{e:n,data:e})},n.onclick=function(n){t.lf.graphModel.eventCenter.emit("dnd:panel-click",{e:n,data:e})},n.oncontextmenu=function(n){t.lf.graphModel.eventCenter.emit("dnd:panel-contextmenu",{e:n,data:e})},n)},e.pluginName="dndPanel",e}(),sm=function(){function e(e){var t=e.lf,n=e.LogicFlow,i=e.options,o=this;this.width=200,this.height=150,this.scale=1,this.translateX=0,this.translateY=0,this.showEdge=!1,this.viewPortTop=0,this.viewPortLeft=0,this.viewPortWidth=150,this.viewPortHeight=75,this.isShow=!1,this.isShowHeader=!1,this.isShowCloseIcon=!1,this.headerTitle="导航",this.disabledPlugins=["miniMap","control","selectionSelect"],this.onGraphResize=function(){o.updateViewPortBounds(),o.isShow&&o.updateViewPort()},this.render=function(e,t){o.container=t,o.lf.on("history:change",(function(){o.isShow&&o.setView()})),o.lf.on("graph:transform",(function(){o.isShow&&o.setView(!1)}))},this.show=function(e,t){o.isShow||(o.createMiniMap(e,t),o.setView()),o.isShow=!0},this.hide=function(){o.isShow&&(o.removeMiniMap(),o.lf.emit("miniMap:close",{})),o.isShow=!1},this.updatePosition=function(e){if("object"==typeof e)void 0===e.left&&void 0===e.right||(o.leftPosition=e.left,o.rightPosition=e.right),void 0===e.top&&void 0===e.bottom||(o.topPosition=e.top,o.bottomPosition=e.bottom);else switch(e){case"left-top":o.leftPosition=0,o.rightPosition=void 0,o.topPosition=0,o.bottomPosition=void 0;break;case"right-top":o.leftPosition=void 0,o.rightPosition=0,o.topPosition=0,o.bottomPosition=void 0;break;case"left-bottom":o.leftPosition=0,o.rightPosition=void 0,o.topPosition=void 0,o.bottomPosition=0;break;case"right-bottom":o.leftPosition=void 0,o.rightPosition=0,o.topPosition=void 0,o.bottomPosition=0}o.updateMiniMapPosition()},this.reset=function(){o.lf.resetTranslate(),o.lf.resetZoom()},this.setShowEdge=function(e){o.showEdge!==e&&(o.showEdge=e,o.setView())},this.startDrag=function(e){document.addEventListener("mousemove",o.drag),document.addEventListener("mouseup",o.drop);var t=e.x,n=e.y;o.startPosition={x:t,y:n}},this.drag=function(e){var t=e.x,n=e.y,i=(t-o.startPosition.x)/o.scale,r=(n-o.startPosition.y)/o.scale,a=o.viewPortLeft+i+o.viewPortWidth/o.scale/2,s=o.viewPortTop+r+o.viewPortHeight/o.scale/2;o.startPosition={x:t,y:n},o.lf.focusOn({coordinate:{x:a,y:s}})},this.drop=function(){document.removeEventListener("mousemove",o.drag),document.removeEventListener("mouseup",o.drop)},this.mapClick=function(e){var t=e.offsetX,n=e.offsetY,i=o.translateX+t/o.scale,r=o.translateY+n/o.scale;o.lf.focusOn({coordinate:{x:i,y:r}})},this.lf=t,this.LFCtor=n,i&&this.setOption(i),this.viewPortWidth=t.graphModel.width,this.viewPortHeight=t.graphModel.height;var r={left:0,right:this.viewPortWidth,top:0,bottom:this.viewPortHeight};this.bounds=r,this.elementAreaBounds=r,this.viewPortBounds=r,this.initMiniMap(),t.on("graph:resize",this.onGraphResize)}return e.prototype.setOption=function(e){var t=e.width,n=void 0===t?150:t,i=e.height,o=void 0===i?220:i,r=e.showEdge,a=void 0!==r&&r,s=e.isShowHeader,l=void 0!==s&&s,u=e.isShowCloseIcon,c=void 0!==u&&u,d=e.leftPosition,h=e.topPosition,f=e.rightPosition,p=void 0===f?0:f,g=e.bottomPosition,v=void 0===g?0:g,m=e.headerTitle,y=void 0===m?"导航":m;this.width=n,this.height=o,this.showEdge=a,this.isShowHeader=l,this.isShowCloseIcon=c,this.leftPosition=d,this.rightPosition=void 0!==d?void 0:p,this.topPosition=h,this.bottomPosition=void 0!==h?void 0:v,this.headerTitle=y},e.prototype.initMiniMap=function(){var e=document.createElement("div");e.className="lf-mini-map-graph",e.style.width="".concat(this.width,"px"),e.style.height="".concat(this.height,"px"),this.lfMap=new this.LFCtor({container:e,grid:!1,isSilentMode:!0,stopZoomGraph:!0,stopScrollGraph:!0,stopMoveGraph:!1,history:!1,snapline:!1,disabledPlugins:this.disabledPlugins}),this.miniMapWrap=e,this.createViewPort(),e.addEventListener("click",this.mapClick)},e.prototype.createMiniMap=function(e,t){var n,i=document.createElement("div");this.miniMapContainer=i,i.appendChild(this.miniMapWrap),i.style.position="absolute",void 0===e&&void 0===t||(this.leftPosition=e||0,this.topPosition=t||0,this.rightPosition=void 0,this.bottomPosition=void 0),this.updateMiniMapPosition(),i.className="lf-mini-map",this.isShowCloseIcon||i.classList.add("lf-mini-map-no-close-icon"),this.isShowHeader||i.classList.add("lf-mini-map-no-header"),null===(n=this.container)||void 0===n||n.appendChild(i),this.miniMapWrap.appendChild(this.viewport);var o=document.createElement("div");o.className="lf-mini-map-header",o.innerText=this.headerTitle,i.appendChild(o);var r=document.createElement("span");r.className="lf-mini-map-close",r.addEventListener("click",this.hide),i.appendChild(r)},e.prototype.updateMiniMapPosition=function(){if(this.miniMapContainer){var e=this.miniMapContainer.style;void 0!==this.rightPosition?(e.right="".concat(this.rightPosition,"px"),e.left=""):(e.left="".concat(this.leftPosition,"px"),e.right=""),void 0!==this.bottomPosition?(e.bottom="".concat(this.bottomPosition,"px"),e.top=""):(e.top="".concat(this.topPosition,"px"),e.bottom="")}},e.prototype.removeMiniMap=function(){var e;this.miniMapContainer&&(null===(e=this.container)||void 0===e||e.removeChild(this.miniMapContainer))},e.prototype.updateBounds=function(e){e&&this.updateElementAreaBounds(e),this.updateViewPortBounds(),this.bounds={left:Math.min(this.elementAreaBounds.left,this.viewPortBounds.left),right:Math.max(this.elementAreaBounds.right,this.viewPortBounds.right),top:Math.min(this.elementAreaBounds.top,this.viewPortBounds.top),bottom:Math.max(this.elementAreaBounds.bottom,this.viewPortBounds.bottom)}},e.prototype.updateElementAreaBounds=function(e){var t={left:0,right:0,top:0,bottom:0},n=e.nodes;n&&n.length>0&&n.forEach((function(e){var n,i,o=e.x,r=e.y,a=null!==(n=e.width)&&void 0!==n?n:200,s=null!==(i=e.height)&&void 0!==i?i:200,l=o-a/2,u=o+a/2,c=r-s/2,d=r+s/2;t.left=Math.min(l,t.left),t.right=Math.max(u,t.right),t.top=Math.min(c,t.top),t.bottom=Math.max(d,t.bottom)})),this.elementAreaBounds=t},e.prototype.updateViewPortBounds=function(){var e=this.lf.getTransform(),t=e.TRANSLATE_X,n=e.TRANSLATE_Y,i=e.SCALE_X,o=e.SCALE_Y,r=this.lf.graphModel,a=r.width,s=r.height;this.viewPortBounds={left:-t/i,right:(-t+a)/i,top:-n/o,bottom:(-n+s)/o}},e.prototype.resetData=function(e){var t=e.nodes,n=e.edges;return t.forEach((function(e){e.text=void 0})),this.showEdge&&n.forEach((function(e){e.text=void 0})),{nodes:t,edges:this.showEdge?n:[]}},e.prototype.setView=function(e){var t,n;if(void 0===e&&(e=!0),e){var i=this.lf.getGraphRawData(),o=this.resetData(i),r=this.lf.viewMap,a=this.lf.graphModel.modelMap,s=this.lfMap.viewMap;try{for(var l=x(r.keys()),u=l.next();!u.done;u=l.next()){var c=u.value;s.has(c)||this.lfMap.register({type:c,view:r.get(c),model:a.get(c)})}}catch(e){t={error:e}}finally{try{u&&!u.done&&(n=l.return)&&n.call(l)}finally{if(t)throw t.error}}this.lfMap.render(o),this.updateBounds(o)}else this.updateBounds();var d=this.bounds,h=d.left,f=d.top,p=d.right-h,g=d.bottom-f,v=this.width/p,m=this.height/g,y=Math.min(v,m);this.scale=y;var b=h-(this.width/y-p)/2,w=f-(this.height/y-g)/2;if(this.lfMap.graphModel.transformModel.translate(-b+this.translateX,-w+this.translateY),this.translateX=b,this.translateY=w,this.miniMapWrap.firstChild){var E=this.miniMapWrap.firstChild.style;E.pointerEvents="none",E.transform="matrix(".concat(y,", 0, 0, ").concat(y,", 0, 0)"),E.transformOrigin="left top",E.height="".concat(this.height/y,"px"),E.width="".concat(this.width/y,"px"),this.updateViewPort()}},e.prototype.updateViewPort=function(){var e=this.viewport.style,t=this.lf.getTransform(),n=t.TRANSLATE_X,i=t.TRANSLATE_Y,o=t.SCALE_X,r=t.SCALE_Y,a=this.lf.graphModel,s=a.width,l=a.height;this.viewPortLeft=-n/o,this.viewPortTop=-i/r,this.viewPortWidth=s/o*this.scale,this.viewPortHeight=l/r*this.scale,e.width="".concat(this.viewPortWidth,"px"),e.height="".concat(this.viewPortHeight,"px"),e.left="".concat((this.viewPortLeft-this.translateX)*this.scale,"px"),e.top="".concat((this.viewPortTop-this.translateY)*this.scale,"px")},e.prototype.createViewPort=function(){var e=document.createElement("div");e.className="lf-minimap-viewport",e.addEventListener("mousedown",this.startDrag),e.addEventListener("click",(function(e){e.stopPropagation()})),this.viewport=e},e.prototype.destroy=function(){this.lf.off("graph:resize",this.onGraphResize)},e.pluginName="miniMap",e}(),lm=function(){function e(e){var t=e.lf,n=this;this.disabled=!0,this.isDefaultStopMoveGraph=!1,this.isWholeNode=!0,this.isWholeEdge=!0,this.draw=function(e){var t=n.lf.getPointByClient(e.clientX,e.clientY).domOverlayPosition,i=t.x,o=t.y;if(n.endPoint={x:i,y:o},n.startPoint){var r=n.startPoint,a=r.x,s=r.y,l=a,u=s,c=i-a,d=o-s;i<a&&(l=i,c=a-i),o<s&&(u=o,d=s-o),n.wrapper&&(n.wrapper.style.left="".concat(l,"px"),n.wrapper.style.top="".concat(u,"px"),n.wrapper.style.width="".concat(c,"px"),n.wrapper.style.height="".concat(d,"px"))}},this.drawOff=function(){var e;if(document.removeEventListener("mousemove",n.draw),document.removeEventListener("mouseup",n.drawOff),n.wrapper&&(n.wrapper.oncontextmenu=null,null===(e=n.container)||void 0===e||e.removeChild(n.wrapper)),n.startPoint&&n.endPoint){var t=n.startPoint,i=t.x,o=t.y,r=n.endPoint,a=r.x,s=r.y,l=[Math.min(i,a),Math.min(o,s)],u=[Math.max(i,a),Math.max(o,s)];if(n.lf.emit("selection:selected-area",{topLeft:l,bottomRight:u}),Math.abs(a-i)<10&&Math.abs(s-o)<10)return;var c=n.lf.graphModel.getAreaElement(l,u,n.isWholeEdge,n.isWholeNode,!0),d=n.lf.graphModel,h=d.dynamicGroup,f=d.group,p=[];c.forEach((function(e){f&&f.getNodeGroup(e.id)||h&&h.getGroupByNodeId(e.id)||(n.lf.selectElementById(e.id,!0),p.push(e))})),n.lf.emit("selection:selected",{elements:p,leftTopPoint:l,rightBottomPoint:u})}},this.lf=t;var i=t.getEditConfig().stopMoveGraph;this.isDefaultStopMoveGraph=i,t.openSelectionSelect=function(){n.openSelectionSelect()},t.closeSelectionSelect=function(){n.closeSelectionSelect()}}return e.prototype.render=function(e,t){var n=this;this.container=t,e.on("blank:mousedown",(function(i){var o=i.e;if(e.getEditConfig().stopMoveGraph&&!n.disabled&&!(2===o.button)){var r=e.getPointByClient(o.clientX,o.clientY).domOverlayPosition,a=r.x,s=r.y;n.startPoint={x:a,y:s},n.endPoint={x:a,y:s};var l=document.createElement("div");l.className="lf-selection-select",l.oncontextmenu=function(e){e.preventDefault()},l.style.top="".concat(n.startPoint.y,"px"),l.style.left="".concat(n.startPoint.x,"px"),t.appendChild(l),n.wrapper=l,document.addEventListener("mousemove",n.draw),document.addEventListener("mouseup",n.drawOff)}}))},e.prototype.setSelectionSense=function(e,t){void 0===e&&(e=!0),void 0===t&&(t=!0),this.isWholeEdge=e,this.isWholeNode=t},e.prototype.openSelectionSelect=function(){this.lf.getEditConfig().stopMoveGraph||(this.isDefaultStopMoveGraph=!1,this.lf.updateEditConfig({stopMoveGraph:!0})),this.open()},e.prototype.closeSelectionSelect=function(){this.isDefaultStopMoveGraph||this.lf.updateEditConfig({stopMoveGraph:!1}),this.close()},e.prototype.open=function(){this.disabled=!1},e.prototype.close=function(){this.disabled=!0},e.pluginName="selectionSelect",e}(),um=function(e,t){var n=[],i=[],o=function(e,i,r){e&&(r&&i.unshift.apply(i,E([],w(t.getEdgeModels({sourceNodeId:e.id,targetNodeId:null==r?void 0:r.id}).map((function(e){return e.id}))),!1)),i.includes(e.id)?n.push(i):(i.unshift(e.id),e.incoming.nodes.length?e.incoming.nodes.forEach((function(t){o(t,i.slice(),e)})):n.push(i)))},r=function(e,n,o){e&&(o&&n.push.apply(n,E([],w(t.getEdgeModels({sourceNodeId:null==o?void 0:o.id,targetNodeId:e.id}).map((function(e){return e.id}))),!1)),n.includes(e.id)?i.push(n):(n.push(e.id),e.outgoing.nodes.length?e.outgoing.nodes.forEach((function(t){r(t,n.slice(),e)})):i.push(n)))};return o(e,[]),r(e,[]),E([],w(new Set(E(E([],w(n.flat()),!1),w(i.flat()),!1))),!1)},cm=function(){function e(e){var t=e.lf,n=e.options;this.mode="path",this.enable=!0,this.tempStyles={};var i=n.mode,o=void 0===i?"path":i,r=n.enable,a=void 0===r||r;this.lf=t,this.mode=o,this.enable=a}return e.prototype.setMode=function(e){this.mode=e},e.prototype.setEnable=function(e){this.enable=e},e.prototype.highlightSingle=function(e){var t=this.lf.getModelById(e);"node"===(null==t?void 0:t.BaseType)?t.updateStyles(this.tempStyles[e]):"edge"===(null==t?void 0:t.BaseType)&&(t.updateStyles(this.tempStyles[e]),t.sourceNode.updateStyles(this.tempStyles[t.sourceNode.id]),t.targetNode.updateStyles(this.tempStyles[t.targetNode.id]))},e.prototype.highlightNeighbours=function(e){var t=this,n=this.lf.getModelById(e);if("node"===(null==n?void 0:n.BaseType)){n.updateStyles(this.tempStyles[e]);var i=n.incoming,o=i.nodes,r=i.edges,a=n.outgoing,s=a.nodes,l=a.edges;Bs(o,s).forEach((function(e){e.updateStyles(t.tempStyles[e.id])})),Bs(r,l).forEach((function(e){e.updateStyles(t.tempStyles[e.id])}))}else"edge"===(null==n?void 0:n.BaseType)&&(n.updateStyles(this.tempStyles[e]),n.sourceNode.updateStyles(this.tempStyles[n.sourceNode.id]),n.targetNode.updateStyles(this.tempStyles[n.targetNode.id]))},e.prototype.highlightPath=function(e){var t=this,n=function(e,t){var n=t.getModelById(e);return um("node"===(null==n?void 0:n.BaseType)?n:null==n?void 0:n.targetNode,t)}(e,this.lf);n.forEach((function(e){var n;null===(n=t.lf.getModelById(e))||void 0===n||n.updateStyles(t.tempStyles[e])}))},e.prototype.highlight=function(e,t){var n=this;(void 0===t&&(t=this.mode),this.enable)&&(Object.keys(this.tempStyles).length&&this.restoreHighlight(),Object.values(this.lf.graphModel.modelsMap).forEach((function(e){var t="node"===e.BaseType?e.getNodeStyle():e.getEdgeStyle();n.tempStyles[e.id]=g({},t),e.setStyles({opacity:.1})})),{single:this.highlightSingle.bind(this),neighbour:this.highlightNeighbours.bind(this),path:this.highlightPath.bind(this)}[t](e))},e.prototype.restoreHighlight=function(){var e=this;Object.keys(this.tempStyles).length&&(Object.values(this.lf.graphModel.modelsMap).forEach((function(t){var n,i=null!==(n=e.tempStyles[t.id])&&void 0!==n?n:{};t.updateStyles(g({},i))})),this.tempStyles={})},e.prototype.render=function(){var e=this;this.lf.on("node:mouseenter",(function(t){var n=t.data;return e.highlight(n.id)})),this.lf.on("edge:mouseenter",(function(t){var n=t.data;return e.highlight(n.id)})),this.lf.on("node:mouseleave",this.restoreHighlight.bind(this)),this.lf.on("edge:mouseleave",this.restoreHighlight.bind(this)),this.lf.on("history:change",this.restoreHighlight.bind(this))},e.prototype.destroy=function(){},e.pluginName="highlight",e}(),dm={tr:"tl",lb:"tl",tl:"tr",rb:"tr",br:"bl",lt:"bl",bl:"br",rt:"br"};function hm(e,t,n,i){var o,r="",a="";e[0]===t[0]?r=e[1]>t[1]?"t":"b":e[1]===t[1]&&(r=e[0]>t[0]?"l":"r"),t[0]===n[0]?a=t[1]>n[1]?"t":"b":t[1]===n[1]&&(a=t[0]>n[0]?"l":"r");var s=Math.min(Math.hypot(t[0]-e[0],t[1]-e[1])/2,Math.hypot(n[0]-t[0],n[1]-t[1])/2,i)||.2*i,l="".concat(r).concat(a),u=dm[l]||"-",c="L ".concat(e[0]," ").concat(e[1]);if("-"===u)c+="L ".concat(t[0]," ").concat(t[1]," L ").concat(n[0]," ").concat(n[1]);else{var d=w(function(e,t,n,i){var o=[e[0],e[1]],r=[e[0],e[1]];switch(n){case"tl":return"tr"===t?(o[1]+=i,r[0]+=i):"lb"===t&&(o[0]+=i,r[1]+=i),[o,r];case"tr":return"tl"===t?(o[1]+=i,r[0]-=i):"rb"===t&&(o[0]-=i,r[1]+=i),[o,r];case"bl":return"br"===t?(o[1]-=i,r[0]+=i):"lt"===t&&(o[0]+=i,r[1]-=i),[o,r];case"br":return"bl"===t?(o[1]-=i,r[0]-=i):"rt"===t&&(o[0]-=i,r[1]-=i),[o,r];default:return[]}}(t,l,u,s),2),h=d[0],f=d[1];h&&f&&(c+="L ".concat(h[0]," ").concat(h[1]," Q ").concat(t[0]," ").concat(t[1]," ").concat(f[0]," ").concat(f[1]),o=w(f,2),t[0]=o[0],t[1]=o[1])}return c}function fm(e,t){var n=0,i="";if(2===e.length)i+="M".concat(e[n][0]," ").concat(e[n++][1]," L ").concat(e[n][0]," ").concat(e[n][1]);else{for(i+="M".concat(e[n][0]," ").concat(e[n++][1]);n+1<e.length;){i+=hm(e[n-1],e[n],e[1+n++],t)}i+="L ".concat(e[n][0]," ").concat(e[n][1])}return i}var pm=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return p(n,e),n.prototype.getEdge=function(){var e=this.props.model,n=e.points,i=e.isAnimation,o=e.arrowConfig,r=e.radius,a=void 0===r?5:r,s=e.getEdgeStyle(),l=e.getEdgeAnimationStyle(),u=function(e){for(var t=e,n=1;n<t.length-1;){var i=w(t[n-1],2),o=i[0],r=i[1],a=w(t[n],2),s=a[0],l=a[1],u=w(t[n+1],2),c=u[0],d=u[1];o===s&&s===c||r===l&&l===d?t.splice(n,1):n++}return t}(n.split(" ").map((function(e){return e.split(",").map((function(e){return+e}))}))),c=fm(u,a),d=g(g(g({style:i?l:{}},s),o),{fill:"none"});return t.h("path",g({d:c},d))},n}(t.PolylineEdge),gm=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return p(t,e),t}(t.PolylineEdgeModel),vm=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return p(n,e),n.prototype.getLabelShape=function(){var e=this.props.model,n=e.id,i=e.x,o=e.y,r=e.width,a=e.height,s=e.properties,l=this.props.model.getNodeStyle();return t.h("svg",{x:i-r/2,y:o-a/2,width:50,height:24,style:"z-index: 0; background: none; overflow: auto;"},[s.labelText?t.h("text",{x:0,y:-5,fontSize:"16px",fill:l.stroke},s.labelText):"",s.disabledDelete?"":t.h("text",{x:s.labelText?50:0,y:-5,fontSize:"24px",cursor:"pointer",fill:l.stroke,onclick:this.handleCustomDeleteIconClick.bind(this,n)},"x")])},n.prototype.getShape=function(){var e=this.props.model,n=e.x,i=e.y,o=e.width,r=e.height,a=e.id,s=this.props.model.getNodeStyle();return t.h("g",{},[t.h("rect",g(g({},s),{x:n-o/2,y:i-r/2,width:o,height:r,id:a})),this.getLabelShape()])},n.prototype.toFront=function(){},n.prototype.handleCustomDeleteIconClick=function(e){this.props.graphModel.deleteNode(e)},n}(t.PolygonNode),mm=function(e){function t(){var t=e.apply(this,E([],w(arguments),!1))||this;return t.d=10,t.isResize=!1,t}return p(t,e),t.prototype.initNodeData=function(t){t.text={value:"",x:t.x,y:t.y,draggable:!1,editable:!1},e.prototype.initNodeData.call(this,t),this.zIndex=0,this.draggable=!0},t.prototype.setAttributes=function(){var e,t=this;this.points=[],(null===(e=this.properties)||void 0===e?void 0:e.node_selection_ids).length>1&&setTimeout((function(){var e;t.updatePointsByNodes((null===(e=t.properties)||void 0===e?void 0:e.node_selection_ids)||[])}))},t.prototype.getNodeStyle=function(){var t=e.prototype.getNodeStyle.call(this);return t.stroke=this.properties.strokeColor||"#008000",t.strokeDasharray="10 5",t},t.prototype.getDefaultAnchor=function(){return[]},t.prototype.updatePoints=function(e){this.points=e},t.prototype.updateCoordinate=function(e){var t=e.x,n=e.y;this.x=t,this.y=n},t.prototype.updatePointsByNodes=function(e){var t=this,n=[],i=1/0,o=1/0,r=-1/0,a=-1/0;e.forEach((function(e){var n=t.graphModel.getNodeModelById(e);if(n){var s=n.width,l=n.height,u=n.x,c=n.y;i=Math.min(i,u-s/2-t.d),o=Math.min(o,c-l/2-t.d),r=Math.max(r,u+s/2+t.d),a=Math.max(a,c+l/2+t.d)}})),n.push([i,o],[r,o],[r,a],[i,a]),[i,o,r,a].some((function(e){return Math.abs(e)===1/0}))||(this.updatePoints(n),this.updateCoordinate({x:(r+i)/2,y:(a+o)/2}))},t.prototype.resize=function(t){var n;this.isResize=!0;for(var i=t.width,o=t.height,r=i/this.width,a=o/this.height,s=(this.properties.node_selection_ids||[]).slice(),l=[],u=new Set;s.length;){var c=s.shift(),d=null===(n=this.graphModel.nodesMap[c])||void 0===n?void 0:n.model;d&&(xm(d)?u.has(d.id)||(u.add(d.id),s.push.apply(s,E([],w(d.properties.node_selection_ids||[]),!1))):l.push(d))}var h=this.x-this.width/2,f=this.y-this.height/2,p=e.prototype.resize.call(this,t),g=this.x-this.width/2,v=this.y-this.height/2;return l.forEach((function(e){e.width=e.width*r,e.height=e.height*a;var t=(e.x-h)*r+g-e.x,n=(e.y-f)*a+v-e.y;e.move(t,n,!0)})),this.isResize=!1,p},t}(t.PolygonNodeModel),ym="node-selection",bm=function(){function e(e){var t=e.lf;this.selectNodes=[],this.d=10,this.lf=t,t.register({type:ym,view:vm,model:mm})}return Object.defineProperty(e.prototype,"selectNodesIds",{get:function(){return this.selectNodes.map((function(e){return e.id}))},enumerable:!1,configurable:!0}),e.prototype.addNodeSelection=function(){this.lf.addNode({type:"node-selection",text:"",properties:{node_selection_ids:this.selectNodesIds},x:0,y:0}).updatePointsByNodes(this.selectNodesIds)},e.prototype.updateNodeSelection=function(){var e,t=this.getNodeSelection();t&&(this.lf.setProperties(t.id,{node_selection_ids:this.selectNodesIds}),null===(e=this.lf.getNodeModelById(t.id))||void 0===e||e.updatePointsByNodes(this.selectNodesIds))},e.prototype.getNodeSelection=function(){var e=this,t=this.selectNodesIds,n=this.lf.getGraphRawData(),i=t.filter((function(t){return t!==e.currentClickNode.id}));return n.nodes.find((function(e){if("node-selection"===e.type){var t=jo(e,"properties.node_selection_ids",[]);return i.every((function(e){return t.includes(e)}))}return!1}))},e.prototype.onNodeChange=function(e,t){var n=e.graphModel.nodes.filter((function(e){return!!xm(e)&&(e.properties.node_selection_ids||[]).includes(t.id)}));Promise.resolve().then((function(){n.forEach((function(e){e.updatePointsByNodes(e.properties.node_selection_ids||[])}))}))},e.prototype.render=function(e){var t=this;this.lf=e,e.on("node:click",(function(n){var i;if(n.e.shiftKey&&n.data.type!==ym){t.currentClickNode=n.data;var o=!1;t.selectNodesIds.includes(n.data.id)&&(null===(i=t.lf.getNodeModelById(n.data.id))||void 0===i||i.setSelected(!1),o=!0);var r=e.getSelectElements(!0).nodes;t.selectNodes=r,1===t.selectNodes.length?o?t.updateNodeSelection():t.addNodeSelection():t.selectNodes.length>1&&t.updateNodeSelection()}})),e.graphModel.addNodeMoveRules((function(n,i,o){if(t.onNodeChange(e,n),xm(n)&&!n.isResize){var r=n.properties.node_selection_ids||[];return e.graphModel.moveNodes(r,i,o,!0),!0}return!0})),e.graphModel.addNodeResizeRules((function(n){return xm(n)||t.onNodeChange(e,n),!0}))},e.pluginName="node-selection",e}(),xm=function(e){return!(!e||e.type!==ym)},wm=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return p(n,e),n.prototype.getLabelShape=function(){var e=this.props.model,n=e.x,i=e.y,o=e.width,r=e.height,a=e.properties;return t.h("text",{x:n-o/2+5,y:i-r/2+16,fontSize:12,fill:"blue"},a.moreText)},n.prototype.getShape=function(){var e=this.props.model,n=e.x,i=e.y,o=e.width,r=e.height,a=this.props.model.getNodeStyle();return t.h("g",{},[t.h("rect",g(g({},a),{fill:"#FFFFFF",x:n-o/2,y:i-r/2})),this.getLabelShape()])},n}(t.RectNode),Em={pluginName:"rectLabelNode",install:function(e){e.register({type:"rect-label",model:t.RectNodeModel,view:wm})}};e.AutoLayout=$v,e.BPMNAdapter=Xg,e.BPMNBaseAdapter=qg,e.BPMNElements=rg,e.BoundaryEventFactory=xe,e.BpmnAdapter=ce,e.BpmnElement=U,e.BpmnXmlAdapter=de,e.ContextMenu=rm,e.Control=Jv,e.CurvedEdge=pm,e.CurvedEdgeModel=gm,e.DiamondResize=Hp,e.DiamondResizeModel=jp,e.DiamondResizeView=Fp,e.DndPanel=am,e.DynamicGroup=nv,e.DynamicGroupNode=Zg,e.DynamicGroupNodeModel=Jg,e.EllipseResize=Bp,e.EllipseResizeModel=Ip,e.EllipseResizeView=Lp,e.EndEventFactory=me,e.EndEventModel=A,e.EndEventView=k,e.ExclusiveGatewayModel=I,e.ExclusiveGatewayView=L,e.FlowPath=Xv,e.GatewayNodeFactory=Pe,e.Group=Jp,e.GroupNode=Yp,e.GroupNodeModel=Kp,e.Highlight=cm,e.HtmlResize=Gp,e.HtmlResizeModel=Wp,e.HtmlResizeView=zp,e.InsertNodeInPolyline=uv,e.IntermediateCatchEventFactory=ye,e.IntermediateThrowEventFactory=we,e.Label=Bv,e.Menu=im,e.MiniMap=sm,e.NodeResize=Vp,e.NodeSelection=bm,e.ProximityConnect=Zv,e.RectLabelNode=Em,e.RectResize=Xp,e.RectResizeModel=Up,e.RectResizeView=qp,e.SelectionSelect=lm,e.SequenceFlowModel=O,e.SequenceFlowView=P,e.ServiceTaskModel=j,e.ServiceTaskView=F,e.Snapshot=qv,e.StartEventFactory=be,e.StartEventModel=S,e.StartEventView=M,e.SubProcessFactory=Qp,e.TaskNodeFactory=Ie,e.UserTaskModel=W,e.UserTaskView=z,e.bpmnUtils=ve,e.convertNormalToXml=jg,e.convertXmlToNormal=Fg,e.dynamicGroup=ev,e.gateway={exclusive:0,inclusive:1,parallel:2},e.gatewayComposable=[[1,1,0],[0,0,1],[0,1,1]],e.getCurvedEdgePath=fm,e.handleAttributes=Y,e.icons=Oe,e.lfJson2Xml=J,e.lfXml2Json=te,e.multiInstanceIcon=De,e.sequenceFlowFactory=tg,e.toLogicflowData=function(e){var t={nodes:[],edges:[]},n=e.flowElementList;return n&&n.length>0&&n.forEach((function(e){if(e.type===Vg.SEQUENCE_FLOW){var n=function(e){var t=e.incoming,n=e.outgoing,i=e.properties,o=e.key,r=e.type,a=i.text,s=i.name,l=i.startPoint,u=i.endPoint,c=i.pointsList,d={id:o,type:Kg[r],sourceNodeId:t[0],targetNodeId:n[0],text:a||s,properties:{}};l&&(d.startPoint=JSON.parse(l)),u&&(d.endPoint=JSON.parse(u)),c&&(d.pointsList=JSON.parse(c));var h=["startPoint","endPoint","pointsList","text"];return Object.keys(e.properties).forEach((function(t){-1===h.indexOf(t)&&(d.properties[t]=e.properties[t])})),d}(e);t.edges.push(n)}else{var i=function(e){var t=e.properties,n=e.key,i=e.type,o=e.bounds,r=t.x,a=t.y,s=t.text;if(void 0===r){var l=w(o,2),u=l[0],c=u.x,d=u.y,h=l[1];r=(c+h.x)/2,a=(d+h.y)/2}var f={id:n,type:Kg[i],x:r,y:a,text:s,properties:{}},p=["x","y","text"];return Object.keys(e.properties).forEach((function(t){-1===p.indexOf(t)&&(f.properties[t]=e.properties[t])})),f}(e);t.nodes.push(i)}})),t},e.toNormalJson=re,e.toTurboData=function(e){var t=new Map,n={flowElementList:[]};return e.nodes.forEach((function(e){var i=function(e){var t=e.id,n=e.type,i=e.x,o=e.y,r=e.text,a=void 0===r?"":r,s=e.properties;return{incoming:[],outgoing:[],dockers:[],type:Yg(n),properties:g(g({},s),{name:a&&a.value||"",x:i,y:o,text:a}),key:t}}(e);n.flowElementList.push(i),t.set(e.id,i)})),e.edges.forEach((function(e){var i=function(e){var t=e.id,n=e.type,i=e.sourceNodeId,o=e.targetNodeId,r=e.startPoint,a=e.endPoint,s=e.pointsList,l=e.text,u=void 0===l?"":l,c=e.properties;return{incoming:[i],outgoing:[o],type:Yg(n),dockers:[],properties:g(g({},c),{name:u&&u.value||"",text:u,startPoint:JSON.stringify(r),endPoint:JSON.stringify(a),pointsList:JSON.stringify(s)}),key:t}}(e);t.get(e.sourceNodeId).outgoing.push(i.key),t.get(e.targetNodeId).incoming.push(i.key),n.flowElementList.push(i)})),n},e.toXmlJson=oe,e.useDefinition=og}));
//# sourceMappingURL=index.min.js.map
